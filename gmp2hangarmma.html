<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GMP 2 HANGAR MMA</title>
    <style>
        :root {
            --primary: #1a3a5a;
            --accent: #007bff;
            --success: #28a745;
            --danger: #dc3545;
            --warning: #ffc107;
            --info: #17a2b8;
            --purple: #6f42c1;
        }

        * {
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
            background-color: #f5f7fa;
            margin: 0;
            padding: 4px;
            font-size: 13px;
            line-height: 1.3;
        }

        .container {
            max-width: 100%;
            background: white;
            padding: 6px;
            border-radius: 4px;
            box-shadow: 0 1px 2px rgba(0,0,0,0.1);
            position: relative;
            margin: 0 auto;
        }

        .credits-integrated {
            position: absolute;
            top: 2px;
            right: 6px;
            background: var(--primary);
            color: white;
            padding: 1px 3px;
            font-size: 0.5rem;
            font-weight: bold;
            border-radius: 1px;
            z-index: 10;
        }

        /* CABE√áALHO SUPER COMPACTO */
        .header-mini {
            position: sticky;
            top: 0;
            background: white;
            padding-bottom: 4px;
            border-bottom: 1px solid var(--primary);
            z-index: 5;
            margin-bottom: 6px;
            padding-top: 16px;
        }

        .header-mini-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 4px;
        }

        .page-title-mini {
            margin: 0;
            color: var(--primary);
            font-size: 0.85rem;
            font-weight: bold;
            line-height: 1.1;
            max-width: 65%;
        }

        .timer-compact {
            background: #f8f9fa;
            color: var(--primary);
            padding: 2px 4px;
            border-radius: 2px;
            font-size: 0.75rem;
            font-weight: bold;
            border: 1px solid #dee2e6;
            min-width: 40px;
            text-align: center;
        }

        .timer-warning {
            background: #fff5f5 !important;
            color: var(--danger) !important;
            border-color: var(--danger) !important;
        }

        /* INFO DO SIMULADO MAIS COMPACTA */
        .simulado-info {
            background: #e7f3ff;
            border: 1px solid var(--accent);
            border-radius: 3px;
            padding: 4px 5px;
            margin-bottom: 5px;
            font-size: 0.65rem;
            color: var(--primary);
            display: none;
        }

        .simulado-stats {
            display: flex;
            justify-content: space-between;
            margin-top: 2px;
            font-weight: 600;
        }

        /* CONTROLES DE HIST√ìRICO COMPACTOS */
        .history-controls {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 4px;
            margin-top: 4px;
        }

        .history-controls button {
            padding: 2px 4px;
            font-size: 0.6rem;
            border-radius: 2px;
            border: none;
            cursor: pointer;
            font-weight: 600;
            text-align: center;
        }

        .clear-history-btn {
            background: var(--warning);
            color: #856404;
            border: 1px solid #ffc107;
        }

        .info-history-btn {
            background: #6c757d;
            color: white;
        }

        /* INFO B√ÅSICA SUPER COMPACTA */
        .quiz-info-mini {
            background: #f8f9fa;
            border-radius: 3px;
            padding: 5px 6px;
            border: 1px solid #dee2e6;
            margin-bottom: 4px;
        }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 4px;
            margin-bottom: 4px;
        }

        .info-item {
            text-align: center;
        }

        .info-label {
            font-size: 0.55rem;
            color: #6c757d;
            font-weight: 600;
            text-transform: uppercase;
            margin-bottom: 0;
        }

        .info-value {
            font-size: 0.75rem;
            font-weight: 700;
            color: var(--primary);
        }

        /* CONTROLES COMPACTOS */
        .controls-compact {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 4px;
        }

        .auto-nav-toggle {
            display: flex;
            align-items: center;
            gap: 3px;
            padding: 2px 4px;
            background: #e9ecef;
            border-radius: 2px;
            cursor: pointer;
            font-size: 0.65rem;
        }

        .auto-nav-checkbox {
            transform: scale(0.8);
            accent-color: var(--primary);
        }

        .auto-nav-label {
            font-weight: 600;
            color: var(--primary);
            white-space: nowrap;
        }

        .reset-btn-mini {
            background: #6c757d;
            color: white;
            border: none;
            border-radius: 2px;
            padding: 2px 4px;
            font-size: 0.65rem;
            font-weight: 600;
            cursor: pointer;
            text-align: center;
        }

        /* STATUS COMPACTO */
        .completion-status {
            background: #f8f9fa;
            border-radius: 3px;
            padding: 4px 5px;
            margin: 5px 0;
            border: 1px solid #dee2e6;
        }

        .status-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2px;
        }

        .status-text {
            font-size: 0.65rem;
            font-weight: 600;
        }

        .status-count {
            font-size: 0.65rem;
            font-weight: bold;
            color: var(--primary);
        }

        /* PENDENTES SUPER COMPACTOS */
        .pending-compact {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 2px;
            padding: 2px 3px;
            font-size: 0.6rem;
        }

        .pending-summary {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1px;
        }

        .pending-count {
            font-weight: bold;
            color: #856404;
            font-size: 0.65rem;
        }

        .pending-list-compact {
            display: flex;
            flex-wrap: wrap;
            gap: 2px;
            max-height: 18px;
            overflow-y: auto;
            padding: 1px 0;
        }

        .pending-number {
            background: #ffc107;
            color: #856404;
            font-weight: bold;
            padding: 0 2px;
            border-radius: 1px;
            font-size: 0.55rem;
            min-width: 12px;
            text-align: center;
            line-height: 1.2;
        }

        .pending-number.answered {
            background: #28a745;
            color: white;
            opacity: 0.5;
        }

        /* QUEST√ïES COMPACTAS */
        .question-block-mini {
            margin: 6px 0;
            padding: 8px;
            border: 1px solid #e0e0e0;
            border-radius: 3px;
            background: #fff;
            position: relative;
        }

        .question-text-mini {
            font-size: 0.8rem;
            font-weight: bold;
            margin-bottom: 6px;
            color: var(--primary);
            line-height: 1.2;
        }

        .options-mini {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .option-mini {
            padding: 5px 6px;
            border: 1px solid #eee;
            border-radius: 2px;
            cursor: pointer;
            display: flex;
            align-items: center;
            font-size: 0.75rem;
            min-height: 28px;
            position: relative;
        }

        input[type="radio"] {
            margin-right: 4px;
            transform: scale(0.8);
            accent-color: var(--primary);
        }

        .correct-answer {
            background-color: #d4edda !important;
            border-color: #28a745 !important;
            color: #155724;
        }

        .wrong-answer {
            background-color: #f8d7da !important;
            border-color: #dc3545 !important;
            color: #721c24;
        }

        /* BOT√ÉO DE REPORTAR NAS QUEST√ïES */
        .report-btn {
            background: transparent;
            color: #6c757d;
            border: 1px solid #dee2e6;
            border-radius: 2px;
            padding: 2px 6px;
            font-size: 0.55rem;
            cursor: pointer;
            margin-top: 4px;
            display: flex;
            align-items: center;
            gap: 3px;
            transition: all 0.2s;
        }

        .report-btn:hover {
            background: #f8f9fa;
            color: var(--danger);
            border-color: var(--danger);
        }

        /* BOT√ÉO DE REPORTAR NO GABARITO (canto superior direito) */
        .report-gabarito-btn {
            position: absolute;
            top: 8px;
            right: 8px;
            background: transparent;
            color: #6c757d;
            border: 1px solid #dee2e6;
            border-radius: 2px;
            padding: 1px 4px;
            font-size: 0.5rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 2px;
            transition: all 0.2s;
            z-index: 2;
        }

        .report-gabarito-btn:hover {
            background: #f8f9fa;
            color: var(--danger);
            border-color: var(--danger);
        }

        /* BOT√ïES DE NAVEGA√á√ÉO COMPACTOS */
        .nav-buttons {
            display: flex;
            gap: 4px;
            margin: 8px 0;
        }

        .nav-btn {
            flex: 1;
            padding: 6px 4px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 2px;
            font-weight: 600;
            font-size: 0.75rem;
            cursor: pointer;
            text-align: center;
            min-height: 32px;
        }

        .nav-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            opacity: 0.5;
        }

        /* BOT√ïES PRINCIPAIS COMPACTOS */
        .btn {
            padding: 8px;
            font-size: 0.8rem;
            font-weight: bold;
            border: none;
            border-radius: 3px;
            cursor: pointer;
            width: 100%;
            margin-top: 8px;
            min-height: 36px;
        }

        .btn-finish {
            background: var(--primary);
            color: white;
        }

        .btn-finish:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .btn-restart {
            background: var(--success);
            color: white;
            display: none;
        }

        .btn-restart-success {
            background: linear-gradient(135deg, var(--success), #1e7e34);
            color: white;
            display: none;
        }

        /* BOT√ÉO VOLTAR AO IN√çCIO */
        .btn-voltar-inicio {
            background: linear-gradient(135deg, var(--accent), #0056b3);
            color: white;
            border: none;
            display: none;
        }

        /* BOT√ÉO CONTINUAR BANCO */
        .btn-continuar-banco {
            background: linear-gradient(135deg, var(--info), #138496);
            color: white;
            border: none;
            display: none;
        }

        /* BOT√ÉO DE SIMULADO DE REFOR√áO */
        .btn-reforco {
            background: linear-gradient(135deg, var(--danger), #c82333);
            color: white;
            border: none;
            display: none;
        }

        /* BOT√ÉO DE REINICIAR BANCO */
        .btn-reiniciar-banco {
            background: linear-gradient(135deg, var(--purple), #5a32a3);
            color: white;
            border: none;
            display: none;
        }

        /* BOT√ÉO DE NOVO SIMULADO NO REFOR√áO */
        .btn-novo-simulado-reforco {
            background: linear-gradient(135deg, var(--warning), #e0a800);
            color: #856404;
            border: none;
            display: none;
        }

        /* RESULTADOS COMPACTOS */
        #results {
            display: none;
            padding: 10px;
            text-align: center;
            border: 1px solid var(--primary);
            margin: 8px 0;
            border-radius: 3px;
            background: #f8f9fa;
        }

        .result-title {
            font-size: 0.9rem;
            font-weight: bold;
            margin-bottom: 4px;
            color: var(--primary);
        }

        .score-mini {
            font-size: 1.1rem;
            margin: 4px 0;
            font-weight: 800;
            color: var(--primary);
        }

        /* MENSAGEM DE MOTIVA√á√ÉO */
        .motivation-message {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 3px;
            padding: 8px 10px;
            margin: 8px 0;
            font-size: 0.7rem;
            color: #856404;
            text-align: center;
        }

        .motivation-success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
        }

        .motivation-warning {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            color: #856404;
        }

        .motivation-danger {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
        }

        /* MODAL DE REPORTE - ATUALIZADO */
        .report-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .report-content {
            background: white;
            padding: 20px;
            border-radius: 8px;
            width: 95%;
            max-width: 500px;
            max-height: 85vh;
            overflow-y: auto;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .report-title {
            font-size: 1rem;
            font-weight: bold;
            color: var(--primary);
            margin-bottom: 15px;
            text-align: center;
            border-bottom: 2px solid var(--primary);
            padding-bottom: 10px;
        }

        .report-question-info {
            background: #f8f9fa;
            border-radius: 5px;
            padding: 10px;
            margin-bottom: 15px;
            border-left: 4px solid var(--accent);
        }

        .report-section {
            margin-bottom: 15px;
        }

        .report-section-title {
            font-size: 0.8rem;
            font-weight: bold;
            color: var(--primary);
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .report-options {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin: 10px 0;
        }

        .report-option {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .report-option:hover {
            background: #f8f9fa;
            border-color: var(--accent);
        }

        .report-option input[type="radio"] {
            margin: 0;
            transform: scale(0.9);
        }

        .report-option label {
            font-size: 0.75rem;
            cursor: pointer;
            flex: 1;
        }

        /* FORMUL√ÅRIO DE IDENTIFICA√á√ÉO */
        .user-info-form {
            background: #f0f8ff;
            border-radius: 5px;
            padding: 15px;
            margin: 15px 0;
            border: 1px solid #cce5ff;
        }

        .form-group {
            margin-bottom: 12px;
        }

        .form-label {
            display: block;
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 4px;
        }

        .form-input {
            width: 100%;
            padding: 8px 10px;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            font-size: 0.8rem;
            font-family: inherit;
            transition: border-color 0.2s;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 2px rgba(0,123,255,0.1);
        }

        .form-input.error {
            border-color: var(--danger);
            background-color: #fff5f5;
        }

        .form-hint {
            font-size: 0.65rem;
            color: #6c757d;
            margin-top: 4px;
            display: block;
        }

        .required-star {
            color: var(--danger);
            font-weight: bold;
        }

        .report-textarea {
            width: 100%;
            min-height: 80px;
            padding: 10px;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            font-size: 0.8rem;
            resize: vertical;
            font-family: inherit;
            transition: border-color 0.2s;
        }

        .report-textarea:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 2px rgba(0,123,255,0.1);
        }

        .report-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .report-submit {
            flex: 2;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 4px;
            padding: 12px;
            font-size: 0.85rem;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .report-submit:hover {
            background: #0d2c4a;
        }

        .report-submit:disabled {
            background: #6c757d;
            cursor: not-allowed;
            opacity: 0.7;
        }

        .report-cancel {
            flex: 1;
            background: #6c757d;
            color: white;
            border: none;
            border-radius: 4px;
            padding: 12px;
            font-size: 0.85rem;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .report-cancel:hover {
            background: #545b62;
        }

        .report-success {
            background: #d4edda;
            color: #155724;
            padding: 12px;
            border-radius: 5px;
            font-size: 0.8rem;
            text-align: center;
            margin-top: 15px;
            border: 1px solid #c3e6cb;
            display: none;
        }

        .report-error {
            background: #f8d7da;
            color: #721c24;
            padding: 10px;
            border-radius: 5px;
            font-size: 0.75rem;
            text-align: center;
            margin-top: 10px;
            border: 1px solid #f5c6cb;
            display: none;
        }

        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
            margin-right: 8px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* SCROLL PERSONALIZADO */
        .pending-list-compact::-webkit-scrollbar {
            height: 2px;
        }
        
        .pending-list-compact::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 1px;
        }
        
        .pending-list-compact::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 1px;
        }

        /* AJUSTES PARA TELAS MUITO PEQUENAS */
        @media (max-width: 320px) {
            body {
                padding: 2px;
                font-size: 12px;
            }
            
            .container {
                padding: 4px;
            }
            
            .page-title-mini {
                font-size: 0.75rem;
                max-width: 60%;
            }
            
            .timer-compact {
                font-size: 0.7rem;
                min-width: 35px;
                padding: 1px 3px;
            }
            
            .info-grid {
                gap: 3px;
            }
            
            .info-label {
                font-size: 0.5rem;
            }
            
            .info-value {
                font-size: 0.7rem;
            }
            
            .question-text-mini {
                font-size: 0.75rem;
            }
            
            .option-mini {
                padding: 4px 5px;
                font-size: 0.7rem;
                min-height: 26px;
            }
            
            .nav-btn, .btn {
                font-size: 0.7rem;
                padding: 5px 3px;
            }
            
            .pending-list-compact {
                max-height: 16px;
            }
            
            .pending-number {
                font-size: 0.5rem;
                min-width: 10px;
            }
            
            .report-gabarito-btn {
                font-size: 0.45rem;
                padding: 1px 3px;
            }
            
            .report-content {
                padding: 15px;
            }
            
            .report-buttons {
                flex-direction: column;
            }
        }

        @media (max-height: 600px) {
            .header-mini {
                padding-top: 10px;
            }
            
            .question-block-mini {
                margin: 4px 0;
                padding: 6px;
            }
            
            .nav-buttons {
                margin: 6px 0;
            }
            
            .btn {
                margin-top: 6px;
                min-height: 32px;
            }
        }
    </style>
</head>
<body>

<div class="container" id="main-container">
    <div class="credits-integrated">BY EWERTON</div>
    
    <div class="header-mini">
        <div class="header-mini-top">
            <h1 class="page-title-mini" id="page-title">Carregando...</h1>
            <div id="timer" class="timer-compact">00:00</div>
        </div>
        
        <div class="simulado-info" id="simulado-info">
            <div>Simulado: <span id="questions-per-simulado">20</span> quest√µes</div>
            <div class="simulado-stats">
                <span id="remaining-questions">Dispon√≠veis: 0</span>
                <span id="recent-used">Usadas: 0</span>
            </div>
            
            <div class="history-controls">
                <button class="clear-history-btn" onclick="clearHistory()">
                    üóëÔ∏è Limpar Hist√≥rico
                </button>
                <button class="info-history-btn" onclick="showHistoryInfo()">
                    ‚ÑπÔ∏è Info
                </button>
            </div>
        </div>
        
        <div class="quiz-info-mini">
            <div class="info-grid">
                <div class="info-item">
                    <div class="info-label">Quest√£o</div>
                    <div class="info-value" id="question-counter">0/0</div>
                </div>
                <div class="info-item">
                    <div class="info-label">Respondidas</div>
                    <div class="info-value" id="answered-counter">0/0</div>
                </div>
                <div class="info-item">
                    <div class="info-label">Progresso</div>
                    <div class="info-value" id="progress-percent">0%</div>
                </div>
            </div>
            
            <div class="controls-compact">
                <div class="auto-nav-toggle" onclick="toggleAutoNav()">
                    <input type="checkbox" id="auto-nav-checkbox" class="auto-nav-checkbox" checked>
                    <label class="auto-nav-label">Auto-navega√ß√£o</label>
                </div>
                <button class="reset-btn-mini" onclick="resetQuiz()">
                    ‚Üª Reiniciar
                </button>
            </div>
        </div>

        <div class="completion-status">
            <div class="status-header">
                <span class="status-text">Status:</span>
                <span class="status-count" id="status-count">0/0</span>
            </div>
            <div class="pending-compact" id="pending-questions">
                <div class="pending-summary">
                    <span>Pendentes:</span>
                    <span class="pending-count" id="pending-count">0</span>
                </div>
                <div class="pending-list-compact" id="pending-list">
                    <span style="color: #6c757d; font-style: italic;">Nenhuma pendente</span>
                </div>
            </div>
        </div>
    </div>

    <div id="results">
        <div class="result-title" id="feedback-msg"></div>
        <div class="score-mini" id="final-score"></div>
        <div id="final-percent" style="font-size: 0.8rem; font-weight: bold; margin-bottom: 6px; color: var(--accent);"></div>
        <div id="motivation-message" class="motivation-message"></div>
        <div id="simulado-summary" style="margin-bottom: 8px; font-size: 0.7rem; color: var(--primary);"></div>
        
        <button id="restart-btn" class="btn btn-restart" onclick="startNewQuiz()">üîÑ Refazer Simulado</button>
        <button id="voltar-inicio-btn" class="btn btn-voltar-inicio" onclick="voltarAoInicio()">
            üèÅ Voltar ao In√≠cio
        </button>
        <button id="continuar-banco-btn" class="btn btn-continuar-banco" onclick="continuarComBanco()">
            üìö Continuar com Banco
        </button>
        <button id="wrong-questions-btn" class="btn btn-reforco" onclick="startWrongQuestionsSimulado()">
            ‚ö° Simulado de Refor√ßo
        </button>
        <button id="reiniciar-banco-btn" class="btn btn-reiniciar-banco" onclick="reiniciarBancoCompleto()">
            üîÑ Reiniciar Banco Completo
        </button>
        <button id="new-simulado-btn" class="btn" style="background: var(--accent); color: white; margin-top: 4px; display: none;" onclick="generateNewSimulado()">üé≤ Novo Simulado</button>
        <!-- NOVO BOT√ÉO PARA SIMULADO DE REFOR√áO -->
        <button id="novo-simulado-reforco-btn" class="btn btn-novo-simulado-reforco" onclick="novoSimuladoAposReforco()">
            üéØ Novo Simulado
        </button>
    </div>

    <div id="quiz-content"></div>

    <div class="nav-buttons">
        <button id="prev-btn" class="nav-btn" onclick="prevQuestion()" disabled>
            ‚Üê Anterior
        </button>
        <button id="next-btn" class="nav-btn" onclick="nextQuestion()">
            Pr√≥ximo ‚Üí
        </button>
    </div>

    <button id="finish-btn" class="btn btn-finish" onclick="finalizeQuiz()" disabled>
        üèÅ Finalizar
    </button>
</div>

<!-- MODAL DE REPORTE ATUALIZADO -->
<div id="reportModal" class="report-modal">
    <div class="report-content">
        <div class="report-title">üìù Reportar Quest√£o</div>
        
        <div class="report-question-info">
            <div><strong>Quest√£o #<span id="reportQuestionNumber">1</span></strong></div>
            <div id="reportQuestionText" style="font-size: 0.75rem; margin-top: 5px;">Carregando...</div>
        </div>
        
        <!-- SE√á√ÉO: TIPO DE PROBLEMA -->
        <div class="report-section">
            <div class="report-section-title">üìå Tipo de Problema</div>
            <div class="report-options">
                <div class="report-option">
                    <input type="radio" id="reportError" name="reportType" value="error">
                    <label for="reportError">‚ùå Quest√£o com erro</label>
                </div>
                <div class="report-option">
                    <input type="radio" id="reportWrongAnswer" name="reportType" value="wrong_answer">
                    <label for="reportWrongAnswer">‚ö†Ô∏è Resposta incorreta</label>
                </div>
                <div class="report-option">
                    <input type="radio" id="reportConfusing" name="reportType" value="confusing">
                    <label for="reportConfusing">ü§î Enunciado confuso</label>
                </div>
                <div class="report-option">
                    <input type="radio" id="reportAlternative" name="reportType" value="alternative">
                    <label for="reportAlternative">üî§ Alternativas erradas</label>
                </div>
                <div class="report-option">
                    <input type="radio" id="reportOther" name="reportType" value="other">
                    <label for="reportOther">üìù Outro problema</label>
                </div>
            </div>
        </div>
        
        <!-- SE√á√ÉO: SUA IDENTIFICA√á√ÉO -->
        <div class="report-section">
            <div class="report-section-title">üë§ Sua Identifica√ß√£o <span class="required-star">*</span></div>
            <div class="user-info-form">
                <div class="form-group">
                    <label class="form-label" for="userName">Nome Completo <span class="required-star">*</span></label>
                    <input type="text" id="userName" class="form-input" placeholder="Digite seu nome completo" maxlength="100">
                    <span class="form-hint">Para podermos entrar em contato com voc√™</span>
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="userEmail">E-mail <span class="required-star">*</span></label>
                    <input type="email" id="userEmail" class="form-input" placeholder="seu.email@exemplo.com" maxlength="100">
                    <span class="form-hint">Para enviarmos o feedback sobre sua solicita√ß√£o</span>
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="userInfo">Institui√ß√£o/Curso (opcional)</label>
                    <input type="text" id="userInfo" class="form-input" placeholder="Ex: SENAI, Engenharia Mec√¢nica" maxlength="100">
                    <span class="form-hint">Ajuda a identificar o contexto do reporte</span>
                </div>
            </div>
        </div>
        
        <!-- SE√á√ÉO: DETALHES -->
        <div class="report-section">
            <div class="report-section-title">üìã Detalhes do Problema</div>
            <textarea 
                id="reportDetails" 
                class="report-textarea" 
                placeholder="Descreva detalhadamente o problema encontrado na quest√£o. Se achar que h√° erro na resposta, explique sua justificativa..."
                maxlength="1000"
            ></textarea>
            <div class="form-hint" style="text-align: right;">
                <span id="charCount">0</span>/1000 caracteres
            </div>
        </div>
        
        <div id="reportErrorMsg" class="report-error"></div>
        
        <div class="report-buttons">
            <button id="cancelReport" class="report-cancel" onclick="closeReportModal()">Cancelar</button>
            <button id="submitReport" class="report-submit" onclick="submitReport()">
                <span id="submitText">Enviar Reporte</span>
                <span id="submitLoading" class="loading-spinner" style="display: none;"></span>
            </button>
        </div>
        
        <div id="reportSuccess" class="report-success">
            ‚úÖ Reporte enviado com sucesso! Obrigado pela contribui√ß√£o.<br>
            <small>Voc√™ receber√° um feedback por email em breve.</small>
        </div>
    </div>
</div>

<script>
    // ============================================
    // BANCO DE QUEST√ïES - ADICIONE AS SUAS AQUI
    // ============================================
    
    // FORMATO: {q: "Pergunta?", a: ["Op√ß√£o A", "Op√ß√£o B", "Op√ß√£o C", "Op√ß√£o D"], c: 0}
    // Onde 'c' √© o √≠ndice da resposta correta (0 = A, 1 = B, 2 = C, 3 = D)
    
 const masterBank = [

  {q: "Filtro de √≥leo que tem um cartucho feito de discos e espa√ßadores:", a: ["tipo tela", "do tipo \"cuno\"", "labirinto de ar", "papel cl√¥nico"], c: 1},
  {q: "A inspe√ß√£o das porcas que fixam os cilindros ao bloco do motor ou parafusos de cabe√ßa, quanto √† seguran√ßa √© realizada:", a: ["durante o i√ßamento do motor", "ap√≥s o voo de teste", "se houver sobre temperatura moment√¢nea", "somente no pr√©-voo"], c: 1},
  {q: "A maior parte das conex√µes el√©tricas, eletrodutos e cabos, s√£o padronizados atrav√©s do uso de conectores do tipo:", a: ["AN (Army/Navy), MS (Military Standards) ou BAC (Boeing Aircraft Company)", "AN (Army/Navy) ou MS (Military Standards)", "AN (Army/Navy) somente", "MS (Military Standards) somente"], c: 1},
  {q: "Uma h√©lice girando sofre a a√ß√£o das for√ßas?", a: ["centr√≠fuga, de tor√ß√£o e de flex√£o", "centr√≠peta, de tor√ß√£o e de flex√£o", "centr√≠fuga, de tor√ß√£o e de tra√ß√£o", "centr√≠fuga, tor√ß√£o, flex√£o e de tra√ß√£o"], c: 0},
  {q: "Qual tipo de madeira abaixo na maioria das vezes, √© o mais amplamente usado na constru√ß√£o de uma h√©lice de madeira?", a: ["vidoeiro", "cerejeira", "nogueira preta", "carvalho ou Mogno"], c: 0},
  {q: "Quanto √† h√©lice de velocidade constante, qual alternativa abaixo est√° incorreta?", a: ["o cubo de a√ßo consiste de uma aranha de a√ßo, a qual suporta as p√°s de alum√≠nio, com um tubo penetrando na base das p√°s", "essas h√©lices podem ser capazes de embandeirar e inverter o passo", "essas h√©lices podem ser do tipo n√£o embandeir√°vel", "o √¢ngulo de p√° n√£o pode ser modificado ap√≥s a constru√ß√£o da h√©lice"], c: 3},
  {q: "Dentre as alternativas abaixo qual est√° incorreta?", a: ["o passo efetivo √© a dist√¢ncia realmente percorrida", "o recuo da h√©lice √© a rela√ß√£o entre o passo geom√©trico da h√©lice e o passo te√≥rico", "a for√ßa necess√°ria para girar as p√°s √© fornecida pelo motor", "o passo geom√©trico √© a dist√¢ncia que uma h√©lice deveria avan√ßar em uma revolu√ß√£o"], c: 1},
  {q: "Um par t√©rmico depende da raz√£o de aumento da temperatura, e n√£o d√° o alarme quando um motor superaquece lentamente, ou quando ocorre um curto-circuito. Quais os materiais que s√£o empregados na constru√ß√£o do par t√©rmico?", a: ["cromes e a√ßo", "inconel e cromel", "cromel e constantan", "inconel e constantan"], c: 2},
  {q: "No sistema de detec√ß√£o de fogo no motor por termopar, se houver fogo, a jun√ß√£o quente aquecer√° mais rapidamente que a jun√ß√£o de refer√™ncia, gerando uma voltagem que causar√° um fluxo de corrente no circuito detector. Quando o termopar completar√° o circuito de acendimento da luz de fogo?", a: ["resist√™ncia no circuito detector for menor que 0,004 ohms", "corrente no circuito detector for maior que 0,4 amperes", "corrente no circuito detector for maior que 0,004 amperes", "tens√£o no circuito detector for maior que 0,004 volt"], c: 2},
  {q: "Um sistema completo de prote√ß√£o contra fogo, inclui tanto um sistema de detec√ß√£o como de extin√ß√£o de fogo. Os dois tipos de detectores usados nos sistemas sensores cont√≠nuos s√£o:", a: ["Kidde e Fenwal", "em s√©rie e paralelo", "cromel e constantan", "cromel e alumel"], c: 0},
  {q: "Os dois tipos de detectores de fogo do motor, usados nos sistemas de sensores cont√≠nuos, s√£o os sistemas Kidde e o Fenwal. Quantos fios existem no sistema cont√≠nuo Kidde?", a: ["dois", "um", "quatro", "tr√™s"], c: 0},
  {q: "Quanto ao procedimento de manuten√ß√£o do sistema de detec√ß√£o de fogo dos motores, a alternativa incorreta √©:", a: ["a dist√¢ncia entre as bra√ßadeiras de fixa√ß√£o nos espa√ßos retos, deve ser normalmente de 1 polegada, conforme a especifica√ß√£o de cada fabricante", "se√ß√µes muito longas entre suportes podem permitir excessiva vibra√ß√£o e causar a quebra", "o primeiro suporte de fixa√ß√£o ap√≥s uma conex√£o, normalmente √© colocado entre 4 e 6 polegadas da conex√£o de jun√ß√£o", "na maioria dos casos, uma raio de 1 polegada √© mantido antes e ap√≥s um conector, para ent√£o ser feita uma curva. Um raio de curva de 3 polegadas, normalmente √© usado tamb√©m"], c: 0},
  {q: "Os termopares que medem a temperatura de opera√ß√£o dos motores a pist√£o s√£o instalados:", a: ["no carburador", "no coletor de escapamento", "na cabe√ßa do cilindro", "na turbina"], c: 2},
  {q: "O sistema HDR (Alta-Raz√£o-de-Descarga) usa tubos sem restri√ß√£o na sa√≠da:", a: ["para dificultar a sa√≠da do elemento extintor para que este atue por mais tempo", "para liberar uma quantidade de agente extintor em 1 ou 2 segundos", "para liberar o agente extintor lenta e gradualmente para n√£o danificar os motores", "para garantir a extin√ß√£o do fogo pelo agente extintor em at√© 5 segundos"], c: 1},
  {q: "Sistema de detec√ß√£o de fogo no motor que pode resistir a uma falha, que pode ser uma abertura no circuito el√©trico ou um curto para a massa, sem indicar um falso alarme de fogo:", a: ["Kidde", "par t√©rmico", "fenwal spot", "fenwal"], c: 2},
  {q: "Quem devolve ao reservat√≥rio atrav√©s do radiador, o √≥leo proveniente de vazamentos internos?", a: ["v√°lvula de dreno", "v√°lvula de desvio", "bomba de recalque", "bomba de recupera√ß√£o"], c: 3},
  {q: "√â a parte grossa e circular pr√≥xima da base, a qual √© designada a dar resist√™ncia √† p√°:", a: ["rotor", "flanco", "base", "strut"], c: 1},
  {q: "A opera√ß√£o de embandeiramento e desembandeiramento da h√©lice √© controlada pelo(a)?", a: ["Conjunto da c√∫pula", "Governador", "Aranha", "V√°lvula distribuidora"], c: 1},
  {q: "Drenar o composto anti-corrosivo do motor faz parte do procedimento de:", a: ["desestocagem", "estocagem", "instala√ß√£o", "remo√ß√£o"], c: 0},
  {q: "Quando a vibra√ß√£o da h√©lice for a raz√£o da excessiva vibra√ß√£o do grupo motopropulsor, o problema poder√° ser causado por:", a: ["falta de lubrifica√ß√£o adequada nos rolamentos ou engrenagens do grupo motopropulsor ou centraliza√ß√£o das p√°s incorreta", "falta de balanceamento das p√°s, centraliza√ß√£o das p√°s incorreta ou varia√ß√£o do √¢ngulo das p√°s", "falta de balanceamento das p√°s, centraliza√ß√£o das p√°s incorreta ou torque excessivo no cubo da h√©lice", "desalinhamento do eixo da h√©lice ou desgaste dos coxins de fixa√ß√£o"], c: 1},
  {q: "Ao fazer uma inspe√ß√£o na cabe√ßa do cilindro, se forem encontradas rachaduras na base das aletas, o cilindro deve ser:", a: ["rejeitado", "retrabalhado", "reinstalado normalmente", "submetido a um ensaio n√£o-destrutivo"], c: 0},
  {q: "De acordo com a classifica√ß√£o de toxicidade da UL, qual agente apresenta o menor risco √† vida em caso de exposi√ß√£o operacional?", a: ["Halon 1101", "Halon 1201", "Halon 1301", "Halon 1302"], c: 2},
  {q: "Na sequ√™ncia da partida de um motor a rea√ß√£o o mec√¢nico observa que h√° combust√≠vel saindo pelo dreno da nacele, indicando que a v√°lvula dreno n√£o est√° fechada, neste caso:", a: ["Aumentamos a pot√™ncia do motor para tentar compensar a perda de combust√≠vel", "Desligamos apenas a chave de igni√ß√£o, mantendo o combust√≠vel fluindo para evitar interrup√ß√µes na partida", "Baixamos a rota√ß√£o para marcha lenta e fechamos manualmente a v√°lvula de dreno, se for poss√≠vel continuamos o procedimento de partida sempre priorizando a seguran√ßa", "Desligamos a chave do combust√≠vel e da igni√ß√£o, descontinuando imediatamente a partida"], c: 3},
  {q: "Se pequenas part√≠culas met√°licas forem encontradas no √≥leo de um motor convencional, o procedimento a ser adotado √©:", a: ["girar o motor", "substituir o motor", "drenar e substituir todo o √≥leo", "apenas trocar o elemento filtrante"], c: 2},
  {q: "Proje√ß√£o de metal reto ou circular geralmente ocasionado pelo processo de usinagem, broqueamento, serragem, fura√ß√£o, aplainamento, etc.. Apresenta-se com uma protuber√¢ncia de metal nas bordas das pe√ßas:", a: ["Atrito", "Rebarba", "Brunidura", "Abras√£o"], c: 1},
  {q: "As alhetas dos cilindros servem para:", a: ["Melhorar o resfriamento do cilindro", "Aumentar a resist√™ncia mec√¢nica do cilindro", "Diminuir o arrasto aerodin√¢mico do motor", "Nenhuma das acima"], c: 0},
  {q: "O mecanismo de mudan√ßa de passo das h√©lices hidrom√°ticas √© um sistema que atua com for√ßa?", a: ["Hidr√°ulico e pneum√°tica", "Hidr√°ulico - press√£o", "Hidr√°ulico - el√©trica", "Hidr√°ulico-mec√¢nico"], c: 3},
  {q: "A inspe√ß√£o feita no disco da turbina e palhetas tem como objetivo mais importante a detec√ß√£o de:", a: ["corros√£o", "rachadura", "eros√£o", "super aquecimento"], c: 1},
  {q: "Na desestocagem de motores radiais, √© essencial verificar cuidadosamente os cilindros mais baixos e seus dutos de admiss√£o. Isso ocorre porque o composto anticorrosivo, ap√≥s armazenamento, pode se acumular nessas √°reas. A maior parte desse composto deve ser drenada da seguinte forma:", a: ["removendo o c√°rter do motor e deixando o composto escorrer por gravidade", "utilizando uma bomba de v√°cuo para sugar o composto anticorrosivo atrav√©s do filtro de √≥leo", "utilizando uma ferramenta especial para perfurar o cabe√ßote dos cilindros e permitir a drenagem do composto", "pelos orif√≠cios das velas de igni√ß√£o dos cilindros mais baixos quando os indicadores de umidade forem removidos"], c: 3},
  {q: "O sistema de prote√ß√£o contra fogo do motor de uma aeronave turbojato √© projetado para detectar e combater inc√™ndios nos motores. Qual √© a sequ√™ncia correta de a√ß√µes a serem tomadas na ocorr√™ncia de um inc√™ndio ou superaquecimento?", a: ["uma sirene de alarme soa e o piloto deve esperar 10 segundos antes de puxar o punho de fogo. Em seguida, o sistema redireciona a alimenta√ß√£o de combust√≠vel para o motor principal", "uma luz de aviso acende no painel principal, e o piloto deve pressionar o bot√£o de descarga automaticamente antes de puxar o punho de fogo. O sistema ent√£o ativa o alarme sonoro e direciona o agente extintor para a cabine de comando", "uma luz de aviso acende no punho de fogo. O piloto puxa o punho para ativar o sistema. Isso corta o ar para o motor afetado e direciona o agente extintor para ele", "uma luz de aviso acende no painel principal, e o piloto deve pressionar o bot√£o de descarga autom√°tica antes de puxar o punho de fogo. O sistema ent√£o direciona o agente extintor para a cabine de comando"], c: 2},
  {q: "Durante processos de usinagem ou esfor√ßos excessivos concentrados em componentes de motor, qual defeito √© descrito como sobras de corte de metal ou libera√ß√£o de lascas?", a: ["Rebarba, que se forma como proje√ß√£o de metal nas bordas das pe√ßas durante usinagem ou esfor√ßos concentrados.", "Cavaco, descrito como sobras de corte de metal ou libera√ß√£o de lascas causados por usinagem ou esfor√ßos excessivos.", "Corte, caracterizado por perda de metal ao longo de uma √°rea por meios mec√¢nicos durante processos de usinagem.", "Raspado, produzido pelo movimento de objetos agudos que causam sobras de material durante processos mec√¢nicos."], c: 1},
  {q: "A finalidade do conjunto do cubo da h√©lice √©:", a: ["aumentar a RPM", "manter o passo m√°ximo", "manter o passo m√≠nimo", "prender as p√°s no eixo de manivelas"], c: 3},
  {q: "Motores que utilizam o sistema de c√°rter molhado estocam o √≥leo dentro do pr√≥prio motor, enquanto motores que utilizam o sistema de c√°rter seco utilizam:", a: ["um tanque externo, instalado no pr√≥prio motor ou pr√≥ximo ao motor", "dentro do pr√≥prio motor ou em um ponto de estrutura pr√≥ximo ao motor", "fora do motor para facilitar a troca de calor e o resfriamento", "dentro do pr√≥prio motor"], c: 0},
  {q: "Um √≥leo com alta temperatura, fluindo rapidamente, est√° com caracter√≠stica de:", a: ["alta viscosidade", "alta volatilidade", "baixa viscosidade", "baixa volatilidade"], c: 2},
  {q: "O que permite que os sistemas Kidde e Fenwal retornem automaticamente ao estado normal ap√≥s a extin√ß√£o de um fogo ou superaquecimento?", a: ["A fus√£o revers√≠vel da camada de cer√¢mica, que recupera a resist√™ncia el√©trica inicial.", "O realinhamento do campo magn√©tico do rel√© sens√≠vel, que reabre o circuito ap√≥s o alarme.", "A recupera√ß√£o da resist√™ncia el√©trica da cer√¢mica ou do sal eut√©tico quando a temperatura retorna ao n√≠vel normal.", "A desativa√ß√£o manual do rel√© escravo, que resseta o circuito de alarme para condi√ß√£o de prontid√£o."], c: 2},
  {q: "Qual √© a principal semelhan√ßa entre os sistemas de interruptores t√©rmicos e os sistemas cont√≠nuos, apesar de diferen√ßas de abrang√™ncia?", a: ["Ambos atuam em fun√ß√£o de um limite fixo de temperatura, sem sensibilidade direta √† taxa de aumento t√©rmico.", "Ambos dependem exclusivamente de termopares para medir varia√ß√£o de tens√£o entre jun√ß√µes met√°licas.", "Ambos disparam o alarme apenas quando h√° simult√¢neo aquecimento das jun√ß√µes quente e de refer√™ncia.", "Ambos funcionam com base na fus√£o de sais eut√©ticos embebidos em material cer√¢mico."], c: 0},
  {q: "Os inc√™ndios em equipamentos el√©tricos no interior de aeronaves, devem ser apagados com extintores de:", a: ["√Ågua", "Espuma", "Di√≥xido de carbono", "P√≥ qu√≠mico branco"], c: 2},
  {q: "Reduzir a temperatura do √≥leo do motor, a um valor aceit√°vel para a recircula√ß√£o atrav√©s do sistema de lubrifica√ß√£o √© finalidade do(a):", a: ["filtro", "radiador", "v√°lvula by-pass", "v√°lvula termoest√°tica"], c: 1},
  {q: "O tempo necess√°rio para embandeirar, depende da quantidade de √≥leo que volta da h√©lice para o motor, e da for√ßa exercida pela mola e pelos contrapesos. Geralmente neste tipo de sistema o tempo normal de embandeiramento, √© de:", a: ["tr√™s segundos", "dez segundos", "de sete a dez segundos", "tr√™s a dez segundos"], c: 3},
  {q: "Rachaduras pr√≥ximas das bordas das aletas de refrigera√ß√£o do cilindro implicam em:", a: ["Reparo de acordo com o manual do fabricante", "reparo com furo de parada", "remo√ß√£o de partes danificadas e retrabalho de suaviza√ß√£o dos contornos", "rejei√ß√£o do cilindro"], c: 2},
  {q: "A dist√¢ncia que uma h√©lice deveria avan√ßar em uma revolu√ß√£o √©:", a: ["a dist√¢ncia realmente percorrida por uma h√©lice", "a dist√¢ncia que reconhece o recuo da h√©lice no ar", "chamado de passo te√≥rico ou geom√©trico", "chamado de passo real ou geom√©trico"], c: 2},
  {q: "O combust√≠vel √© sangrado para remover bolhas de ar, impurezas e contaminantes do sistema de combust√≠vel. Qual a quantidade aproximada indicada a ser sangrada?", a: ["1/2 Gal√£o", "1 Gal√£o", "2 Gal√µes", "3 Gal√µes"], c: 1},
  {q: "Dependendo do recuo, a h√©lice ter√° uma efici√™ncia que varia de:", a: ["50% a 87%", "57% a 87%", "50% a 75%", "55% a 88%"], c: 0},
  {q: "A v√°lvula que determina qual das vias de √≥leo ser√° tomada em dire√ß√£o ao radiador:", a: ["dreno", "al√≠vio", "by-pass", "controle de fluxo"], c: 3},
  {q: "Um sistema el√©trico de controle do gelo da h√©lice consiste basicamente de uma fonte de energia, um elemento de resist√™ncia de aquecimento, controles do sistema e a necess√°ria fia√ß√£o. Os elementos de aquecimento s√£o montados:", a: ["interna ou externamente no cone e nas p√°s", "interna ou externamente na p√° somente", "interna ou externamente no cone somente", "internamente no cone e nas p√°s somente"], c: 0},
  {q: "O embandeiramento da h√©lice √© realizado pelo governador, atrav√©s de:", a: ["comando el√©trico", "diminui√ß√£o do RPM", "al√≠vio da press√£o de ar", "al√≠vio da press√£o de √≥leo"], c: 3},
  {q: "Numa turbina de 36 palhetas ao se instalar a primeira palheta na posi√ß√£o de n√∫mero 10, deve-se instalar a segunda na posi√ß√£o de n√∫mero:", a: ["18", "19", "28", "36"], c: 2},
  {q: "O ponto de vapor e o ponto de chama de um √≥leo de motor s√£o par√¢metros determinados em laborat√≥rio. Qual √© o objetivo principal desses ensaios?", a: ["Avaliar a capacidade do √≥leo de resistir a cargas de impacto no virabrequim e nas bielas.", "Indicar a temperatura na qual o √≥leo inicia vaporiza√ß√£o e pode sustentar igni√ß√£o por chama.", "Medir a propor√ß√£o entre massa de √≥leo e massa equivalente de √°gua destilada a 20¬∞C.", "Determinar a viscosidade relativa em um Viscos√≠metro Universal de Saybolt sob fluxo controlado."], c: 1},
  {q: "No procedimentos para pesquisa de problemas no sistema de √≥leo do motor, a indica√ß√£o de temperatura de √≥leo alta ou baixa pode ser problema t√≠pico de:", a: ["fornecimento inadequado de √≥leo, √≥leo contaminado ou obstru√ß√£o no tanque de √≥leo", "Viscosidade de √≥leo muito baixa, ou n√≠vel de √≥leo no tanque muito baixo", "√≥leo contaminado ou dilu√≠do, ou n√≠vel de √≥leo no tanque muito alto", "viscosidade de √≥leo incorreta ou √≥leo contaminado"], c: 0},
  {q: "A h√©lice percorre uma dist√¢ncia denominada passo efetivo quando:", a: ["comandada para o passo m√≠nimo", "comandada para o passo m√°ximo", "realiza uma volta completa, levando em considera√ß√£o o recuo", "realiza uma volta completa, sem o recuo"], c: 2},
  {q: "Dano caracterizado pela perda de metal por processo qu√≠mico ou eletroqu√≠mico, os res√≠duos s√£o geralmente f√°ceis de serem removidos por processos mec√¢nicos:", a: ["atrito", "delamina√ß√£o", "corros√£o", "abras√£o"], c: 2},
  {q: "Qual a principal justificativa para a dilui√ß√£o do √≥leo com gasolina durante partidas em clima frio?", a: ["Facilitar a atomiza√ß√£o do combust√≠vel no carburador, reduzindo falhas de igni√ß√£o inicial.", "Aumentar a press√£o do √≥leo no man√¥metro, assegurando indica√ß√£o positiva no painel.", "Promover combust√£o parcial do √≥leo acumulado, prevenindo risco de falha hidr√°ulica.", "Diminuir a viscosidade do √≥leo, permitindo que alcance mais rapidamente as superf√≠cies a lubrificar."], c: 3},
  {q: "Principais vantagens do √≥leo sint√©tico em rela√ß√£o ao √≥leo derivado de petr√≥leo:", a: ["menos tend√™ncia √† forma√ß√£o de borra e a evaporar em altas temperaturas", "tend√™ncia a formar bolhas e remover a tinta da superf√≠cie que entre em contato com o mesmo", "maior resist√™ncia a altas temperaturas sem perder a efici√™ncia", "maior facilidade de dissipar o calor"], c: 0},
  {q: "A finalidade de instalar o tanque de √≥leo do motor em local acima da bomba √© garantir:", a: ["que o √≥leo circule descontaminado", "a circula√ß√£o do √≥leo caso o filtro entupa", "que o √≥leo n√£o trasborde quando no abastecimento", "o suprimento na linha da bomba por gravidade"], c: 3},
  {q: "Nos tanques de √≥leo de c√°rter seco, o tubo interno ou turbilhonador acelerador de temperatura tem como fun√ß√£o:", a: ["Manter constante a viscosidade do √≥leo por meio de troca t√©rmica direta com o ar externo.", "Reduzir a quantidade de √≥leo a ser dilu√≠do, acelerando seu aquecimento durante a partida do motor.", "Evitar a forma√ß√£o de sedimentos e a √°gua na regi√£o inferior do coletor de √≥leo.", "Atuar como um defletor interno para eliminar bolhas e reduzir a espuma do √≥leo."], c: 1},
  {q: "O √¢ngulo da p√°, cujo arrasto da h√©lice √© m√°ximo, denomina-se:", a: ["passo chato ou passo m√≠nimo", "passo chato ou passo m√°ximo", "passo m√°ximo", "passo bandeira"], c: 0},
  {q: "O sistema t√≠pico de Lubrifica√ß√£o por c√°rter seco de motores a jato s√£o do tipo:", a: ["Baixa press√£o", "Alta press√£o", "Salpico", "Recalque"], c: 1},
  {q: "O passo geom√©trico de uma h√©lice:", a: ["√© a dist√¢ncia realmente percorrida por uma h√©lice", "reconhece o recuo da h√©lice no ar", "tamb√©m chamado de passo te√≥rico √© a dist√¢ncia que uma h√©lice deveria avan√ßar em uma revolu√ß√£o", "tamb√©m chamado de passo real √© a dist√¢ncia que uma h√©lice deveria avan√ßar"], c: 2},
  {q: "Por que os detectores Fenwal spot s√£o conectados em paralelo entre dois circuitos completos de fia√ß√£o?", a: ["Para que o sistema opere proporcionalmente a taxa de aumento da temperatura na zona monitorada.", "Para permitir redund√¢ncia el√©trica, evitando falso alarme em curto de para a massa ou abertura de circuito.", "Para possibilitar a medi√ß√£o de temperatura m√©dia do compartimento, reduzindo a necessidade de m√∫ltiplos sensores.", "Para acionar simultaneamente rel√©s escravos que garantem o rearme autom√°tico ap√≥s o resfriamento."], c: 1},
  {q: "√â a temperatura medida na cabe√ßa do cilindro do motor a pist√£o e √© um par√¢metro cr√≠tico para monitorar a sa√∫de e opera√ß√£o do motor:", a: ["Termo Couple (TC)", "Electronic Control Unit (ECU)", "Exhaust gas temperature (EGT)", "Cylinder Head Temperature (CHT)"], c: 3},
  {q: "Na h√©lice hidrom√°tica, o que move as p√°s em dire√ß√£o ao passo m√°ximo √© o(a):", a: ["Mola", "Tor√ß√£o centr√≠fuga", "Contrapeso", "√ìleo hidr√°ulico"], c: 3},
  {q: "A maioria dos motores turbojato s√£o equipados com um sistema de igni√ß√£o do tipo:", a: ["eletr√¥nico de alta pot√™ncia", "eletr√¥nico de baixa pot√™ncia", "el√©trico tipo platinado", "capacitivo de alta energia"], c: 3},
  {q: "A v√°lvula de al√≠vio do sistema de lubrifica√ß√£o tem a finalidade de:", a: ["limitar a press√£o de √≥leo do sistema", "permitir que o √≥leo n√£o entre no motor", "drenar o √≥leo em excesso para a linha de abastecimento", "determinar que das vias de √≥leo seja tomada em dire√ß√£o ao radiador"], c: 0},
  {q: "A tra√ß√£o produzida por uma h√©lice representa uma por√ß√£o espec√≠fica do torque total absorvido, sendo que uma parte consider√°vel √© perdida devido a fatores inerentes ao funcionamento do sistema propulsivo. Na m√©dia, a tra√ß√£o constitui aproximadamente:", a: ["80% do torque (cavalo-for√ßa absorvido pela h√©lice). Os outros 20% s√£o perdidos na fric√ß√£o e no recuo", "90% do torque (cavalo-for√ßa absorvido pela h√©lice). Os outros 10% s√£o perdidos na fric√ß√£o e no recuo", "85% do torque (energia aproveitada pela h√©lice). O percentual restante de 15% √© perdido devido ao atrito e ao movimento de recuo da h√©lice", "75% do torque (energia aproveitada pela h√©lice). O percentual restante de 25% √© perdido devido ao atrito e ao movimento de recuo da h√©lice"], c: 0},
  {q: "A unidade de Controle de Combust√≠vel para o motor a jato √© o (a):", a: ["Turbina", "Compressor", "Carburador", "FCU"], c: 3},
  {q: "Uma das finalidades das engrenagens de redu√ß√£o da caixa de acess√≥rios do motor √©:", a: ["reduzir a velocidade do eixo de ressaltos", "limitar a velocidade de rota√ß√£o da h√©lice", "aumentar a velocidade de rota√ß√£o do motor", "aumentar a velocidade de rota√ß√£o do eixo de manivelas"], c: 1},
  {q: "Linha imagin√°ria que atravessa a p√° do bordo de ataque ao bordo de fuga?", a: ["Porta", "Corda", "Curvatura", "Ataque"], c: 1},
  {q: "No procedimentos para pesquisa de problemas no sistema de √≥leo do motor, a forma√ß√£o de bolhas pode ser problema t√≠pico de:", a: ["Viscosidade do √≥leo muito alta ou √≥leo contaminado", "√ìleo contaminado ou dilu√≠do, ou n√≠vel de √≥leo no tanque muito alto", "Vazamento na linha ou baixo n√≠vel de √≥leo", "Viscosidade do √≥leo muito baixa, ou n√≠vel de √≥leo no tanque muito baixo"], c: 1},
  {q: "A revis√£o maior consiste na desmontagem completa e no recondicionamento de todo o grupo motopropulsor do motor. Esse tipo de revis√£o √© essencial para garantir o bom funcionamento e a seguran√ßa da aeronave. O per√≠odo para realizar essa revis√£o completa √© determinado pelo (a):", a: ["fabricante do motor somente", "autoridade aeron√°utica do pa√≠s somente", "fabricante do motor ou por um m√°ximo de horas de opera√ß√£o entre as revis√µes, conforme aprovado pela FAA", "fabricante do motor ou por um m√°ximo de horas de opera√ß√£o entre as revis√µes, conforme aprovado pela ANAC"], c: 3},
  {q: "As p√°s das h√©lices t√™m perfis semelhantes aos:", a: ["Da asa", "Da fuselagem", "Do leme", "Dos ventiladores"], c: 0},
  {q: "Durante o funcionamento moment√¢neo do motor, o consumo de combust√≠vel √© indicado por:", a: ["totalizador", "tac√¥metro", "bar√¥metro", "flux√¥metro"], c: 3},
  {q: "A finalidade do sistema de sincronismo das h√©lices, dentre outras, √©:", a: ["permitir que elas operem em passo m√≠nimo, em voo de cruzeiro", "reduzir a vibra√ß√£o", "evitar o torque negativo", "economizar combust√≠vel"], c: 1},
  {q: "O man√¥metro para medi√ß√£o da press√£o do √≥leo √© posicionado:", a: ["logo ap√≥s a sa√≠da da bomba", "na entrada da bomba", "no interior da bomba", "no painel de instrumentos"], c: 0},
  {q: "O que √© um \"hung start\" em um motor a turbina:", a: ["refere-se √† situa√ß√£o em que o motor consegue atingir a velocidade necess√°ria para a marcha lenta antes do esperado", "ocorre quando o motor consegue manter a rota√ß√£o necess√°ria durante a fase inicial do processo de partida sem consumir muito combust√≠vel", "ocorre quando h√° uma falha na igni√ß√£o do motor durante a partida e resulta em rota√ß√£o excessiva", "ocorre quando o motor √© acionado, mas n√£o acelera at√© a rota√ß√£o de marcha lenta"], c: 3},
  {q: "A h√©lice √© fixada ao eixo do motor atrav√©s do componente denominado:", a: ["p√°", "cubo", "raiz", "c√∫pula"], c: 1},
  {q: "Uma √°rea desgastada ou com marcas, causadas por objetos estranhos entre as partes m√≥veis ou superf√≠cies √© definido como:", a: ["Rebarba", "Cavaco", "Brunidura", "Abras√£o"], c: 3},
  {q: "O instrumento que recebe o sinal el√©trico de um transmissor instalado na tubula√ß√£o de combust√≠vel, e que tem finalidade de indicar o consumo hor√°rio do motor, denomina-se:", a: ["hod√¥metro", "vacu√¥metro", "flux√¥metro", "liquid√¥metro"], c: 2},
  {q: "O controle de temperatura do √≥leo, pela varia√ß√£o do fluxo de √≥leo que passa pelo radiador, √© realizado atrav√©s de um(a):", a: ["ventoinha", "v√°lvula termost√°tica", "arruela de press√£o", "bomba"], c: 1},
  {q: "A efici√™ncia da h√©lice varia de 50% a 87%, depende:", a: ["Da tor√ß√£o em dire√ß√£o ao centro do cubo", "Do quanto ela recua", "Do quanto ela avan√ßa", "Do embandeiramento na condi√ß√£o de stop well"], c: 1},
  {q: "O sistema de prote√ß√£o contra fogo de uma aeronave turbojato detecta e combate inc√™ndios nos motores. Para permitir um acionamento r√°pido em emerg√™ncias, os pilotos controlam o sistema da cabine atrav√©s:", a: ["de punho manual e um interruptor el√©trico", "de uma alavanca de emerg√™ncia", "bot√£o de acionamento", "de uma alavanca de descarga autom√°tica"], c: 0},
  {q: "O sistema de detec√ß√£o de fogo que consiste de pontos de jun√ß√£o de metais diferentes √© chamado de:", a: ["spot", "termopar", "circuito cont√≠nuo", "interruptor t√©rmico"], c: 1},
  {q: "Tirando-se as perdas, devido o recuo da h√©lice a mesma apresenta efici√™ncia em torno de:", a: ["20% a 40%", "50% a 87%", "98%", "100%"], c: 1},
  {q: "No sistema de lubrifica√ß√£o, a v√°lvula by-pass instalada paralelamente ao filtro abrir-se-√°, no caso:", a: ["de ocorrer pane na bomba principal", "do √≥leo superaquecer", "do filtro entupir", "de faltar √≥leo na linha de press√£o"], c: 2},
  {q: "A finalidade de se aplicar o passo reverso durante o pouso √©:", a: ["reduzir a corrida na pista, durante o pouso", "proporcionar maior controle do avi√£o no solo", "reduzir o tempo gasto para o t√°xi", "economizar combust√≠vel"], c: 0},
  {q: "No √≥leo do tipo SAE 40W, a indica√ß√£o que o mesmo √© satisfat√≥rio para clima frio √©:", a: ["W", "40", "40W", "SAE"], c: 0},
  {q: "O passo que reconhece o recuo da h√©lice denomina-se:", a: ["efetivo", "te√≥rico", "constante", "geom√©trico"], c: 0},
  {q: "Na pesquisa de panes do sistema de detec√ß√£o de fogo do motor, se ocorrer umidade:", a: ["pode aumentar a resist√™ncia do circuito, prevenindo a detec√ß√£o adequada de um inc√™ndio real", "causar um curto-circuito, desligando o sistema de detec√ß√£o de fogo temporariamente", "diminui a sensibilidade do sensor, atrasando a ativa√ß√£o do alarme de fogo em caso de emerg√™ncia", "raramente causa um falso alarme de fogo"], c: 3},
  {q: "A temperatura dos gases de exaust√£o √© indicada pelo seguinte instrumento:", a: ["N1", "N2", "EGT", "Man√¥metro de temperatura"], c: 2},
  {q: "Uma h√©lice revers√≠vel √© uma h√©lice:", a: ["em que o √¢ngulo da p√° pode ser mudado para um valor negativo, durante a opera√ß√£o", "em que o √¢ngulo da p√° diminui o suficiente para evitar que o motor reduza sua rota√ß√£o", "que √© usada como freio aerodin√¢mico e que aumenta a corrida da aeronave ap√≥s o pouso", "que, na condi√ß√£o de falha do motor, muda o passo para que reduza ao m√≠nimo a resist√™ncia ao avan√ßo"], c: 0},
  {q: "Pela regulagem do fluxo de ar que passa pelo radiador, a temperatura do √≥leo pode ser controlada para adequar as diversas condi√ß√µes de opera√ß√£o. Um dos dispositivos mais utilizados para controle autom√°tico da temperatura do √≥leo √©:", a: ["termistor el√©trico", "rel√© de temperatura", "regulador de fluxo", "termostato flutuante"], c: 3},
  {q: "No sistema de detec√ß√£o de fogo do motor tipo cont√≠nuo Fenwal, qual elemento qu√≠mico da constru√ß√£o √© respons√°vel pela queda brusca da resist√™ncia el√©trica em condi√ß√£o de alarme?", a: ["A liga met√°lica de Inconel, que conduz calor e aumenta a corrente no fio sensor.", "O cromel, presente na jun√ß√£o quente que gera diferen√ßa de potencial termoel√©trico.", "O sal eut√©tico, embebido na cer√¢mica, que reduz rapidamente a resist√™ncia ao atingir temperatura cr√≠tica.", "O constantan, utilizado no n√∫cleo do fio sensor, que perde estabilidade el√©trica com o calor."], c: 2},
  {q: "Ao remover as v√°lvulas da cabe√ßa do cilindro devemos examinar a espessura das bordas das cabe√ßas das v√°lvulas utilizando:", a: ["microsc√≥pio eletr√¥nico", "l√≠quido penetrante", "rel√≥gio comparador e uma placa plana", "lente de aumento"], c: 2},
  {q: "No motor turbo√©lice a for√ßa √© controlada diretamente pela:", a: ["velocidade do motor (RPM)", "temperatura dos gases de entrada da turbina", "temperatura dos gases na entrada do compressor", "press√£o do ar na admiss√£o"], c: 1},
  {q: "No sistema de controle da h√©lice, em que faixa de opera√ß√£o do motor turbo√©lice os \"limites Beta\" s√£o ativados?", a: ["s√£o ativados abaixo da posi√ß√£o de marcha lenta de voo (flight idle) da manete de pot√™ncia, na faixa de opera√ß√£o geralmente associada √†s opera√ß√µes no solo", "s√£o ativados acima da posi√ß√£o de pot√™ncia m√°xima cont√≠nua, para garantir que a h√©lice opere dentro dos limites seguros durante o voo em alta pot√™ncia", "s√£o ativados quando a manete de pot√™ncia √© ajustada para a faixa de cruzeiro, para otimizar o desempenho da h√©lice em voos de longa dist√¢ncia e no solo", "s√£o ativados durante a fase de subida, para garantir que a h√©lice mantenha o √¢ngulo adequado enquanto o motor opera em alta rota√ß√£o"], c: 0},
  {q: "Qual par√¢metro mede a menor temperatura em que um √≥leo mant√©m fluidez suficiente para escoar ou ser derramado?", a: ["Ponto de fulgor, representando a forma√ß√£o de vapores combust√≠veis capazes de sustentar igni√ß√£o cont√≠nua.", "Ponto de fluidez, representando a temperatura m√≠nima em que o √≥leo ainda pode fluir adequadamente.", "O ponto de fluidez determina a temperatura limite superior em que o √≥leo conserva sua capacidade de lubrificar e lubrificar adequadamente.", "O ponto de fulgor determina a temperatura na qual o lubrificante libera vapores que, ao entrar em contato com fonte de igni√ß√£o, estabelecem chama cont√≠nua."], c: 1},
  {q: "O fogo na parte interna do escapamento dos motores a rea√ß√£o, durante o corte ou falsa partida, pode ser eliminado por:", a: ["agente extintor pode ser dirigido ao interior do tubo de escapamento ou bocal de entrada", "acionamento da manete de descarga do agente extintor", "corte imediato da alimenta√ß√£o do motor", "giro do motor com o motor de partida"], c: 3},
  {q: "A finalidade do passo revers√≠vel na h√©lice √©:", a: ["aumentar a corrida na decolagem", "aumentar o volume de ar para o compressor", "diminuir a corrida das avi√µes durante a aterragem", "diminuir a velocidade da massa de ar no compressor"], c: 2},
  {q: "Um √≥leo fluido lentamente est√° com a caracter√≠stica de:", a: ["alta viscosidade", "baixa viscosidade", "alta volatilidade", "baixa volatilidade"], c: 0},
  {q: "Their purpose is always to maintain proper oil temperature by varying the proportion of the total oil flow passing through the oil cooler. Consists of a valve body, having two inlet ports and one outlet port, and a spring-loaded element valve. A qual elemento se refere o texto anterior?", a: ["Thermostatic valve", "Anti by-pass valve", "Curvo Valve", "Unidirectional valve"], c: 0},
  {q: "Dentre as alternativas abaixo, aquela que identifica os m√©todos de distribui√ß√£o do √≥leo para a lubrifica√ß√£o das diversas pe√ßas m√≥veis do motor, √© a(s):", a: ["decanta√ß√£o e suc√ß√£o", "press√£o e compress√£o", "salpique e press√£o", "pulveriza√ß√£o e compress√£o"], c: 2},
  {q: "No sistema de lubrifica√ß√£o do motor, a v√°lvula de corta da parede de fogo dever√° estar na posi√ß√£o aberta sempre que:", a: ["ocorrer fogo no motor", "o motor estiver funcionando normalmente", "for necess√°rio drenar o √≥leo para manuten√ß√£o", "a tubula√ß√£o, na linha de fornecimento, se romper e o √≥leo vazar"], c: 1},
  {q: "Se durante a inspe√ß√£o da c√¢mara de combust√£o de um motor a turbina, o mec√¢nico observa que duas rachaduras est√£o progredindo a partir de uma borda livre de tal modo que seu encontro √© iminente, e pode levar uma pe√ßa de metal a se soltar. Neste contexto a c√¢mara de combust√£o deve ser:", a: ["substitu√≠da", "reparada imediatamente", "inspecionada para verificar se h√° propaga√ß√£o do dano", "reparada com solda ou furo de parada"], c: 0},
  {q: "Qual foi a principal raz√£o para o banimento internacional da produ√ß√£o de halons a partir de 1986?", a: ["Elevado risco de inc√™ndio espont√¢neo em contato com superf√≠cies met√°licas aquecidas.", "Impacto significativo na camada de oz√¥nio, resultando em restri√ß√£o global de fabrica√ß√£o.", "Classifica√ß√£o de toxicidade UL incompat√≠vel com √°reas ocupadas em aeronaves.", "Alta corrosividade em ligas leves, inviabilizando sua aplica√ß√£o em sistemas aeron√°uticos."], c: 1},
  {q: "Rachaduras na base das aletas do cilindro implicam em:", a: ["reparo de acordo com o manual do fabricante", "reparo com furo de parada", "remo√ß√£o de partes danificadas e retrabalho de suaviza√ß√£o dos contornos", "rejei√ß√£o do cilindro"], c: 3},
  {q: "Flocos de metal que se desprendem da superf√≠cie metalizada ou pintada, usualmente causado por falha da metaliza√ß√£o, galvaniza√ß√£o ou ainda por excesso de carga √© a defini√ß√£o de:", a: ["Delamina√ß√£o", "Serrilhamento", "Raspado", "Descolora√ß√£o"], c: 0},
  {q: "Instrumento que permite monitorar o consumo de combust√≠vel e verificar o desempenho do motor:", a: ["Flux√¥metro", "EGT", "Fuel pressure", "Vari√¥metro"], c: 0},
  {q: "Durante a opera√ß√£o de um motor a rea√ß√£o no solo, se ocorrer um fogo no motor durante o ciclo de partida deve-se:", a: ["mover a alavanca de corte de combust√≠vel para a posi√ß√£o IDLE imediatamente e permitir o giro do motor com o arranque at√© que o fogo seja expelido do motor", "mover a alavanca de corte de combust√≠vel para a posi√ß√£o OFF imediatamente e permitir o giro do motor com o arranque at√© que o fogo seja expelido do motor", "descarregar CO2 no duto de entrada enquanto o motor est√° sendo girado. Isso ajuda a extinguir o fogo dentro do motor", "descarregar CO2 diretamente na sa√≠da do motor"], c: 1},
  {q: "Qual caracter√≠stica comum aos sistemas de circuito cont√≠nuo (Kidde e Fenwal) aumenta sua confiabilidade em rela√ß√£o aos pares t√©rmicos?", a: ["Capacidade de rearme autom√°tico ap√≥s uma condi√ß√£o de alarme, sem necessidade de interven√ß√£o manual.", "Opera√ß√£o baseada exclusivamente em rel√©s escravos protegidos contra arco el√©trico por resistores.", "Monitoramento da taxa de aumento de temperatura, mesmo em situa√ß√µes de aquecimento lento do motor.", "A constru√ß√£o a partir de jun√ß√µes met√°licas de cromel e constante, que ampliam a faixa operacional do sensor."], c: 0},
  {q: "Em uma aeronave quadrimotor, qual √© a sequ√™ncia correta de opera√ß√£o do punho de fogo e interruptor de transfer√™ncia em caso de fogo persistente no motor n√∫mero 4?", a: ["Puxar o punho de fogo n¬∫ 4, acionar o interruptor de descarga, e depois mover o interruptor de transfer√™ncia para \"TRANS\" para liberar a segunda garrafa.", "Colocar o interruptor de transfer√™ncia em \"TRANS\", puxar o punho de fogo n¬∫ 4 e acionar o interruptor de descarga.", "Acionar diretamente o interruptor de descarga n¬∫ 4 sem necessidade de puxar o punho de fogo.", "Puxar o punho de fogo n¬∫ 4 e, sem necessidade de transfer√™ncia, ambas as garrafas descarregam automaticamente no mesmo motor."], c: 0},
  {q: "Nos motores com inje√ß√£o de combust√≠vel, a tubula√ß√£o de admiss√£o transporta:", a: ["apenas combust√≠vel pulverizado", "ar e combust√≠vel", "apenas combust√≠vel", "apenas ar"], c: 3},
  {q: "S√£o tipos de carburadores:", a: ["tipo boia ou do tipo press√£o", "tipo boia ou do tipo press√£o e o tipo venture", "tipo boia ou do tipo press√£o e indu√ß√£o", "carburador de V√°lvula Descendente e tipo diferencial"], c: 0},
  {q: "Ap√≥s uma parada brusca do motor, ocasionada pelo impacto de uma p√° da h√©lice com o solo, √© prov√°vel que ocorra desalinhamento no(a):", a: ["magneto", "filtro de √≥leo", "eixo de manivelas", "tubo de escapamento"], c: 2},
  {q: "Porque ocorre a partida falsa em motores a jato?", a: ["for√ßa insuficiente para o motor de partida", "mistura ar combust√≠vel pobre", "mistura ar combust√≠vel rica", "bateria fraca ou descarregada"], c: 0},
  {q: "O sistema de degelo da h√©lice emprega?", a: ["√ìleo quente do motor", "Ar quente da se√ß√£o de escapamento", "Resist√™ncia el√©trica", "Ar quente de um dos est√°gios do compressor"], c: 2},
  {q: "O sistema de aviso de fogo, por par t√©rmico consiste de uma caixa de rel√©s, luzes de aviso e pares t√©rmicos. Como os pares t√©rmicos est√£o ligados ao circuito e ao rel√© sens√≠vel respectivamente?", a: ["s√©rie e s√©rie com rel√© sens√≠vel", "em s√©rie e s√©rie-paralelo com rel√© sens√≠vel", "paralelo em s√©rie com rel√© sens√≠vel", "paralelo e paralelo com rel√© sens√≠vel"], c: 0},
  {q: "Dentre os tipos de √≥leo abaixo aquele que tem menor viscosidade √© o:", a: ["SAE 20", "SAE 40", "SAE 50", "SAE 60"], c: 0},
  {q: "Os casquilhos das bielas mestras junto aos eixos de manivelas s√£o lubrificados por:", a: ["press√£o", "salpique", "proje√ß√£o", "aspers√£o"], c: 0},
  {q: "De acordo com o passo da h√©lice, se for:", a: ["Pequeno, temos pequeno avan√ßo, baixa velocidade e menos pot√™ncia", "Pequeno, temos pequeno avan√ßo, baixa velocidade e maior pot√™ncia", "Grande, temos grande avan√ßo, baixa velocidade e pot√™ncia invari√°vel", "Grande, temos grande avan√ßo, grande velocidade e maior pot√™ncia"], c: 2},
  {q: "Qual √© o princ√≠pio do funcionamento do detector spot utilizado no sistema Fenwal?", a: ["Ele utiliza um termopar de cromel e constante para gerar voltagem proporcional √† diferen√ßa de temperatura.", "Ele utiliza um interruptor t√©rmico bimet√°lico que fecha o circuito ao atingir determinada temperatura.", "Ele depende de um amplificador magn√©tico que aciona a l√¢mpada de aviso ao detectar queda de resist√™ncia.", "Ele mede continuamente a resist√™ncia total do sensor para indicar aumento gradual de temperatura."], c: 1},
  {q: "Dano caracterizado pelo deslocamento de material, al√©m do contorno normal ou na superf√≠cie. Geralmente n√£o apresenta perda de metal:", a: ["Recalcamento", "Mo√ßa", "Entalhe", "Salpique"], c: 0},
  {q: "Quais falhas mec√¢nicas em motores a turbina podem levar a uma condi√ß√£o de superaquecimento ou at√© inc√™ndio durante a opera√ß√£o?", a: ["Falhas mec√¢nicas graves, como a quebra de p√° de turbina ou o desprendimento de p√°, que comprometem o fluxo de gases quentes e podem provocar superaquecimento e fogo", "Ac√∫mulo excessivo de fluido hidr√°ulico nas c√¢maras de combust√£o, que reduz a efici√™ncia t√©rmica e gera igni√ß√£o precoce", "Mau funcionamento dos defletores de √≥leo no sistema de admiss√£o, causando recircula√ß√£o de ar frio e superaquecimento local", "Desbalanceamento do eixo de baixa press√£o, que impede a compress√£o adequada do ar e resulta em combust√£o incompleta com risco de fogo"], c: 0},
  {q: "The imovable plug inside the cylinder of a reciprocating engine. It moves in and out to compress the fuel-air mixture and to transmit the force from the expanding gas in the cylinder to the crankshaft. O texto anterior se refere a:", a: ["crankshaft", "pin", "cylinder", "piston"], c: 3},
  {q: "Qual das caracter√≠sticas diferencia o sistema Fenwal spot em rela√ß√£o aos sistemas cont√≠nuos Kidde e Fenwal?", a: ["O sistema spot n√£o requer unidade de controle, pois o alarme √© disparado diretamente pelo fechamento do interruptor t√©rmico.", "O sistema spot mede a temperatura m√©dia do compartimento e fornece resposta proporcional ao aquecimento.", "O sistema spot opera com sensores de cer√¢mica embebidos em sal eut√©tico, reduzindo resist√™ncia el√©trica.", "O sistema spot √© capaz de se rearme automaticamente ap√≥s um disparo, sem interven√ß√£o da tripula√ß√£o."], c: 0},
  {q: "No sistema de aviso de fogo do tipo par t√©rmico, por que n√£o ocorre alarme durante um superaquecimento gradual da nacele do motor?", a: ["Porque o aumento simult√¢neo de temperatura aquece igualmente a jun√ß√£o quente e a jun√ß√£o de refer√™ncia.", "Porque o rel√© sens√≠vel s√≥ atua quando o circuito de teste est√° energizado durante a opera√ß√£o normal.", "Porque a resist√™ncia total do circuito excede o limite de 5 ohms estabelecido pelo fabricante.", "Porque o rel√© escravo mant√©m a bobina desenergizada at√© o disparo manual pelo piloto no cockpit."], c: 0},
  {q: "O n√∫cleo do radiador de √≥leo √© constru√≠do com tubos de cobre ou alum√≠nio, num formato que aparenta um (a):", a: ["tela", "disco", "colmeia", "pinheiro"], c: 2},
  {q: "Quando ambas as v√°lvulas de admiss√£o e escape est√£o fechadas?", a: ["no in√≠cio do movimento de pot√™ncia", "no in√≠cio do movimento de exaust√£o", "no ponto morto alto", "no ponto morto baixo"], c: 0},
  {q: "A for√ßa f√≠sica que tende a expulsar as p√°s do cubo quando a h√©lice est√° em movimento denomina-se:", a: ["recuo", "tra√ß√£o", "centr√≠fuga", "aerodin√¢mica"], c: 2},
  {q: "S√£o raz√µes mais comuns para remo√ß√£o e substitui√ß√£o de um motor alternativo:", a: ["Parada brusca, extens√£o excedida da vida do motor, s√∫bita redu√ß√£o na velocidade de rota√ß√£o e presen√ßa de part√≠culas met√°licas no √≥leo", "Vibra√ß√µes anormais, aumento da press√£o de √≥leo, superaquecimento frequente e desgaste excessivo dos rolamentos", "Dificuldade em dar partida, baixa press√£o de √≥leo, s√∫bita redu√ß√£o na velocidade de rota√ß√£o e presen√ßa de part√≠culas met√°licas no √≥leo", "Ru√≠do excessivo durante a opera√ß√£o, aumento constante no consumo de combust√≠vel, falhas frequentes de igni√ß√£o e presen√ßa de fuma√ßa preta no escape"], c: 0},
  {q: "No sistema de lubrifica√ß√£o por press√£o em motores a explos√£o, qual √© a fun√ß√£o da linha de suc√ß√£o conectada ao tanque em ponto mais alto que o coletor de √≥leo?", a: ["Facilitar a drenagem de √≥leo excedente durante a partida do motor em tempo frio.", "Evitar que sedimentos depositados no coletor sejam aspirados pela bomba.", "Permitir que o √≥leo seja recirculado para resfriamento antes de entrar na bomba.", "Reduzir a press√£o de suc√ß√£o na bomba, estabilizando o fluxo em baixas rota√ß√µes."], c: 1},
  {q: "Com o al√≠vio da press√£o do √≥leo, atrav√©s do governador, os contrapesos e a mola levam as p√°s da h√©lice para o passo:", a: ["m√°ximo", "m√≠nimo", "reverso", "bandeira"], c: 3},
  {q: "Quando um motor √© guardado numa embalagem para transporte ou num container, alguns agentes desidratantes devem ser usados a finalidade destes agentes √©:", a: ["eliminar poeira para preservar o motor", "remover a umidade do ar no ambiente do motor", "conservar a entrada de ar do motor livre de impurezas", "manter o interior do container com temperatura abaixo de zero grau"], c: 1},
  {q: "Qual √© o papel da unidade de controle nos sistemas de detec√ß√£o cont√≠nua aplicados aos motores das aeronaves?", a: ["No Kidde, medir constantemente a resist√™ncia total do sensor; no Fenwal, acionar o alarme por meio de amplificador magn√©tico.", "No Kidde, amplificar o sinal t√©rmico recebido; no Fenwal, calcular a m√©dia de temperatura de todo o compartimento.", "No Kidde, detectar apenas a taxa de aumento de temperatura; no Fenwal, comparar resist√™ncia de m√∫ltiplos sensores em s√©rie.", "No Kidde, atuar exclusivamente em zonas espec√≠ficas de chama; no Fenwal, energizar os detectores por corrente alternada."], c: 0},
  {q: "Ap√≥s drenar o composto anticorrosivo de dentro do motor, √© necess√°rio verificar se h√° ac√∫mulo desse composto em que partes?", a: ["interna dos cilindros mais baixos e nos respectivos dutos de admiss√£o e utilizar uma bomba manual para remover o composto remanescente", "interna dos cilindros superiores e nos respectivos dutos de admiss√£o", "externa dos cilindros mais baixos e nos respectivos dutos de admiss√£o", "interna dos cilindros mais baixos e nos respectivos dutos de admiss√£o e utilizar um aspirador pneum√°tico para remover o composto remanescente"], c: 0},
  {q: "Qual a principal diferen√ßa de um motor a rea√ß√£o e convencional?", a: ["O motor convencional √© um tipo de motor que utiliza a acelera√ß√£o do ar para gerar propuls√£o enquanto nos motores convencionais ou a pist√£o as fases ocorrem intermitentemente.", "O motor a rea√ß√£o ou a jato √© um tipo de motor que utiliza a acelera√ß√£o do ar para gerar propuls√£o enquanto nos motores convencionais ou a pist√£o as fases ocorrem intermitentemente.", "Em um motor convencional, as fases ocorrem de maneira cont√≠nua no interior de um cilindro, enquanto nos motores a rea√ß√£o as fases ocorrem intermitentemente.", "Em um motor convencional, as fases ocorrem intermitentemente no interior de um cilindro, enquanto nos motores a rea√ß√£o as fases ocorrem de maneira cont√≠nua."], c: 3},
  {q: "Quando o sistema de torque negativo NTS entra em a√ß√£o, o que faz para compensar o torque negativo da h√©lice?", a: ["Diminui o √¢ngulo da p√° da h√©lice", "Aumenta o √¢ngulo da p√° da h√©lice", "Diminui a rota√ß√£o do motor", "Aumenta a rota√ß√£o do motor"], c: 1},
  {q: "O tipo de agente que extingue a chama pela dissipa√ß√£o imediata do oxig√™nio da √°rea √© o:", a: ["clorobromometano", "brometo de metila", "di√≥xido de carbono", "tetracloreto de carbono"], c: 2},
  {q: "A instala√ß√£o do tubo do bocal de abastecimento, no tanque de √≥leo, √© posicionado de forma a prover o(a):", a: ["suspiro do tanque", "ventila√ß√£o do tanque", "espa√ßo suficiente √† expans√£o do √≥leo", "pressuriza√ß√£o do sistema de lubrifica√ß√£o"], c: 2},
  {q: "No motor convencional, a centelha ocorre quando o pist√£o passa atrav√©s do ponto morto:", a: ["alto, no tempo de compress√£o", "alto, no tempo de escapamento", "baixo, no tempo motor", "baixo, no tempo de admiss√£o"], c: 0},
  {q: "No sistema de refrigera√ß√£o do motor, a finalidade do termostato flutuante do controle de fluxo de ar atrav√©s do radiador √©:", a: ["manter automaticamente a temperatura normal do √≥leo", "assegurar a quantidade m√°xima de √≥leo, necess√°ria ao funcionamento do sistema", "controlar automaticamente a press√£o do √≥leo", "assegurar a quantidade m√≠nima de √≥leo, necess√°ria ao funcionamento do motor"], c: 0},
  {q: "Qual procedimento pode eliminar um fogo interno no escapamento de um motor a turbina durante uma falsa partida?", a: ["Desligar imediatamente o motor e aplicar CO2 diretamente na se√ß√£o de turbina.", "Acionar o motor de partida para girar o motor e expelir o combust√≠vel em combust√£o.", "Romper manualmente os discos indicadores das garrafas de CO2 para descarga imediata.", "Reduzir o fluxo de combust√≠vel at√© a chama apagar-se por falta de oxig√™nio."], c: 1},
  {q: "Nos motores radiais, a parte interna dos cilindros mais baixos, e respectivos dutos de admiss√£o, devem ser cuidadosamente verificados quanto √† presen√ßa excessiva de composto anticorrosivo, que foi drenado de dentro do motor, mas tende a acumular-se nas partes mais baixas. Se por alguma raz√£o, o excesso de composto anticorrosivo for encontrado acumulado nos cilindros superiores, a pr√°tica padr√£o ser√°:", a: ["Injetar ar comprimido nos cilindros superiores para for√ßar a remo√ß√£o do composto anticorrosivo acumulado", "Substituir o composto anticorrosivo por fluido de lavagem e girar manualmente o motor para eliminar o excesso", "Remover o excesso de composto anticorrosivo por bomba el√©trica", "Remover o excesso de composto anticorrosivo por bomba manual"], c: 3},
  {q: "A inspe√ß√£o das partes do motor durante uma revis√£o completa √© dividida em tr√™s categorias, quais s√£o?", a: ["Visual, magn√©tica, dimensional", "Abstrata, magn√©tica, dimensional", "Superficial, magn√©tica, dimensional", "Visual, magn√©tica, diagonal"], c: 0},
  {q: "Por que, em aeronaves multimotores, cada motor utiliza um sistema de lubrifica√ß√£o independente no arranjo de c√°rter seco?", a: ["Para possibilitar que motores diferentes operem com graus distintos de viscosidade de √≥leo em condi√ß√µes extremas.", "Para assegurar redund√¢ncia operacional, evitando que a falha de um sistema comprometa todos os motores.", "Para reduzir a forma√ß√£o de espuma do √≥leo, que seria maior em sistemas interligados entre motores.", "Para diminuir a necessidade de resfriamento, j√° que cada radiador trabalha apenas para um motor espec√≠fico."], c: 1},
  {q: "O limite n√£o governado, ou de taxi, que compreende da posi√ß√£o do 'reverso' at√© a 'marcha lenta de voo', √© denominado de:", a: ["Passo bandeira", "Controle da Lenta", "Limite beta", "Posi√ß√£o IDLE"], c: 2},
  {q: "Na parte externa dos cilindros dos motores resfriados a ar encontram-se as:", a: ["Bielas", "Camisas dos cilindros", "Alhetas de resfriamento", "Saias dos cilindros"], c: 2},
  {q: "Qual caracter√≠stica distingue o princ√≠pio de opera√ß√£o entre o sistema cont√≠nuo Kidde e o sistema Fenwal?", a: ["O sistema Kidde monitora pontos espec√≠ficos; o Fenwal cobre toda a √°rea sensoreada de forma proporcional.", "O sistema Kidde depende da fus√£o do sal eut√©tico; o Fenwal opera pela varia√ß√£o gradual da resist√™ncia do cer√¢mica.", "O sistema Kidde utiliza um amplificador magn√©tico para controle; o Fenwal mede a resist√™ncia total do sensor continuamente.", "O sistema Kidde responde proporcionalmente √† temperatura m√©dia e a pontos isolados; o Fenwal dispara alarme imediato em qualquer ponto cr√≠tico."], c: 3},
  {q: "Durante uma revis√£o completa de motor aeron√°utico, qual a sequ√™ncia correta dos tr√™s m√©todos de inspe√ß√£o das partes do motor que devem ser aplicadas para garantir a detec√ß√£o abrangente de falhas estruturais e dimensionais?", a: ["Inspe√ß√£o magn√©tica, inspe√ß√£o dimensional e inspe√ß√£o visual para finalizar a an√°lise das pe√ßas com precis√£o adequada.", "Inspe√ß√£o visual precedendo qualquer outro m√©todo, seguida de inspe√ß√£o magn√©tica e inspe√ß√£o dimensional para completar a avalia√ß√£o.", "Inspe√ß√£o dimensional inicial, inspe√ß√£o visual intermedi√°ria e inspe√ß√£o magn√©tica final para determinar todas as falhas presentes.", "Inspe√ß√£o magn√©tica precedendo os outros m√©todos, inspe√ß√£o visual secund√°ria e inspe√ß√£o dimensional para fechar o processo."], c: 1},
  {q: "Quando s√∫bita redu√ß√£o de velocidade de rota√ß√£o de um motor alternativo ocorrer o que deve ser feito?", a: ["Fazer um teste com motor em voo", "Inspecionar interna e externamente", "Remover o motor e inspecionar", "Verificar se o eixo de manivelas sofreu empenamento"], c: 3},
  {q: "Perda de metal, usualmente por uma apreci√°vel profundidade ao longo de uma √°rea, por meios mec√¢nicos pelo uso de l√¢minas de serra, cinzel, tesouras, guilhotina ou at√© por cantos vivos, agudos, etc.:", a: ["Corte", "Eros√£o", "Arranhado", "Raspado"], c: 0},
  {q: "Os sistemas de igni√ß√£o de motores a turbinas s√£o, via de regra, s√£o menos pass√≠veis de problemas em rela√ß√£o aos sistemas de igni√ß√£o em motores convencionais por:", a: ["serem operados por um curto per√≠odo durante o ciclo de partida do motor", "ter menor exposi√ß√£o a condi√ß√µes Adversas como temperatura e press√£o", "ter uma combust√£o mais est√°vel e cont√≠nua", "possuir um sistema duplo de sincroniza√ß√£o independente"], c: 0},
  {q: "A bomba de suc√ß√£o do alojamento da caixa de acess√≥rios √© acionada por uma?", a: ["Alavanca de atuadores", "Turbina pneum√°tica", "Engrenagem", "Caixa el√©trica"], c: 2},
  {q: "Num √≥leo do tipo SAE 20W a especifica√ß√£o de uso em clima frio √© determinado pelo:", a: ["E", "W", "20", "SAE"], c: 1},
  {q: "O alarme sonoro e a luz de aviso de fogo ser√£o energizados imediatamente quando:", a: ["for acionado o punho de fogo", "for acionado o interruptor da v√°lvula de corte do motor", "a resist√™ncia do sensor for acima de um valor determinado", "a resist√™ncia do sensor for inferior a um valor determinado"], c: 3},
  {q: "A desestocagem adequada de motores radiais inclui uma verifica√ß√£o cuidadosa e:", a: ["drenagem do composto anticorrosivo dos cilindros mais baixos para evitar o cal√ßo hidr√°ulico", "drenagem do composto anticorrosivo dos cilindros mais altos para evitar cal√ßo vapor", "instalar os indicadores de umidade dos orif√≠cios das velas de cada cilindro, especialmente focando nos cilindros inferiores onde o composto tende a se acumular", "remover os indicadores de umidade dos orif√≠cios das velas de cada cilindro, especialmente focando nos cilindros superiores onde o composto tende a se acumular"], c: 0},
  {q: "Os v√°rios sistemas de alarme operam luzes de aviso no painel de fogo na cabine, energizando tamb√©m um alarme?", a: ["Sonoro na cabine de passageiros", "Sonoro na cabine", "Sonoro localizado no extintor dos comiss√°rios", "Sonoro na torre de comando"], c: 1},
  {q: "A classifica√ß√£o SAE (Society of Automotive Engineers) dos √≥leos lubrificantes divide-os em grupos num√©ricos (SAE 10 a 70). O que essa numera√ß√£o representa?", a: ["A qualidade global do √≥leo, incluindo aditivos detergentes, dispersantes e anticorrosivos aplicados na formula√ß√£o.", "A viscosidade relativa do √≥leo medida a 130 ¬∫F ou 210 ¬∫F, sem rela√ß√£o direta com o √≠ndice Saybolt.", "O peso espec√≠fico do √≥leo comparado com a √°gua destilada em uma faixa de temperatura controlada.", "A estabilidade t√©rmica e a resist√™ncia do √≥leo em altas rota√ß√µes, sob condi√ß√µes de combust√£o interna."], c: 1},
  {q: "A v√°lvula de corte do sistema de lubrifica√ß√£o, instalada na parede de fogo da nacele possui como fun√ß√£o prim√°ria:", a: ["Eliminar excesso de press√£o no sistema, prevenindo vazamentos na tubula√ß√£o de √≥leo.", "Interromper o suprimento de √≥leo em caso de inc√™ndio, ruptura de linha ou manuten√ß√£o.", "Atuar como v√°lvula de al√≠vio para liberar o excesso de √≥leo em caso de aumento anormal da viscosidade.", "Redirecionar o fluxo de √≥leo para o tubo interno do tanque durante regimes de baixa pot√™ncia."], c: 1},
  {q: "No circuito de detec√ß√£o por pares t√©rmicos, qual condi√ß√£o provoca o fechamento do rel√© sens√≠vel?", a: ["A atua√ß√£o simult√¢nea do rel√© escravo, que alimenta a bobina de indu√ß√£o principal do sistema.", "O disparo autom√°tico do rel√© teste t√©rmico, projetado para simular um aumento de temperatura.", "O aquecimento gradual do motor em opera√ß√£o normal, aumentando a corrente de forma cont√≠nua no circuito.", "A corrente gerada ultrapassar quatro miliamp√©res, devido ao r√°pido aquecimento da jun√ß√£o quente."], c: 3},
  {q: "A finalidade do passo reverso √© a de produzir uma tra√ß√£o:", a: ["Negativa", "Estol", "Neutra", "Positiva"], c: 0},
  {q: "Nos sistemas de detec√ß√£o de fogo de motor a rea√ß√£o, qual crit√©rio deve ser observado na fixa√ß√£o dos sensores cont√≠nuos para evitar falhas por vibra√ß√£o?", a: ["Dist√¢ncia entre bra√ßadeiras de fixa√ß√£o deve ser de 8 a 10 polegadas em trechos retos.", "Fixa√ß√£o r√≠gida a cada 2 polegadas, impedindo qualquer movimento.", "Bra√ßadeiras espa√ßadas a cada 15 polegadas, garantindo flexibilidade t√©rmica.", "Primeira bra√ßadeira deve estar sempre a 10 polegadas de cada conex√£o de jun√ß√£o."], c: 0},
  {q: "Na desestocagem de motores radiais, √© fundamental realizar uma verifica√ß√£o minuciosa na parte interna dos cilindros mais baixos e nos respectivos dutos de admiss√£o. Isso se deve ao fato de que, ap√≥s o motor ser armazenado, isso se deve por que:", a: ["pode haver a presen√ßa excessiva de composto anticorrosivo que foi drenado do motor, mas que tende a se acumular nas partes mais baixas do pist√£o", "pode haver a presen√ßa excessiva de √≥leo residual que foi drenado do motor, mas que tende a se acumular nas partes mais altas dos pist√µes", "pode haver a presen√ßa excessiva de √≥leo residual que foi drenado do motor, mas que tende a se acumular nas partes mais baixas dos cilindros", "pode haver a presen√ßa excessiva de composto anticorrosivo que foi drenado do motor, mas que tende a se acumular nas partes mais baixas dos cilindros"], c: 3},
  {q: "No instrumento, o limite perigoso de opera√ß√£o √© indicado pela faixa de cor?", a: ["Vermelha", "Verde", "Azul", "Amarela"], c: 0},
  {q: "Durante o giro do motor convencional de um avi√£o no solo se a p√° da h√©lice tocar num obst√°culo ocasionando parada brusca, deve-se:", a: ["substituir o motor", "trocar todo o √≥leo do motor", "remover o governador de h√©lice", "executar nova regulagem do governador de h√©lice"], c: 0},
  {q: "Sobre os tipos de sistemas de lubrifica√ß√£o dos motores aeron√°uticos podemos afirmar que:", a: ["c√°rter molhado ou c√°rter seco", "c√°rter molhado somente", "c√°rter seco somente", "√∫mido"], c: 0},
  {q: "Na limpeza das pe√ßas da se√ß√£o quente do motor, podem ser utilizados agentes do tipo:", a: ["√°lcool ou querosene", "emuls√£o ou querosene", "√°lcool et√≠lico ou gasolina", "emuls√£o ou solvente clorado"], c: 3},
  {q: "Se uma h√©lice gira a 2.400 RPM e as engrenagens de redu√ß√£o trabalham em uma raz√£o de 12:1, a rota√ß√£o com que o eixo de manivelas gira √© de:", a: ["200 RPM", "2400 RPM", "4800 RPM", "28800 RPM"], c: 3},
  {q: "Uma parada de motor em decorr√™ncia de colis√£o de uma ou mais p√°s de h√©lice com um objeto, de modo que o motor pare antes que a h√©lice complete uma volta, denomina-se:", a: ["retorno de chama", "cal√ßo hidr√°ulico", "parada brusca", "corte de motor"], c: 2},
  {q: "O sistema de controle do torque negativo (NTS) proporciona um sinal que:", a: ["aumenta a rota√ß√£o do motor para compensar o torque negativo gerado pelo eixo, estabilizando o desempenho da h√©lice", "diminui a rota√ß√£o do motor para compensar o torque negativo gerado pelo eixo, estabilizando o desempenho da h√©lice", "aumenta o √¢ngulo da p√° da h√©lice para limitar o torque negativo do eixo", "diminui o √¢ngulo da p√° da h√©lice para limitar o torque negativo do eixo"], c: 2},
  {q: "A finalidade da bomba de suc√ß√£o no sistema de lubrifica√ß√£o do motor √©:", a: ["retornar o √≥leo ao tanque", "conduzir o √≥leo para o radiador", "circular o √≥leo atrav√©s do motor", "suprir √≥leo para a bomba principal"], c: 0},
  {q: "A h√©lice que ajusta o passo, sem atua√ß√£o do operador, para manter constante a RPM do motor, denomina-se:", a: ["ajust√°vel", "autom√°tica", "de passo constante", "de passo control√°vel"], c: 1},
  {q: "A pot√™ncia de um motor diminui √† medida que a aeronave se eleva na atmosfera porque:", a: ["h√° um acr√©scimo cont√≠nuo da temperatura do ar com a altitude", "h√° um acr√©scimo cont√≠nuo da densidade do ar com a altitude", "h√° um decr√©scimo cont√≠nuo da densidade do ar com a altitude", "h√° um decr√©scimo cont√≠nuo da temperatura do ar com a altitude"], c: 2},
  {q: "Por que os sistemas de c√°rter cheio n√£o s√£o adequados para voo invertido (voo de dorso)?", a: ["Porque a press√£o de √≥leo cai a zero, levando ao travamento imediato dos mancais principais.", "Porque todo o suprimento de √≥leo migra para os cilindros superiores, provocando combust√£o irregular.", "Porque o √≥leo se desloca no coletor e inunda o motor, interrompendo a lubrifica√ß√£o normal.", "Porque a v√°lvula de corte da parede de fogo √© for√ßada a fechar por press√£o diferencial."], c: 2},
  {q: "No sistema cont√≠nuo Kidde, como a altera√ß√£o da temperatura provoca o disparo do alarme?", a: ["Pela fus√£o do sal eut√©tico, que reduz bruscamente a resist√™ncia el√©trica da camada cer√¢mica isolante.", "Pela redu√ß√£o gradual da resist√™ncia el√©trica da cer√¢mica envolvente, permitindo fluxo de corrente entre condutor e massa.", "Atrav√©s do aumento progressivo da resist√™ncia el√©trica do material cer√¢mico circundante, dificultando a possibilitando a passagem de corrente entre o condutor e a terra.", "Pelo aumento da capacit√¢ncia entre os fios enrolados em Inconel, que gera diferen√ßa de potencial instant√¢nea."], c: 1},
  {q: "Quanto ao uso do transferidor universal da h√©lice, ele pode ser usado para checar os √¢ngulos da p√° quando a h√©lice estiver:", a: ["em posi√ß√£o vertical somente", "instalada no motor somente", "na bancada somente", "na bancada de balanceamento ou instalada no motor de uma aeronave"], c: 3}
];
    // ============================================
    // CONFIGURA√á√ïES DO SISTEMA
    // ============================================
    const QUESTIONS_PER_SIMULADO_PADRAO = 20;
    const MIN_WRONG_QUESTIONS_FOR_SIMULADO = 1;
    const MIN_PERCENT_FOR_SUCCESS = 70;
    
    // ============================================
    // VARI√ÅVEIS GLOBAIS
    // ============================================
    let QUESTIONS_PER_SIMULADO = QUESTIONS_PER_SIMULADO_PADRAO;
    let API_URL = "https://script.google.com/macros/s/AKfycbwcX8bNdrDQZ6sRB1sbG0COJe7aGYyBlOCPkno2JxbM-59_-FsWt4LCccUQ8DBLTy1S5g/exec";
    let EMAIL_DESTINO = "ewerton.andriel@hotmail.com";
    
    let TIME_LIMIT = 0;
    let currentQuestions = [];
    let userAnswers = [];
    let timeLeft = 0;
    let timerId;
    let currentQuestionIndex = 0;
    let autoNavEnabled = true;
    let usedQuestionsHistory = [];
    let currentSimuladoIndices = [];
    let totalSimulados = 1;
    let currentSimuladoNumber = 1;
    
    // VARI√ÅVEIS DO SISTEMA DE REPORTE
    let currentReportQuestionIndex = null;
    let reportsHistory = [];

    // TIPOS DE REPORTE
    const REPORT_TYPES = {
        error: "‚ùå Quest√£o com erro",
        wrong_answer: "‚ö†Ô∏è Resposta incorreta", 
        confusing: "ü§î Enunciado confuso",
        alternative: "üî§ Alternativas erradas",
        other: "üìù Outro problema"
    };
    
    // ============================================
    // VARI√ÅVEIS PARA SISTEMA DE REFOR√áO
    // ============================================
    let wrongQuestionsHistory = [];
    const WRONG_QUESTIONS_KEY = 'wrong_questions_history';
    const LAST_OFFER_KEY = 'last_reforco_offer';
    
    // ============================================
    // CHAVE PARA SESS√ÉO ATUAL
    // ============================================
    const SESSION_ID_KEY = 'current_session_id';
    const CURRENT_QUESTIONS_KEY = 'current_session_questions';
    const CURRENT_QUESTION_INDEX_KEY = 'current_question_index';
    const USER_ANSWERS_KEY = 'user_answers';
    const TIME_LEFT_KEY = 'time_left';
    const AUTO_NAV_KEY = 'auto_nav';
    const SIMULADO_STARTED_KEY = 'simulado_started';
    const CURRENT_SIMULADO_NUMBER_KEY = 'current_simulado_number';
    
    // ============================================
    // NOVA FUN√á√ÉO: EMBARALHAR ALTERNATIVAS
    // ============================================
    
    function shuffleAlternatives(question) {
        // Cria uma c√≥pia da quest√£o
        const shuffledQuestion = { ...question };
        
        // Cria um array de √≠ndices [0, 1, 2, 3...]
        const indices = Array.from({ length: question.a.length }, (_, i) => i);
        
        // Embaralha os √≠ndices
        const shuffledIndices = shuffleArray(indices);
        
        // Cria novas alternativas com a ordem embaralhada
        const shuffledAlternatives = shuffledIndices.map(index => question.a[index]);
        
        // Encontra o novo √≠ndice da resposta correta
        const newCorrectIndex = shuffledIndices.indexOf(question.c);
        
        // Atualiza a quest√£o com as alternativas embaralhadas e o novo √≠ndice correto
        shuffledQuestion.a = shuffledAlternatives;
        shuffledQuestion.c = newCorrectIndex;
        shuffledQuestion.shuffledIndices = shuffledIndices; // Guarda o mapeamento para o gabarito
        shuffledQuestion.originalCorrectIndex = question.c; // Guarda o √≠ndice original para refer√™ncia
        
        return shuffledQuestion;
    }
    
    // ============================================
    // FUN√á√ÉO SELECTRANDOMQUESTIONS ATUALIZADA
    // ============================================

    function selectRandomQuestions(forceFirstSimulado = false) {
        const totalQuestions = masterBank.length;
        
        if (totalQuestions === 0) {
            alert("‚ö†Ô∏è O banco de quest√µes est√° vazio! Adicione quest√µes no c√≥digo.");
            return [];
        }
        
        const config = calcularConfiguracaoSimulados();
        console.log(config.mensagem);
        
        let availableQuestions = [];
        for (let i = 0; i < totalQuestions; i++) {
            availableQuestions.push(i);
        }
        
        // Remove as j√° usadas
        if (usedQuestionsHistory.length > 0 && !forceFirstSimulado) {
            availableQuestions = availableQuestions.filter(index => 
                !usedQuestionsHistory.includes(index)
            );
        }
        
        const availableCount = availableQuestions.length;
        let questionsToSelect;
        
        if (availableCount === 0) {
            if (confirm(`Todas as ${totalQuestions} quest√µes j√° foram usadas!\n\nDeseja reiniciar o hist√≥rico?`)) {
                usedQuestionsHistory = [];
                localStorage.setItem(HISTORY_KEY, JSON.stringify(usedQuestionsHistory));
                availableQuestions = Array.from({length: totalQuestions}, (_, i) => i);
                questionsToSelect = Math.min(QUESTIONS_PER_SIMULADO, totalQuestions);
                alert('Hist√≥rico reiniciado!');
                forceFirstSimulado = true;
            } else {
                availableQuestions = Array.from({length: totalQuestions}, (_, i) => i);
                questionsToSelect = Math.min(QUESTIONS_PER_SIMULADO, totalQuestions);
            }
        } else if (availableCount >= QUESTIONS_PER_SIMULADO) {
            questionsToSelect = QUESTIONS_PER_SIMULADO;
        } else if (availableCount >= 5) {
            questionsToSelect = availableCount;
        } else {
            if (confirm(`S√≥ restam ${availableCount} quest√µes!\n\nDeseja fazer simulado com essas quest√µes?`)) {
                questionsToSelect = availableCount;
            } else {
                if (confirm(`Deseja reiniciar o hist√≥rico?`)) {
                    usedQuestionsHistory = [];
                    localStorage.setItem(HISTORY_KEY, JSON.stringify(usedQuestionsHistory));
                    availableQuestions = Array.from({length: totalQuestions}, (_, i) => i);
                    questionsToSelect = Math.min(QUESTIONS_PER_SIMULADO, totalQuestions);
                    forceFirstSimulado = true;
                } else {
                    questionsToSelect = availableCount;
                }
            }
        }
        
        if (totalQuestions <= 27) {
            questionsToSelect = totalQuestions;
            availableQuestions = Array.from({length: totalQuestions}, (_, i) => i);
        }
        
        const shuffledQuestions = shuffleArray(availableQuestions);
        const selectedIndices = shuffledQuestions.slice(0, questionsToSelect);
        
        currentSimuladoIndices = selectedIndices;
        
        if (forceFirstSimulado || usedQuestionsHistory.length === 0) {
            currentSimuladoNumber = 1;
        } else if (selectedIndices.length > 0) {
            const usedCount = usedQuestionsHistory.length;
            const simuladoIndex = Math.floor(usedCount / QUESTIONS_PER_SIMULADO);
            currentSimuladoNumber = Math.min(simuladoIndex + 1, totalSimulados);
        } else {
            currentSimuladoNumber = 1;
        }
        
        if (currentSimuladoNumber > totalSimulados) {
            currentSimuladoNumber = totalSimulados;
        }
        
        console.log(`Simulado configurado: ${currentSimuladoNumber}/${totalSimulados}`);
        
        // ALTERA√á√ÉO: Embaralha as alternativas de cada quest√£o selecionada
        const selectedQuestions = selectedIndices.map(index => {
            const originalQuestion = masterBank[index];
            return shuffleAlternatives({
                ...originalQuestion, 
                originalIndex: index
            });
        });
        
        return selectedQuestions;
    }

    // ============================================
    // FUN√á√ÉO: GENERATE WRONG QUESTIONS SIMULADO ATUALIZADA
    // ============================================
    
    function generateWrongQuestionsSimulado() {
        console.log(`Gerando simulado de refor√ßo com ${wrongQuestionsHistory.length} quest√µes erradas...`);
        
        if (wrongQuestionsHistory.length === 0) {
            console.error('Nenhuma quest√£o errada no hist√≥rico');
            return [];
        }
        
        let availableWrongQuestions = [...wrongQuestionsHistory];
        availableWrongQuestions = shuffleArray(availableWrongQuestions);
        
        const selectedIndices = availableWrongQuestions;
        
        console.log(`Selecionadas ${selectedIndices.length} quest√µes para o simulado de refor√ßo`);
        
        // ALTERA√á√ÉO: Embaralha as alternativas de cada quest√£o de refor√ßo
        const questions = selectedIndices.map(index => {
            if (index >= 0 && index < masterBank.length) {
                const originalQuestion = masterBank[index];
                return shuffleAlternatives({
                    ...originalQuestion,
                    originalIndex: index,
                    isWrongQuestion: true
                });
            }
            return null;
        }).filter(q => q !== null);
        
        return questions;
    }
    
    // ============================================
    // FUN√á√ÉO RENDERCURRENTQUESTION ATUALIZADA
    // ============================================
    
    function renderCurrentQuestion() {
        const container = document.getElementById('quiz-content');
        
        if (!currentQuestions || currentQuestions.length === 0) {
            container.innerHTML = '<div class="question-block-mini">Erro: Nenhuma quest√£o carregada.</div>';
            return;
        }
        
        const question = currentQuestions[currentQuestionIndex];
        
        container.innerHTML = `
            <div class="question-block-mini">
                <div class="question-text-mini">
                    ${currentQuestionIndex + 1}. ${question.q}
                </div>
                <div class="options-mini">
                    ${question.a.map((opt, i) => `
                        <label class="option-mini" id="option-${i}">
                            <input type="radio" name="currentQuestion" value="${i}" 
                                   ${userAnswers[currentQuestionIndex] === i ? 'checked' : ''}
                                   onchange="selectAnswer(${i})">
                            ${opt}
                        </label>
                    `).join('')}
                </div>
                <button class="report-btn" onclick="openReportModal(${currentQuestionIndex})">
                    <span>‚ö†Ô∏è</span> Reportar Problema
                </button>
            </div>
        `;
    }
    
    // ============================================
    // FUN√á√ÉO FINALIZEQUIZ ATUALIZADA
    // ============================================
    
    function finalizeQuiz() {
        clearInterval(timerId);
        
        const answeredCount = getAnsweredCount();
        if (answeredCount !== currentQuestions.length && !confirm(`Respondidas: ${answeredCount}/${currentQuestions.length}. Finalizar?`)) {
            startTimer();
            return;
        }
        
        let finalScore = 0;
        userAnswers.forEach((answer, index) => {
            if (answer !== null && answer === currentQuestions[index].c) {
                finalScore++;
            }
        });
        
        const percent = currentQuestions.length > 0 ? Math.round((finalScore / currentQuestions.length) * 100) : 0;
        const feedback = document.getElementById('feedback-msg');
        
        if (percent >= 70) {
            feedback.textContent = "üéâ Excelente!";
            feedback.style.color = "var(--success)";
        } else if (percent >= 50) {
            feedback.textContent = "üëç Quase l√°!";
            feedback.style.color = "var(--accent)";
        } else {
            feedback.textContent = "üí™ Continue!";
            feedback.style.color = "var(--danger)";
        }
        
        if (currentQuestions[0]?.isWrongQuestion) {
            removeCorrectQuestionsFromHistory();
        } else {
            addWrongQuestionsToHistory();
        }
        
        if (currentSimuladoIndices.length > 0 && !currentQuestions[0]?.isWrongQuestion) {
            usedQuestionsHistory.push(...currentSimuladoIndices);
            usedQuestionsHistory = [...new Set(usedQuestionsHistory)];
            localStorage.setItem(HISTORY_KEY, JSON.stringify(usedQuestionsHistory));
        }
        
        clearSessionData();
        
        let quizHTML = '';
        currentQuestions.forEach((question, index) => {
            const userAnswer = userAnswers[index];
            const isCorrect = userAnswer === question.c;
            
            // Para o gabarito, usamos as alternativas como foram mostradas
            quizHTML += `
                <div class="question-block-mini">
                    <button class="report-gabarito-btn" onclick="openReportModal(${index})" title="Reportar problema">
                        ‚ö†Ô∏è
                    </button>
                    
                    <div class="question-text-mini">
                        ${index + 1}. ${question.q}
                    </div>
                    <div class="options-mini">
                        ${question.a.map((opt, i) => {
                            let classes = 'option-mini';
                            if (i === question.c) classes += ' correct-answer';
                            else if (userAnswer === i && !isCorrect) classes += ' wrong-answer';
                            
                            return `<label class="${classes}">
                                <input type="radio" disabled ${userAnswer === i ? 'checked' : ''}>
                                ${opt}
                                ${userAnswer === i ? '<span style="margin-left: auto; font-size: 0.6rem; color: #6c757d;">(sua resposta)</span>' : ''}
                                ${i === question.c && userAnswer !== i ? '<span style="margin-left: auto; font-size: 0.6rem; color: var(--success);">(correta)</span>' : ''}
                            </label>`;
                        }).join('')}
                    </div>
                </div>
            `;
        });
        
        document.getElementById('quiz-content').innerHTML = quizHTML;
        document.getElementById('final-score').textContent = `${finalScore}/${currentQuestions.length}`;
        document.getElementById('final-percent').textContent = `${percent}%`;
        
        const motivationElement = document.getElementById('motivation-message');
        let motivationHTML = '';
        
        if (currentQuestions[0]?.isWrongQuestion) {
            if (percent >= MIN_PERCENT_FOR_SUCCESS) {
                motivationHTML = `‚úÖ <strong>PARAB√âNS!</strong> Voc√™ superou suas dificuldades!`;
                motivationElement.className = 'motivation-message motivation-success';
            } else {
                motivationHTML = `‚ö° <strong>PRECISA MELHORAR</strong><br>`;
                motivationHTML += `Voc√™ acertou ${finalScore} de ${currentQuestions.length}.<br>`;
                motivationHTML += `Faltam ${MIN_PERCENT_FOR_SUCCESS - percent}% para a meta de ${MIN_PERCENT_FOR_SUCCESS}%.`;
                motivationElement.className = 'motivation-message motivation-warning';
            }
        } else {
            if (percent >= MIN_PERCENT_FOR_SUCCESS) {
                motivationHTML = `üéØ <strong>√ìTIMO DESEMPENHO!</strong>`;
                motivationElement.className = 'motivation-message motivation-success';
            } else {
                motivationHTML = `üìö <strong>CONTINUE ESTUDANDO!</strong>`;
                motivationElement.className = 'motivation-message motivation-warning';
            }
        }
        
        motivationElement.innerHTML = motivationHTML;
        
        const totalQuestions = masterBank.length;
        const uniqueUsed = [...new Set(usedQuestionsHistory)];
        const remainingQuestions = Math.max(0, totalQuestions - uniqueUsed.length);
        const wrongCount = wrongQuestionsHistory.length;
        
        let summaryText = '';
        let showNewSimuladoBtn = true;
        let showReiniciarBancoBtn = false;
        let showNovoSimuladoReforcoBtn = false;
        
        if (currentQuestions[0]?.isWrongQuestion) {
            summaryText = `‚ö° <strong>SIMULADO DE REFOR√áO FINALIZADO</strong><br>`;
            summaryText += `Voc√™ revisou ${currentQuestions.length} quest√µes que errou anteriormente.<br>`;
            summaryText += `Quest√µes ainda erradas: <strong>${wrongCount}</strong>`;
            showNewSimuladoBtn = false;
            showNovoSimuladoReforcoBtn = true;
            
            if (percent < MIN_PERCENT_FOR_SUCCESS) {
                showReiniciarBancoBtn = true;
            }
        } else if (remainingQuestions === 0) {
            summaryText = `üéØ <strong>COMPLETOU TODAS AS ${totalQuestions} QUEST√ïES!</strong><br>`;
            summaryText += `Quest√µes erradas: <strong>${wrongCount}</strong>`;
            
            if (wrongCount < MIN_WRONG_QUESTIONS_FOR_SIMULADO) {
                showNewSimuladoBtn = false;
            }
        } else {
            summaryText = `Restam: <strong>${remainingQuestions}</strong> | Usadas: <strong>${uniqueUsed.length}</strong><br>`;
            summaryText += `Quest√µes erradas: <strong>${wrongCount}</strong>`;
        }
        
        document.getElementById('simulado-summary').innerHTML = summaryText;
        
        document.querySelector('.nav-buttons').style.display = 'none';
        document.getElementById('results').style.display = 'block';
        document.getElementById('finish-btn').style.display = 'none';
        document.getElementById('restart-btn').style.display = 'block';
        
        document.getElementById('wrong-questions-btn').style.display = 'none';
        document.getElementById('reiniciar-banco-btn').style.display = showReiniciarBancoBtn ? 'block' : 'none';
        document.getElementById('new-simulado-btn').style.display = showNewSimuladoBtn ? 'block' : 'none';
        document.getElementById('novo-simulado-reforco-btn').style.display = showNovoSimuladoReforcoBtn ? 'block' : 'none';
        
        updateSimuladoInfo();
        updateReforcoButton();
        updateReiniciarBancoButton();
        updateContinuarBancoButton();
        updateVoltarInicioButton();
        updateNovoSimuladoReforcoButton();
        
        setTimeout(() => {
            if (canOfferReforcoSimulado()) {
                console.log('Oferecendo simulado de refor√ßo...');
                setTimeout(() => {
                    offerWrongQuestionsSimulado();
                }, 1500);
            } else {
                console.log('N√£o pode oferecer refor√ßo no momento');
            }
        }, 500);
    }
    
    // ============================================
    // FUN√á√ïES DE CONFIGURA√á√ÉO DO SIMULADO
    // ============================================
    
    function calcularConfiguracaoSimulados() {
        const totalQuestions = masterBank.length;
        
        if (totalQuestions <= 27) {
            totalSimulados = 1;
            QUESTIONS_PER_SIMULADO = totalQuestions;
            return {
                totalSimulados: 1,
                questionsPerSimulado: totalQuestions,
                mensagem: `Banco com ${totalQuestions} quest√µes ‚Üí 1 √∫nico simulado`
            };
        } else if (totalQuestions >= 28 && totalQuestions <= 39) {
            totalSimulados = 2;
            const questionsPerSimulado = Math.ceil(totalQuestions / 2);
            QUESTIONS_PER_SIMULADO = questionsPerSimulado;
            return {
                totalSimulados: 2,
                questionsPerSimulado: questionsPerSimulado,
                mensagem: `Banco com ${totalQuestions} quest√µes ‚Üí 2 simulados de ~${questionsPerSimulado} quest√µes cada`
            };
        } else {
            totalSimulados = Math.ceil(totalQuestions / QUESTIONS_PER_SIMULADO_PADRAO);
            QUESTIONS_PER_SIMULADO = QUESTIONS_PER_SIMULADO_PADRAO;
            return {
                totalSimulados: totalSimulados,
                questionsPerSimulado: QUESTIONS_PER_SIMULADO_PADRAO,
                mensagem: `Banco com ${totalQuestions} quest√µes ‚Üí ${totalSimulados} simulados de 20 quest√µes`
            };
        }
    }
    
    // ============================================
    // NOVA FUN√á√ÉO: NOVO SIMULADO AP√ìS REFOR√áO
    // ============================================
    
    function novoSimuladoAposReforco() {
        const totalQuestions = masterBank.length;
        const remainingQuestions = Math.max(0, totalQuestions - usedQuestionsHistory.length);
        
        if (remainingQuestions === 0) {
            if (confirm(`Voc√™ j√° completou todas as ${totalQuestions} quest√µes!\n\nDeseja reiniciar o hist√≥rico e come√ßar um novo simulado?`)) {
                usedQuestionsHistory = [];
                localStorage.setItem(HISTORY_KEY, JSON.stringify(usedQuestionsHistory));
                startNewSimuladoFromResults();
            }
        } else {
            if (confirm(`Deseja continuar com as pr√≥ximas quest√µes do banco?\n\nRestam: ${remainingQuestions} quest√µes\nUsadas: ${usedQuestionsHistory.length} quest√µes`)) {
                startNewSimuladoFromResults();
            }
        }
    }
    
    // ============================================
    // FUN√á√ÉO: ATUALIZAR BOT√ÉO NOVO SIMULADO REFOR√áO
    // ============================================
    
    function updateNovoSimuladoReforcoButton() {
        const novoSimuladoBtn = document.getElementById('novo-simulado-reforco-btn');
        if (!novoSimuladoBtn) return;
        
        const isReforco = currentQuestions[0]?.isWrongQuestion;
        const isResultsVisible = document.getElementById('results').style.display === 'block';
        const totalQuestions = masterBank.length;
        const remainingQuestions = Math.max(0, totalQuestions - usedQuestionsHistory.length);
        
        if (isReforco && isResultsVisible) {
            novoSimuladoBtn.style.display = 'block';
            
            if (remainingQuestions === 0) {
                novoSimuladoBtn.innerHTML = `üéØ Novo Simulado (Reiniciar Banco)`;
            } else {
                novoSimuladoBtn.innerHTML = `üéØ Novo Simulado (${remainingQuestions} restantes)`;
            }
        } else {
            novoSimuladoBtn.style.display = 'none';
        }
    }
    
    // ============================================
    // NOVA FUN√á√ÉO: CONTINUAR COM BANCO
    // ============================================
    
    function continuarComBanco() {
        const totalQuestions = masterBank.length;
        const remainingQuestions = Math.max(0, totalQuestions - usedQuestionsHistory.length);
        
        let message = `üìö CONTINUAR COM BANCO\n\n`;
        
        if (remainingQuestions === 0) {
            message += `Voc√™ j√° completou todas as ${totalQuestions} quest√µes!\n`;
            message += `Deseja reiniciar o hist√≥rico e come√ßar um novo simulado?`;
            
            if (confirm(message)) {
                usedQuestionsHistory = [];
                localStorage.setItem(HISTORY_KEY, JSON.stringify(usedQuestionsHistory));
                startNewSimuladoFromResults();
            }
        } else {
            message += `Restam ${remainingQuestions} quest√µes no banco.\n`;
            message += `Voc√™ j√° completou ${usedQuestionsHistory.length} quest√µes.\n\n`;
            message += `Deseja continuar com as pr√≥ximas quest√µes do banco?`;
            
            if (confirm(message)) {
                startNewSimuladoFromResults();
            }
        }
    }
    
    // ============================================
    // FUN√á√ÉO: VOLTAR AO IN√çCIO
    // ============================================
    
    function voltarAoInicio() {
        const totalQuestions = masterBank.length;
        
        let message = `üèÅ VOLTAR AO IN√çCIO\n\n`;
        message += `Esta a√ß√£o vai:\n`;
        message += `‚Ä¢ Limpar TODO o hist√≥rico de progresso\n`;
        message += `‚Ä¢ Limpar TODO o hist√≥rico de quest√µes erradas\n`;
        message += `‚Ä¢ Reiniciar completamente o sistema\n`;
        message += `‚Ä¢ Come√ßar um NOVO simulado do zero\n\n`;
        message += `Tem certeza que deseja voltar ao in√≠cio?`;
        
        if (confirm(message)) {
            usedQuestionsHistory = [];
            localStorage.setItem(HISTORY_KEY, JSON.stringify(usedQuestionsHistory));
            
            wrongQuestionsHistory = [];
            saveWrongQuestionsHistory();
            
            localStorage.removeItem(LAST_OFFER_KEY);
            
            clearSessionData();
            
            document.getElementById('results').style.display = 'none';
            document.getElementById('finish-btn').style.display = 'block';
            document.getElementById('restart-btn').style.display = 'none';
            document.getElementById('voltar-inicio-btn').style.display = 'none';
            document.getElementById('continuar-banco-btn').style.display = 'none';
            document.getElementById('wrong-questions-btn').style.display = 'none';
            document.getElementById('reiniciar-banco-btn').style.display = 'none';
            document.getElementById('new-simulado-btn').style.display = 'none';
            document.getElementById('novo-simulado-reforco-btn').style.display = 'none';
            document.querySelector('.nav-buttons').style.display = 'flex';
            
            currentQuestions = selectRandomQuestions(true);
            
            if (currentQuestions.length === 0) {
                alert("Erro ao gerar novo simulado.");
                return;
            }
            
            userAnswers = new Array(currentQuestions.length).fill(null);
            currentQuestionIndex = 0;
            TIME_LIMIT = calculateTimeLimit(currentQuestions.length);
            timeLeft = TIME_LIMIT;
            autoNavEnabled = true;
            currentSimuladoNumber = 1;
            
            saveCurrentSessionState();
            
            updatePageTitle();
            document.getElementById('timer').textContent = formatTime(timeLeft);
            document.getElementById('auto-nav-checkbox').checked = autoNavEnabled;
            
            startTimer();
            renderCurrentQuestion();
            updateCounters();
            updateNavButtons();
            updateFinishButton();
            updatePendingQuestions();
            updateSimuladoInfo();
            updateReforcoButton();
            updateContinuarBancoButton();
            updateVoltarInicioButton();
            updateNovoSimuladoReforcoButton();
            
            document.getElementById('motivation-message').innerHTML = '';
            document.getElementById('motivation-message').className = 'motivation-message';
            
            alert(`‚úÖ SISTEMA REINICIADO!\n\n${totalQuestions} quest√µes dispon√≠veis.\nBoa sorte!`);
        }
    }
    
    // ============================================
    // FUN√á√ïES DE HIST√ìRICO CORRIGIDAS
    // ============================================

    function clearHistory() {
        if (confirm(`Limpar hist√≥rico completo?`)) {
            usedQuestionsHistory = [];
            localStorage.setItem(HISTORY_KEY, JSON.stringify(usedQuestionsHistory));
            
            wrongQuestionsHistory = [];
            saveWrongQuestionsHistory();
            
            clearSessionData();
            
            document.getElementById('results').style.display = 'none';
            document.getElementById('finish-btn').style.display = 'block';
            document.getElementById('restart-btn').style.display = 'none';
            document.getElementById('voltar-inicio-btn').style.display = 'none';
            document.getElementById('continuar-banco-btn').style.display = 'none';
            document.getElementById('wrong-questions-btn').style.display = 'none';
            document.getElementById('reiniciar-banco-btn').style.display = 'none';
            document.getElementById('new-simulado-btn').style.display = 'none';
            document.getElementById('novo-simulado-reforco-btn').style.display = 'none';
            document.querySelector('.nav-buttons').style.display = 'flex';
            
            currentQuestions = selectRandomQuestions(true);
            
            if (currentQuestions.length === 0) {
                alert("N√£o foi poss√≠vel gerar o simulado.");
                return;
            }
            
            userAnswers = new Array(currentQuestions.length).fill(null);
            currentQuestionIndex = 0;
            TIME_LIMIT = calculateTimeLimit(currentQuestions.length);
            timeLeft = TIME_LIMIT;
            autoNavEnabled = true;
            currentSimuladoNumber = 1;
            
            saveCurrentSessionState();
            
            updatePageTitle();
            document.getElementById('timer').textContent = formatTime(timeLeft);
            document.getElementById('auto-nav-checkbox').checked = autoNavEnabled;
            updateSimuladoInfo();
            renderCurrentQuestion();
            updateCounters();
            updateNavButtons();
            updateFinishButton();
            updatePendingQuestions();
            updateReforcoButton();
            updateContinuarBancoButton();
            updateVoltarInicioButton();
            updateNovoSimuladoReforcoButton();
            
            startTimer();
            
            alert('Hist√≥rico limpo! Novo simulado gerado.');
        }
    }

    // ============================================
    // FUN√á√ÉO GENERATENEWSIMULADO CORRIGIDA
    // ============================================

    function generateNewSimulado() {
        const totalQuestions = masterBank.length;
        const totalAvailable = Math.max(0, totalQuestions - usedQuestionsHistory.length);
        
        let message;
        if (totalAvailable === 0) {
            message = `Todas as quest√µes j√° foram usadas!\n\nDeseja reiniciar o hist√≥rico?`;
        } else if (totalAvailable < QUESTIONS_PER_SIMULADO) {
            message = `S√≥ restam ${totalAvailable} quest√µes.\n\nDeseja fazer simulado com elas?`;
        } else {
            message = `Gerar novo simulado com ${Math.min(QUESTIONS_PER_SIMULADO, totalAvailable)} quest√µes?`;
        }
        
        if (confirm(message)) {
            if (totalAvailable === 0) {
                usedQuestionsHistory = [];
                localStorage.setItem(HISTORY_KEY, JSON.stringify(usedQuestionsHistory));
                alert('Hist√≥rico reiniciado!');
            }
            
            document.getElementById('results').style.display = 'none';
            document.getElementById('finish-btn').style.display = 'block';
            document.getElementById('restart-btn').style.display = 'none';
            document.getElementById('voltar-inicio-btn').style.display = 'none';
            document.getElementById('continuar-banco-btn').style.display = 'none';
            document.getElementById('wrong-questions-btn').style.display = 'none';
            document.getElementById('reiniciar-banco-btn').style.display = 'none';
            document.getElementById('new-simulado-btn').style.display = 'none';
            document.getElementById('novo-simulado-reforco-btn').style.display = 'none';
            document.querySelector('.nav-buttons').style.display = 'flex';
            
            currentQuestions = selectRandomQuestions(false);
            
            if (currentQuestions.length === 0) {
                alert("Erro ao gerar simulado.");
                return;
            }
            
            const newSessionId = 'session_' + Date.now();
            sessionStorage.setItem(SESSION_ID_KEY, newSessionId);
            
            userAnswers = new Array(currentQuestions.length).fill(null);
            currentQuestionIndex = 0;
            TIME_LIMIT = calculateTimeLimit(currentQuestions.length);
            timeLeft = TIME_LIMIT;
            autoNavEnabled = true;
            
            saveCurrentSessionState();
            
            updatePageTitle();
            document.getElementById('timer').textContent = formatTime(timeLeft);
            document.getElementById('auto-nav-checkbox').checked = autoNavEnabled;
            startTimer();
            renderCurrentQuestion();
            updateCounters();
            updateNavButtons();
            updateFinishButton();
            updatePendingQuestions();
            updateSimuladoInfo();
            updateReforcoButton();
            updateContinuarBancoButton();
            updateVoltarInicioButton();
            updateNovoSimuladoReforcoButton();
        }
    }

    // ============================================
    // FUN√á√ÉO STARTSIMULADOFROMBANCO CORRIGIDA
    // ============================================

    function startNewSimuladoFromResults() {
        document.getElementById('results').style.display = 'none';
        document.getElementById('finish-btn').style.display = 'block';
        document.getElementById('restart-btn').style.display = 'none';
        document.getElementById('voltar-inicio-btn').style.display = 'none';
        document.getElementById('continuar-banco-btn').style.display = 'none';
        document.getElementById('wrong-questions-btn').style.display = 'none';
        document.getElementById('reiniciar-banco-btn').style.display = 'none';
        document.getElementById('new-simulado-btn').style.display = 'none';
        document.getElementById('novo-simulado-reforco-btn').style.display = 'none';
        document.querySelector('.nav-buttons').style.display = 'flex';
        
        currentQuestions = selectRandomQuestions(false);
        
        if (currentQuestions.length === 0) {
            alert("N√£o foi poss√≠vel gerar novo simulado.");
            return;
        }
        
        const newSessionId = 'session_' + Date.now();
        sessionStorage.setItem(SESSION_ID_KEY, newSessionId);
        
        userAnswers = new Array(currentQuestions.length).fill(null);
        currentQuestionIndex = 0;
        TIME_LIMIT = calculateTimeLimit(currentQuestions.length);
        timeLeft = TIME_LIMIT;
        autoNavEnabled = true;
        
        saveCurrentSessionState();
        
        updatePageTitle();
        document.getElementById('timer').textContent = formatTime(timeLeft);
        document.getElementById('auto-nav-checkbox').checked = autoNavEnabled;
        startTimer();
        renderCurrentQuestion();
        updateCounters();
        updateNavButtons();
        updateFinishButton();
        updatePendingQuestions();
        updateSimuladoInfo();
        updateReforcoButton();
        updateContinuarBancoButton();
        updateVoltarInicioButton();
        updateNovoSimuladoReforcoButton();
        
        const totalQuestions = masterBank.length;
        const remainingQuestions = Math.max(0, totalQuestions - usedQuestionsHistory.length);
        alert(`‚úÖ NOVO SIMULADO INICIADO!\n\n${currentQuestions.length} quest√µes selecionadas.\n\nRestam ${remainingQuestions} quest√µes no banco.`);
    }
    
    // ============================================
    // FUN√á√ÉO: ATUALIZAR BOT√ÉO VOLTAR AO IN√çCIO
    // ============================================
    
    function updateVoltarInicioButton() {
        const voltarBtn = document.getElementById('voltar-inicio-btn');
        if (!voltarBtn) return;
        
        const isReforco = currentQuestions[0]?.isWrongQuestion;
        const isResultsVisible = document.getElementById('results').style.display === 'block';
        const percent = parseInt(document.getElementById('final-percent')?.textContent?.replace('%', '') || 0);
        
        if (isReforco && isResultsVisible && percent >= MIN_PERCENT_FOR_SUCCESS) {
            voltarBtn.style.display = 'block';
            voltarBtn.innerHTML = `üèÅ Voltar ao In√≠cio (Limpar Tudo)`;
        } else {
            voltarBtn.style.display = 'none';
        }
    }
    
    // ============================================
    // CORRE√á√ÉO PRINCIPAL: FUN√á√ÉO UPDATESIMULADOINFO
    // ============================================
    
    function updateSimuladoInfo() {
        const totalQuestions = masterBank.length;
        
        const currentQuestionsCount = currentQuestions ? currentQuestions.length : 0;
        
        let remaining = 0;
        if (currentQuestions && currentQuestions[0]?.isWrongQuestion) {
            const wrongCount = wrongQuestionsHistory.length;
            const successRate = Math.round(((totalQuestions - wrongCount) / totalQuestions) * 100);
            
            document.getElementById('simulado-info').innerHTML = `
                <div style="color: var(--danger); font-weight: bold; text-align: center;">‚ö° SIMULADO DE REFOR√áO</div>
                <div style="text-align: center; font-size: 0.6rem;">Quest√µes que voc√™ errou anteriormente</div>
                <div class="simulado-stats">
                    <span>Quest√µes: ${currentQuestionsCount}</span>
                    <span>Acertos gerais: ${successRate}%</span>
                </div>
            `;
            document.getElementById('simulado-info').style.display = 'block';
            return;
        }
        
        const uniqueUsed = [...new Set(usedQuestionsHistory)];
        const recentUsed = uniqueUsed.length;
        remaining = Math.max(0, totalQuestions - recentUsed);
        const percentUsed = totalQuestions > 0 ? Math.round((recentUsed / totalQuestions) * 100) : 0;
        
        let simuladoNumberText = '';
        if (totalSimulados > 1) {
            const simuladoAtual = Math.min(currentSimuladoNumber, totalSimulados);
            simuladoNumberText = ` (${simuladoAtual}/${totalSimulados})`;
        }
        
        document.getElementById('simulado-info').innerHTML = `
            <div>Simulado${simuladoNumberText}: <span id="questions-per-simulado">${currentQuestionsCount}</span> quest√µes</div>
            <div class="simulado-stats">
                <span id="remaining-questions">Dispon√≠veis: ${remaining}</span>
                <span id="recent-used">Usadas: ${recentUsed} (${percentUsed}%)</span>
            </div>
            
            <div class="history-controls">
                <button class="clear-history-btn" onclick="clearHistory()">üóëÔ∏è Limpar Hist√≥rico</button>
                <button class="info-history-btn" onclick="showHistoryInfo()">‚ÑπÔ∏è Info</button>
            </div>
        `;
        document.getElementById('simulado-info').style.display = 'block';
        
        const questionsPerSimuladoEl = document.getElementById('questions-per-simulado');
        const remainingQuestionsEl = document.getElementById('remaining-questions');
        const recentUsedEl = document.getElementById('recent-used');
        
        if (questionsPerSimuladoEl) questionsPerSimuladoEl.textContent = currentQuestionsCount;
        if (remainingQuestionsEl) remainingQuestionsEl.textContent = `Dispon√≠veis: ${remaining}`;
        if (recentUsedEl) recentUsedEl.textContent = `Usadas: ${recentUsed} (${percentUsed}%)`;
    }
    
    // ============================================
    // CORRE√á√ÉO: FUN√á√ÉO UPDATECONTINUARBANCOBUTTON
    // ============================================
    
    function updateContinuarBancoButton() {
        const continuarBtn = document.getElementById('continuar-banco-btn');
        if (!continuarBtn) return;
        
        const totalQuestions = masterBank.length;
        const uniqueUsed = [...new Set(usedQuestionsHistory)];
        const remainingQuestions = Math.max(0, totalQuestions - uniqueUsed.length);
        
        const isResultsVisible = document.getElementById('results').style.display === 'block';
        const isReforco = currentQuestions[0]?.isWrongQuestion;
        const percent = parseInt(document.getElementById('final-percent')?.textContent?.replace('%', '') || 0);
        
        if (isResultsVisible && !isReforco && remainingQuestions > 0) {
            continuarBtn.style.display = 'block';
            continuarBtn.innerHTML = `üìö Continuar com Banco (${remainingQuestions} restantes)`;
        } else if (isResultsVisible && isReforco && percent >= MIN_PERCENT_FOR_SUCCESS) {
            continuarBtn.style.display = 'block';
            continuarBtn.innerHTML = `üìö Voltar ao Banco (${remainingQuestions} restantes)`;
        } else {
            continuarBtn.style.display = 'none';
        }
    }
    
    // ============================================
    // FUN√á√ÉO: START WRONG QUESTIONS SIMULADO
    // ============================================
    
    function startWrongQuestionsSimulado() {
        console.log('Iniciando simulado de refor√ßo...');
        
        currentQuestions = generateWrongQuestionsSimulado();
        
        if (currentQuestions.length === 0) {
            alert('N√£o h√° quest√µes erradas para fazer o simulado de refor√ßo.');
            updateReforcoButton();
            return;
        }
        
        currentSimuladoNumber = totalSimulados + 1;
        
        userAnswers = new Array(currentQuestions.length).fill(null);
        currentQuestionIndex = 0;
        TIME_LIMIT = calculateTimeLimit(currentQuestions.length);
        timeLeft = TIME_LIMIT;
        autoNavEnabled = true;
        
        saveCurrentSessionState();
        
        updatePageTitle();
        document.getElementById('timer').textContent = formatTime(timeLeft);
        document.getElementById('auto-nav-checkbox').checked = autoNavEnabled;
        
        document.getElementById('results').style.display = 'none';
        document.getElementById('finish-btn').style.display = 'block';
        document.getElementById('restart-btn').style.display = 'none';
        document.getElementById('voltar-inicio-btn').style.display = 'none';
        document.getElementById('continuar-banco-btn').style.display = 'none';
        document.getElementById('wrong-questions-btn').style.display = 'none';
        document.getElementById('reiniciar-banco-btn').style.display = 'none';
        document.getElementById('new-simulado-btn').style.display = 'none';
        document.getElementById('novo-simulado-reforco-btn').style.display = 'none';
        document.querySelector('.nav-buttons').style.display = 'flex';
        
        const wrongCount = wrongQuestionsHistory.length;
        const totalQuestions = masterBank.length;
        const successRate = Math.round(((totalQuestions - wrongCount) / totalQuestions) * 100);
        
        document.getElementById('simulado-info').innerHTML = `
            <div style="color: var(--danger); font-weight: bold; text-align: center;">‚ö° SIMULADO DE REFOR√áO</div>
            <div style="text-align: center; font-size: 0.6rem;">Quest√µes que voc√™ errou anteriormente</div>
            <div class="simulado-stats">
                <span>Quest√µes: ${currentQuestions.length}</span>
                <span>Acertos anteriores: ${successRate}%</span>
            </div>
        `;
        document.getElementById('simulado-info').style.display = 'block';
        
        startTimer();
        renderCurrentQuestion();
        updateCounters();
        updateNavButtons();
        updateFinishButton();
        updatePendingQuestions();
        
        updateReforcoButton();
        updateReiniciarBancoButton();
        updateContinuarBancoButton();
        updateVoltarInicioButton();
        updateNovoSimuladoReforcoButton();
        
        alert(`üéØ SIMULADO DE REFOR√áO INICIADO!\n\n${currentQuestions.length} quest√µes que voc√™ errou anteriormente.\nBoa sorte!`);
    }
    
    // ============================================
    // FUN√á√ÉO: UPDATE REFORCO BUTTON
    // ============================================
    
    function updateReforcoButton() {
        const wrongBtn = document.getElementById('wrong-questions-btn');
        if (!wrongBtn) return;
        
        const hasEnough = hasEnoughWrongQuestionsForSimulado();
        const isReforcoActive = currentQuestions[0]?.isWrongQuestion;
        const isResultsVisible = document.getElementById('results').style.display === 'block';
        
        if (hasEnough && !isReforcoActive && isResultsVisible) {
            wrongBtn.style.display = 'block';
            wrongBtn.innerHTML = `‚ö° Simulado de Refor√ßo (${wrongQuestionsHistory.length})`;
        } else {
            wrongBtn.style.display = 'none';
        }
    }
    
    // ============================================
    // FUN√á√ÉO: UPDATE REINICIAR BANCO BUTTON
    // ============================================
    
    function updateReiniciarBancoButton() {
        const reiniciarBtn = document.getElementById('reiniciar-banco-btn');
        if (!reiniciarBtn) return;
        
        const isReforco = currentQuestions[0]?.isWrongQuestion;
        const isResultsVisible = document.getElementById('results').style.display === 'block';
        const percent = parseInt(document.getElementById('final-percent')?.textContent?.replace('%', '') || 0);
        
        if (isReforco && isResultsVisible && percent < MIN_PERCENT_FOR_SUCCESS) {
            reiniciarBtn.style.display = 'block';
            reiniciarBtn.innerHTML = `üîÑ Reiniciar Banco (${masterBank.length} quest√µes)`;
        } else {
            reiniciarBtn.style.display = 'none';
        }
    }
    
    // ============================================
    // FUN√á√ÉO: REINICIAR BANCO COMPLETO
    // ============================================
    
    function reiniciarBancoCompleto() {
        const totalQuestions = masterBank.length;
        const wrongCount = wrongQuestionsHistory.length;
        
        let message = `üîÑ REINICIAR BANCO COMPLETO\n\n`;
        message += `Voc√™ n√£o atingiu 70% no simulado de refor√ßo.\n\n`;
        message += `Esta a√ß√£o vai:\n`;
        message += `‚Ä¢ Limpar TODO o hist√≥rico (${usedQuestionsHistory.length} quest√µes usadas)\n`;
        message += `‚Ä¢ Limpar TODO o hist√≥rico de erros (${wrongCount} quest√µes)\n`;
        message += `‚Ä¢ Reiniciar o progresso do ZERO\n\n`;
        message += `Deseja reiniciar completamente?`;
        
        if (confirm(message)) {
            usedQuestionsHistory = [];
            localStorage.setItem(HISTORY_KEY, JSON.stringify(usedQuestionsHistory));
            
            wrongQuestionsHistory = [];
            saveWrongQuestionsHistory();
            
            localStorage.removeItem(LAST_OFFER_KEY);
            
            clearSessionData();
            
            document.getElementById('results').style.display = 'none';
            document.getElementById('finish-btn').style.display = 'block';
            document.getElementById('restart-btn').style.display = 'none';
            document.getElementById('voltar-inicio-btn').style.display = 'none';
            document.getElementById('continuar-banco-btn').style.display = 'none';
            document.getElementById('wrong-questions-btn').style.display = 'none';
            document.getElementById('reiniciar-banco-btn').style.display = 'none';
            document.getElementById('new-simulado-btn').style.display = 'none';
            document.getElementById('novo-simulado-reforco-btn').style.display = 'none';
            document.querySelector('.nav-buttons').style.display = 'flex';
            
            currentQuestions = selectRandomQuestions(true);
            
            if (currentQuestions.length === 0) {
                alert("Erro ao gerar novo simulado.");
                return;
            }
            
            userAnswers = new Array(currentQuestions.length).fill(null);
            currentQuestionIndex = 0;
            TIME_LIMIT = calculateTimeLimit(currentQuestions.length);
            timeLeft = TIME_LIMIT;
            autoNavEnabled = true;
            currentSimuladoNumber = 1;
            
            saveCurrentSessionState();
            
            updatePageTitle();
            document.getElementById('timer').textContent = formatTime(timeLeft);
            document.getElementById('auto-nav-checkbox').checked = autoNavEnabled;
            
            startTimer();
            renderCurrentQuestion();
            updateCounters();
            updateNavButtons();
            updateFinishButton();
            updatePendingQuestions();
            updateSimuladoInfo();
            updateReforcoButton();
            updateContinuarBancoButton();
            updateVoltarInicioButton();
            updateNovoSimuladoReforcoButton();
            
            document.getElementById('motivation-message').innerHTML = '';
            document.getElementById('motivation-message').className = 'motivation-message';
            
            alert(`‚úÖ BANCO REINICIADO!\n\n${totalQuestions} quest√µes dispon√≠veis.\nBoa sorte!`);
        }
    }
    
    // ============================================
    // FUN√á√ÉO RESETQUIZ CORRIGIDA
    // ============================================
    
    function resetQuiz() {
        if (confirm('Reiniciar este simulado?')) {
            userAnswers = new Array(currentQuestions.length).fill(null);
            timeLeft = TIME_LIMIT;
            currentQuestionIndex = 0;
            
            document.getElementById('results').style.display = 'none';
            document.getElementById('finish-btn').style.display = 'block';
            document.getElementById('restart-btn').style.display = 'none';
            document.getElementById('voltar-inicio-btn').style.display = 'none';
            document.getElementById('continuar-banco-btn').style.display = 'none';
            document.getElementById('wrong-questions-btn').style.display = 'none';
            document.getElementById('reiniciar-banco-btn').style.display = 'none';
            document.getElementById('new-simulado-btn').style.display = 'none';
            document.getElementById('novo-simulado-reforco-btn').style.display = 'none';
            document.querySelector('.nav-buttons').style.display = 'flex';
            
            document.getElementById('quiz-content').innerHTML = '';
            
            saveCurrentSessionState();
            
            startTimer();
            renderCurrentQuestion();
            updateCounters();
            updateNavButtons();
            updateFinishButton();
            updatePendingQuestions();
            updateContinuarBancoButton();
            updateVoltarInicioButton();
            updateNovoSimuladoReforcoButton();
        }
    }
    
    // ============================================
    // FUN√á√ÉO STARTNEWQUIZ CORRIGIDA
    // ============================================
    
    function startNewQuiz() {
        document.getElementById('results').style.display = 'none';
        document.getElementById('finish-btn').style.display = 'block';
        document.getElementById('restart-btn').style.display = 'none';
        document.getElementById('voltar-inicio-btn').style.display = 'none';
        document.getElementById('continuar-banco-btn').style.display = 'none';
        document.getElementById('wrong-questions-btn').style.display = 'none';
        document.getElementById('reiniciar-banco-btn').style.display = 'none';
        document.getElementById('new-simulado-btn').style.display = 'none';
        document.getElementById('novo-simulado-reforco-btn').style.display = 'none';
        document.querySelector('.nav-buttons').style.display = 'flex';
        
        document.getElementById('quiz-content').innerHTML = '';
        
        userAnswers = new Array(currentQuestions.length).fill(null);
        timeLeft = TIME_LIMIT;
        currentQuestionIndex = 0;
        
        saveCurrentSessionState();
        
        startTimer();
        renderCurrentQuestion();
        updateCounters();
        updateNavButtons();
        updateFinishButton();
        updatePendingQuestions();
        updateContinuarBancoButton();
        updateVoltarInicioButton();
        updateNovoSimuladoReforcoButton();
    }
    
    // ============================================
    // RESTANTE DAS FUN√á√ïES EXISTENTES
    // ============================================
    
    function loadWrongQuestionsHistory() {
        const saved = localStorage.getItem(WRONG_QUESTIONS_KEY);
        if (saved) {
            try {
                wrongQuestionsHistory = JSON.parse(saved);
                console.log(`Hist√≥rico de quest√µes erradas carregado: ${wrongQuestionsHistory.length} quest√µes`);
            } catch (e) {
                console.error('Erro ao carregar hist√≥rico de quest√µes erradas:', e);
                wrongQuestionsHistory = [];
            }
        } else {
            wrongQuestionsHistory = [];
            console.log('Nenhum hist√≥rico de quest√µes erradas encontrado');
        }
    }
    
    function saveWrongQuestionsHistory() {
        localStorage.setItem(WRONG_QUESTIONS_KEY, JSON.stringify(wrongQuestionsHistory));
    }
    
    function addWrongQuestionsToHistory() {
        if (!currentQuestions || currentQuestions.length === 0) return;
        
        currentQuestions.forEach((question, index) => {
            const userAnswer = userAnswers[index];
            const isCorrect = userAnswer !== null && userAnswer === question.c;
            
            if (!isCorrect && question.originalIndex !== undefined) {
                if (!wrongQuestionsHistory.includes(question.originalIndex)) {
                    wrongQuestionsHistory.push(question.originalIndex);
                }
            }
        });
        
        wrongQuestionsHistory = [...new Set(wrongQuestionsHistory)];
        saveWrongQuestionsHistory();
        
        console.log(`Quest√µes erradas adicionadas ao hist√≥rico. Total: ${wrongQuestionsHistory.length}`);
    }
    
    function removeCorrectQuestionsFromHistory() {
        const initialCount = wrongQuestionsHistory.length;
        
        if (!currentQuestions || currentQuestions.length === 0) return;
        
        currentQuestions.forEach((question, index) => {
            const userAnswer = userAnswers[index];
            const isCorrect = userAnswer !== null && userAnswer === question.c;
            
            if (isCorrect && question.originalIndex !== undefined) {
                const indexInHistory = wrongQuestionsHistory.indexOf(question.originalIndex);
                if (indexInHistory !== -1) {
                    wrongQuestionsHistory.splice(indexInHistory, 1);
                }
            }
        });
        
        saveWrongQuestionsHistory();
        
        console.log(`Quest√µes removidas do hist√≥rico de erradas: ${initialCount - wrongQuestionsHistory.length}`);
    }
    
    function allQuestionsUsed() {
        const totalQuestions = masterBank.length;
        const uniqueUsed = [...new Set(usedQuestionsHistory)];
        return uniqueUsed.length >= totalQuestions;
    }
    
    function hasEnoughWrongQuestionsForSimulado() {
        return wrongQuestionsHistory.length >= MIN_WRONG_QUESTIONS_FOR_SIMULADO;
    }
    
    function canOfferReforcoSimulado() {
        const condition1 = hasEnoughWrongQuestionsForSimulado();
        const condition2 = !currentQuestions[0]?.isWrongQuestion;
        const condition3 = !hasRecentOffer();
        
        return condition1 && condition2 && condition3;
    }
    
    function hasRecentOffer() {
        const lastOffer = localStorage.getItem(LAST_OFFER_KEY);
        if (!lastOffer) return false;
        
        const now = Date.now();
        const lastOfferTime = parseInt(lastOffer);
        const TWO_HOURS_MS = 2 * 60 * 60 * 1000;
        
        return (now - lastOfferTime) < TWO_HOURS_MS;
    }
    
    function saveOfferTimestamp() {
        localStorage.setItem(LAST_OFFER_KEY, Date.now().toString());
    }
    
    function isNewSession() {
        const sessionId = sessionStorage.getItem(SESSION_ID_KEY);
        const simuladoStarted = sessionStorage.getItem(SIMULADO_STARTED_KEY);
        
        if (!sessionId || !simuladoStarted) {
            const newSessionId = 'session_' + Date.now();
            sessionStorage.setItem(SESSION_ID_KEY, newSessionId);
            sessionStorage.setItem(SIMULADO_STARTED_KEY, 'true');
            return true;
        }
        return false;
    }
    
    function clearSessionData() {
        sessionStorage.removeItem(CURRENT_QUESTIONS_KEY);
        sessionStorage.removeItem(CURRENT_QUESTION_INDEX_KEY);
        sessionStorage.removeItem(USER_ANSWERS_KEY);
        sessionStorage.removeItem(TIME_LEFT_KEY);
        sessionStorage.removeItem(AUTO_NAV_KEY);
        sessionStorage.removeItem(SIMULADO_STARTED_KEY);
        sessionStorage.removeItem(CURRENT_SIMULADO_NUMBER_KEY);
    }
    
    function saveCurrentSessionState() {
        try {
            sessionStorage.setItem(CURRENT_QUESTIONS_KEY, JSON.stringify(currentQuestions));
            sessionStorage.setItem(CURRENT_QUESTION_INDEX_KEY, currentQuestionIndex.toString());
            sessionStorage.setItem(USER_ANSWERS_KEY, JSON.stringify(userAnswers));
            sessionStorage.setItem(TIME_LEFT_KEY, timeLeft.toString());
            sessionStorage.setItem(AUTO_NAV_KEY, autoNavEnabled.toString());
            sessionStorage.setItem(SIMULADO_STARTED_KEY, 'true');
            sessionStorage.setItem(CURRENT_SIMULADO_NUMBER_KEY, currentSimuladoNumber.toString());
        } catch (e) {
            console.error('Erro ao salvar estado da sess√£o:', e);
        }
    }
    
    function loadCurrentSessionState() {
        try {
            const savedQuestions = sessionStorage.getItem(CURRENT_QUESTIONS_KEY);
            const savedIndex = sessionStorage.getItem(CURRENT_QUESTION_INDEX_KEY);
            const savedAnswers = sessionStorage.getItem(USER_ANSWERS_KEY);
            const savedTime = sessionStorage.getItem(TIME_LEFT_KEY);
            const savedAutoNav = sessionStorage.getItem(AUTO_NAV_KEY);
            const savedSimuladoNumber = sessionStorage.getItem(CURRENT_SIMULADO_NUMBER_KEY);
            
            if (savedQuestions) currentQuestions = JSON.parse(savedQuestions);
            if (savedIndex) currentQuestionIndex = parseInt(savedIndex);
            if (savedAnswers) userAnswers = JSON.parse(savedAnswers);
            if (savedTime) timeLeft = parseInt(savedTime);
            if (savedAutoNav) autoNavEnabled = savedAutoNav === 'true';
            if (savedSimuladoNumber) currentSimuladoNumber = parseInt(savedSimuladoNumber);
            
            return {
                hasQuestions: !!savedQuestions,
                hasState: !!(savedQuestions && savedIndex !== null)
            };
        } catch (e) {
            console.error('Erro ao carregar estado da sess√£o:', e);
            return { hasQuestions: false, hasState: false };
        }
    }
    
    function generateQuizId() {
        const pageTitle = document.title || "Quiz";
        const cleanTitle = pageTitle
            .replace(/[^a-zA-Z0-9\s]/g, '')
            .replace(/\s+/g, '_')
            .toLowerCase()
            .substring(0, 30);
        const titleHash = pageTitle.length.toString(36);
        return `quiz_${cleanTitle}_${titleHash}`;
    }
    
    const QUIZ_ID = generateQuizId();
    const HISTORY_KEY = `${QUIZ_ID}_history`;
    const REPORTS_KEY = `${QUIZ_ID}_reports`;
    
    function updatePageTitle() {
        const totalQuestions = masterBank.length;
        let simuladoText = '';
        
        if (currentQuestions && currentQuestions[0]?.isWrongQuestion) {
            simuladoText = ' (‚ö° Refor√ßo)';
        } else if (totalSimulados > 1) {
            simuladoText = ` (Simulado ${currentSimuladoNumber}/${totalSimulados})`;
        }
        
        const pageTitle = document.title || "Quiz Simulado";
        let cleanTitle = pageTitle
            .replace(/^GMP\s*[-‚Äì‚Äî]\s*/i, '')
            .replace(/^Simulado\s*[-‚Äì‚Äî]\s*/i, '')
            .replace(/^Quiz\s*[-‚Äì‚Äî]\s*/i, '')
            .replace(/\s*[-‚Äì‚Äî]\s*Simulado$/i, '')
            .replace(/\s*[-‚Äì‚Äî]\s*Quiz$/i, '')
            .replace(/\s*[-‚Äì‚Äî]\s*Teste$/i, '')
            .trim();
        
        if (!cleanTitle) cleanTitle = pageTitle;
        if (cleanTitle.length > 40) cleanTitle = cleanTitle.substring(0, 37) + '...';
        
        const questionCount = currentQuestions ? currentQuestions.length : 0;
        document.getElementById('page-title').textContent = 
            `${cleanTitle}${simuladoText} (${questionCount}/${totalQuestions})`;
    }
    
    function calculateTimeLimit(questionsCount) {
        return questionsCount * 60;
    }
    
    function formatTime(seconds) {
        const mins = Math.floor(seconds / 60);
        const secs = seconds % 60;
        return `${mins}:${secs.toString().padStart(2, '0')}`;
    }
    
    function shuffleArray(array) {
        const shuffled = [...array];
        for (let i = shuffled.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
        }
        return shuffled;
    }
    
    function showHistoryInfo() {
        const totalQuestions = masterBank.length;
        const uniqueUsed = [...new Set(usedQuestionsHistory)];
        const usedCount = uniqueUsed.length;
        const availableCount = Math.max(0, totalQuestions - usedCount);
        const percentUsed = totalQuestions > 0 ? Math.round((usedCount / totalQuestions) * 100) : 0;
        const wrongCount = wrongQuestionsHistory.length;
        
        let message = `üìä ESTAT√çSTICAS:\n\n`;
        message += `‚Ä¢ Total: ${totalQuestions} quest√µes\n`;
        message += `‚Ä¢ Usadas: ${usedCount} (${percentUsed}%)\n`;
        message += `‚Ä¢ Dispon√≠veis: ${availableCount}\n`;
        message += `‚Ä¢ Erradas: ${wrongCount}\n`;
        
        if (currentQuestions && currentQuestions[0]?.isWrongQuestion) {
            message += `\n‚ö° SIMULADO DE REFOR√áO ATIVO\n`;
        }
        
        if (wrongCount >= MIN_WRONG_QUESTIONS_FOR_SIMULADO) {
            message += `\n‚ö° SIMULADO DE REFOR√áO DISPON√çVEL\n`;
            message += `‚Ä¢ ${wrongCount} quest√µes para revisar\n`;
        }
        
        alert(message);
    }
    
    function updatePendingQuestions() {
        const pendingList = document.getElementById('pending-list');
        const pendingCount = document.getElementById('pending-count');
        const answeredCount = getAnsweredCount();
        const pending = currentQuestions ? currentQuestions.length - answeredCount : 0;
        
        if (pendingCount) pendingCount.textContent = pending;
        
        if (pending === 0) {
            if (pendingList) pendingList.innerHTML = '<span style="color: #28a745;">‚úÖ Todas</span>';
            return;
        }
        
        let html = '';
        let pendingNumbers = [];
        
        if (currentQuestions) {
            for (let i = 0; i < currentQuestions.length; i++) {
                if (userAnswers[i] === null) {
                    pendingNumbers.push(i + 1);
                }
            }
        }
        
        const maxToShow = 10;
        const numbersToShow = pendingNumbers.slice(0, maxToShow);
        
        numbersToShow.forEach(num => {
            html += `<span class="pending-number">${num}</span>`;
        });
        
        if (pendingNumbers.length > maxToShow) {
            html += `<span style="color: #6c757d; font-size: 0.55rem;"> +${pendingNumbers.length - maxToShow}</span>`;
        }
        
        if (pendingList) {
            pendingList.innerHTML = html || '<span style="color: #6c757d;">Nenhuma</span>';
        }
    }
    
    // ============================================
    // FUN√á√ÉO INITQUIZ ATUALIZADA
    // ============================================

    function initQuiz() {
        loadWrongQuestionsHistory();
        
        if (masterBank.length === 0) {
            document.getElementById('page-title').textContent = "‚ö†Ô∏è BANCO VAZIO";
            document.getElementById('quiz-content').innerHTML = `
                <div class="question-block-mini">
                    <div class="question-text-mini" style="color: var(--danger);">
                        ‚ö†Ô∏è ERRO: Banco de quest√µes vazio!
                    </div>
                </div>
            `;
            return;
        }
        
        const config = calcularConfiguracaoSimulados();
        console.log('Configura√ß√£o:', config.mensagem);
        totalSimulados = config.totalSimulados;
        QUESTIONS_PER_SIMULADO = config.questionsPerSimulado;
        
        const savedHistory = localStorage.getItem(HISTORY_KEY);
        if (savedHistory) {
            try {
                usedQuestionsHistory = JSON.parse(savedHistory);
            } catch (e) {
                console.error('Erro ao carregar hist√≥rico:', e);
                usedQuestionsHistory = [];
            }
        } else {
            usedQuestionsHistory = [];
        }
        
        if (isNewSession()) {
            console.log('Nova sess√£o - gerando quest√µes');
            currentQuestions = selectRandomQuestions();
            
            if (currentQuestions.length === 0) {
                alert("N√£o foi poss√≠vel selecionar quest√µes.");
                return;
            }
            
            userAnswers = new Array(currentQuestions.length).fill(null);
            currentQuestionIndex = 0;
            TIME_LIMIT = calculateTimeLimit(currentQuestions.length);
            timeLeft = TIME_LIMIT;
            autoNavEnabled = true;
            
            saveCurrentSessionState();
        } else {
            console.log('Sess√£o existente - restaurando');
            const state = loadCurrentSessionState();
            
            if (state.hasQuestions && state.hasState) {
                console.log('Estado restaurado');
                if (timeLeft <= 0) {
                    TIME_LIMIT = calculateTimeLimit(currentQuestions.length);
                    timeLeft = TIME_LIMIT;
                }
            } else {
                console.log('N√£o h√° estado - gerando novo');
                currentQuestions = selectRandomQuestions();
                if (currentQuestions.length === 0) {
                    alert("N√£o foi poss√≠vel gerar o simulado.");
                    return;
                }
                
                userAnswers = new Array(currentQuestions.length).fill(null);
                currentQuestionIndex = 0;
                TIME_LIMIT = calculateTimeLimit(currentQuestions.length);
                timeLeft = TIME_LIMIT;
                autoNavEnabled = true;
                
                saveCurrentSessionState();
            }
        }
        
        updatePageTitle();
        document.getElementById('timer').textContent = formatTime(timeLeft);
        document.getElementById('auto-nav-checkbox').checked = autoNavEnabled;
        
        updateSimuladoInfo();
        startTimer();
        renderCurrentQuestion();
        updateCounters();
        updateNavButtons();
        updateFinishButton();
        updatePendingQuestions();
        updateReforcoButton();
        updateReiniciarBancoButton();
        updateContinuarBancoButton();
        updateVoltarInicioButton();
        updateNovoSimuladoReforcoButton();
    }
    
    function selectAnswer(answerIndex) {
        userAnswers[currentQuestionIndex] = answerIndex;
        saveCurrentSessionState();
        
        updateCounters();
        updateFinishButton();
        updatePendingQuestions();
        
        if (autoNavEnabled && currentQuestionIndex < currentQuestions.length - 1) {
            setTimeout(() => {
                nextQuestion();
            }, 200);
        }
    }
    
    function toggleAutoNav() {
        autoNavEnabled = !autoNavEnabled;
        document.getElementById('auto-nav-checkbox').checked = autoNavEnabled;
        saveCurrentSessionState();
    }
    
    function getAnsweredCount() {
        return userAnswers.filter(answer => answer !== null).length;
    }
    
    function updateFinishButton() {
        const finishBtn = document.getElementById('finish-btn');
        const answeredCount = getAnsweredCount();
        const allAnswered = currentQuestions && answeredCount === currentQuestions.length;
        
        finishBtn.disabled = !allAnswered;
        finishBtn.innerHTML = allAnswered ? 'üèÅ Finalizar' : `‚ùå Faltam ${currentQuestions ? currentQuestions.length - answeredCount : 0}`;
    }
    
    function updateNavButtons() {
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        
        prevBtn.disabled = currentQuestionIndex === 0;
        nextBtn.disabled = currentQuestions ? currentQuestionIndex === currentQuestions.length - 1 : true;
        nextBtn.innerHTML = currentQuestions && currentQuestionIndex === currentQuestions.length - 1 ? '√öltima' : 'Pr√≥ximo ‚Üí';
    }
    
    function updateCounters() {
        const answeredCount = getAnsweredCount();
        const totalQuestions = currentQuestions ? currentQuestions.length : 0;
        
        document.getElementById('question-counter').textContent = `${currentQuestionIndex + 1}/${totalQuestions}`;
        document.getElementById('answered-counter').textContent = `${answeredCount}/${totalQuestions}`;
        document.getElementById('progress-percent').textContent = `${totalQuestions > 0 ? Math.round((answeredCount / totalQuestions) * 100) : 0}%`;
        document.getElementById('status-count').textContent = `${answeredCount}/${totalQuestions}`;
        
        updateTimerDisplay();
    }
    
    function updateTimerDisplay() {
        const timerElement = document.getElementById('timer');
        timerElement.textContent = formatTime(timeLeft);
        
        if (timeLeft <= Math.min(300, Math.floor(TIME_LIMIT * 0.25))) {
            timerElement.classList.add('timer-warning');
        } else {
            timerElement.classList.remove('timer-warning');
        }
    }
    
    function startTimer() {
        clearInterval(timerId);
        
        timerId = setInterval(() => {
            timeLeft--;
            
            if (timeLeft % 5 === 0) {
                saveCurrentSessionState();
            }
            
            updateTimerDisplay();
            
            if (timeLeft <= 0) {
                clearInterval(timerId);
                if (getAnsweredCount() === currentQuestions.length) {
                    finalizeQuiz();
                } else {
                    if (confirm('Tempo esgotado! Finalizar?')) {
                        finalizeQuiz();
                    }
                }
            }
        }, 1000);
    }
    
    function nextQuestion() {
        if (currentQuestions && currentQuestionIndex < currentQuestions.length - 1) {
            currentQuestionIndex++;
            saveCurrentSessionState();
            renderCurrentQuestion();
            updateCounters();
            updateNavButtons();
        }
    }
    
    function prevQuestion() {
        if (currentQuestionIndex > 0) {
            currentQuestionIndex--;
            saveCurrentSessionState();
            renderCurrentQuestion();
            updateCounters();
            updateNavButtons();
        }
    }
    
    // ============================================
    // SISTEMA DE REPORTE - CORRIGIDO
    // ============================================
    
    function initReportSystem() {
        const savedReports = localStorage.getItem(REPORTS_KEY);
        if (savedReports) {
            reportsHistory = JSON.parse(savedReports);
        } else {
            reportsHistory = [];
        }
        
        document.getElementById('cancelReport').addEventListener('click', closeReportModal);
        document.getElementById('submitReport').addEventListener('click', submitReport);
        
        document.getElementById('reportModal').addEventListener('click', function(e) {
            if (e.target.id === 'reportModal') {
                closeReportModal();
            }
        });
        
        const reportDetails = document.getElementById('reportDetails');
        const charCount = document.getElementById('charCount');
        
        if (reportDetails && charCount) {
            reportDetails.addEventListener('input', function() {
                charCount.textContent = this.value.length;
                if (this.value.length > 1000) {
                    this.value = this.value.substring(0, 1000);
                    charCount.textContent = 1000;
                }
            });
        }
        
        const inputs = document.querySelectorAll('.form-input');
        inputs.forEach(input => {
            input.addEventListener('input', function() {
                if (this.classList.contains('error')) {
                    this.classList.remove('error');
                    hideError();
                }
            });
        });
    }
    
    function openReportModal(questionIndex) {
        currentReportQuestionIndex = questionIndex;
        
        if (!currentQuestions || currentQuestions.length === 0) {
            alert("N√£o h√° quest√µes carregadas.");
            return;
        }
        
        const question = currentQuestions[questionIndex];
        
        document.getElementById('reportQuestionNumber').textContent = questionIndex + 1;
        
        let questionText = question.q;
        if (questionText.length > 150) {
            questionText = questionText.substring(0, 147) + '...';
        }
        document.getElementById('reportQuestionText').textContent = questionText;
        
        document.querySelectorAll('input[name="reportType"]').forEach(radio => {
            radio.checked = false;
        });
        document.getElementById('reportDetails').value = '';
        document.getElementById('userName').value = '';
        document.getElementById('userEmail').value = '';
        document.getElementById('userInfo').value = '';
        document.getElementById('charCount').textContent = '0';
        document.getElementById('reportSuccess').style.display = 'none';
        document.getElementById('reportErrorMsg').style.display = 'none';
        
        document.getElementById('submitReport').disabled = false;
        document.getElementById('submitText').textContent = 'Enviar Reporte';
        document.getElementById('submitLoading').style.display = 'none';
        
        document.getElementById('reportModal').style.display = 'flex';
        
        setTimeout(() => {
            document.getElementById('userName').focus();
        }, 100);
    }
    
    function closeReportModal() {
        document.getElementById('reportModal').style.display = 'none';
        currentReportQuestionIndex = null;
    }
    
    function showError(message) {
        const errorElement = document.getElementById('reportErrorMsg');
        errorElement.textContent = message;
        errorElement.style.display = 'block';
        errorElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
    }
    
    function hideError() {
        document.getElementById('reportErrorMsg').style.display = 'none';
    }
    
    function validateForm() {
        const name = document.getElementById('userName').value.trim();
        const email = document.getElementById('userEmail').value.trim();
        const reportType = document.querySelector('input[name="reportType"]:checked');
        
        if (!name) {
            document.getElementById('userName').classList.add('error');
            showError('Por favor, preencha seu nome completo.');
            return false;
        }
        
        if (!email) {
            document.getElementById('userEmail').classList.add('error');
            showError('Por favor, preencha seu e-mail.');
            return false;
        }
        
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        if (!emailRegex.test(email)) {
            document.getElementById('userEmail').classList.add('error');
            showError('Por favor, insira um e-mail v√°lido.');
            return false;
        }
        
        if (!reportType) {
            showError('Por favor, selecione o tipo de problema.');
            return false;
        }
        
        return true;
    }
    
    async function submitReport() {
        if (!validateForm()) {
            return;
        }
        
        const questionIndex = currentReportQuestionIndex;
        const question = currentQuestions[questionIndex];
        
        const reportData = {
            quizId: QUIZ_ID,
            materia: document.title || "Quiz",
            questionIndex: questionIndex + 1,
            originalIndex: question.originalIndex,
            questionText: question.q,
            reportType: document.querySelector('input[name="reportType"]:checked').value,
            reportLabel: REPORT_TYPES[document.querySelector('input[name="reportType"]:checked').value],
            details: document.getElementById('reportDetails').value.trim(),
            userName: document.getElementById('userName').value.trim(),
            userEmail: document.getElementById('userEmail').value.trim(),
            userInfo: document.getElementById('userInfo').value.trim(),
            userAnswer: userAnswers[questionIndex] !== null ? 
                question.a[userAnswers[questionIndex]] : 'N√£o respondida',
            correctAnswer: question.a[question.c],
            userAnswerIndex: userAnswers[questionIndex],
            correctAnswerIndex: question.c,
            timestamp: new Date().toLocaleString('pt-BR'),
            url: window.location.href,
            userAgent: navigator.userAgent
        };
        
        document.getElementById('submitReport').disabled = true;
        document.getElementById('submitText').textContent = 'Enviando...';
        document.getElementById('submitLoading').style.display = 'inline-block';
        
        try {
            const response = await sendToGoogleSheets(reportData);
            
            if (response.success) {
                const report = {
                    ...reportData,
                    id: Date.now(),
                    timestamp: new Date().toISOString(),
                    sentToGoogleSheets: true
                };
                
                reportsHistory.push(report);
                localStorage.setItem(REPORTS_KEY, JSON.stringify(reportsHistory));
                
                document.getElementById('reportSuccess').style.display = 'block';
                document.getElementById('submitText').textContent = 'Enviado!';
                
                setTimeout(() => {
                    closeReportModal();
                }, 3000);
            } else {
                throw new Error(response.message || 'Erro ao enviar');
            }
        } catch (error) {
            console.error('Erro ao enviar reporte:', error);
            
            const emailSent = sendReportByEmailFallback(reportData);
            
            if (emailSent) {
                const report = {
                    ...reportData,
                    id: Date.now(),
                    timestamp: new Date().toISOString(),
                    sentByEmail: true
                };
                
                reportsHistory.push(report);
                localStorage.setItem(REPORTS_KEY, JSON.stringify(reportsHistory));
                
                document.getElementById('reportSuccess').innerHTML = 
                    '‚úÖ Reporte enviado por email! Obrigado pela contribui√ß√£o.<br>' +
                    '<small>Voc√™ receber√° um feedback por email em breve.</small>';
                document.getElementById('reportSuccess').style.display = 'block';
                document.getElementById('submitText').textContent = 'Enviado!';
                
                setTimeout(() => {
                    closeReportModal();
                }, 3000);
            } else {
                const report = {
                    ...reportData,
                    id: Date.now(),
                    timestamp: new Date().toISOString(),
                    savedLocally: true
                };
                
                reportsHistory.push(report);
                localStorage.setItem(REPORTS_KEY, JSON.stringify(reportsHistory));
                
                showError('Erro de conex√£o. Reporte salvo localmente. Tente novamente mais tarde.');
                document.getElementById('submitReport').disabled = false;
                document.getElementById('submitText').textContent = 'Enviar Reporte';
                document.getElementById('submitLoading').style.display = 'none';
            }
        }
    }
    
    async function sendToGoogleSheets(reportData) {
        const formData = new FormData();
        
        Object.keys(reportData).forEach(key => {
            formData.append(key, reportData[key]);
        });
        
        const response = await fetch(API_URL, {
            method: 'POST',
            body: formData,
            mode: 'no-cors'
        });
        
        return { success: true, message: 'Enviado com sucesso' };
    }
    
    function sendReportByEmailFallback(reportData) {
        try {
            const subject = `[REPORTE] ${reportData.materia} - Quest√£o #${reportData.questionIndex}`;
            
            let body = `NOVO REPORTE DE QUEST√ÉO\n`;
            body += `=======================\n\n`;
            body += `MAT√âRIA: ${reportData.materia}\n`;
            body += `ID DO QUIZ: ${reportData.quizId}\n`;
            body += `QUEST√ÉO #${reportData.questionIndex}\n`;
            body += `√çNDICE ORIGINAL: ${reportData.originalIndex}\n\n`;
            body += `ENUNCIADO:\n${reportData.questionText}\n\n`;
            body += `TIPO DE PROBLEMA: ${reportData.reportLabel}\n\n`;
            body += `RESPOSTA DO USU√ÅRIO: ${reportData.userAnswer}\n`;
            body += `RESPOSTA CORRETA: ${reportData.correctAnswer}\n\n`;
            
            body += `INFORMA√á√ïES DO USU√ÅRIO:\n`;
            body += `Nome: ${reportData.userName}\n`;
            body += `E-mail: ${reportData.userEmail}\n`;
            body += `Institui√ß√£o/Curso: ${reportData.userInfo || 'N√£o informado'}\n\n`;
            
            if (reportData.details) {
                body += `DETALHES ADICIONAIS:\n${reportData.details}\n\n`;
            }
            
            body += `DATA/HORA: ${reportData.timestamp}\n`;
            body += `URL DA P√ÅGINA: ${reportData.url}\n`;
            
            const encodedSubject = encodeURIComponent(subject);
            const encodedBody = encodeURIComponent(body);
            
            const mailtoLink = `mailto:${EMAIL_DESTINO}?subject=${encodedSubject}&body=${encodedBody}`;
            
            window.open(mailtoLink, '_blank');
            return true;
        } catch (error) {
            console.error('Erro ao enviar email:', error);
            return false;
        }
    }
    
    // ============================================
    // INICIALIZA√á√ÉO
    // ============================================
    
    function hasUnsavedProgress() {
        const answeredCount = getAnsweredCount();
        return answeredCount > 0 && answeredCount < currentQuestions.length;
    }
    
    function showCloseWarning(event) {
        if (hasUnsavedProgress()) {
            const message = '‚ö†Ô∏è ATEN√á√ÉO!\n\nVoc√™ tem um simulado em andamento.\nSe sair agora, todo o seu progresso ser√° perdido!\n\nTem certeza que deseja sair?';
            
            if (event) {
                event.preventDefault();
                event.returnValue = message;
            }
            
            return message;
        }
    }
    
    document.addEventListener('keydown', (e) => {
        if (e.key === 'ArrowRight' || e.key === ' ') nextQuestion();
        if (e.key === 'ArrowLeft') prevQuestion();
    });
    
    window.addEventListener('beforeunload', function(event) {
        if (hasUnsavedProgress()) {
            try {
                saveCurrentSessionState();
            } catch (e) {
                console.error('Erro ao salvar estado antes de sair:', e);
            }
            
            return showCloseWarning(event);
        }
    });
    
    window.onload = function() {
        initQuiz();
        initReportSystem();
    };
</script>

</body>
</html>
