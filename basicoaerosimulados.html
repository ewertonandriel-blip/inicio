<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BASICO AEROSIMULADOS</title>
    <style>
        :root {
            --primary: #1a3a5a;
            --accent: #007bff;
            --success: #28a745;
            --danger: #dc3545;
            --warning: #ffc107;
            --info: #17a2b8;
            --purple: #6f42c1;
        }

        * {
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
            background-color: #f5f7fa;
            margin: 0;
            padding: 4px;
            font-size: 13px;
            line-height: 1.3;
        }

        .container {
            max-width: 100%;
            background: white;
            padding: 6px;
            border-radius: 4px;
            box-shadow: 0 1px 2px rgba(0,0,0,0.1);
            position: relative;
            margin: 0 auto;
        }

        .credits-integrated {
            position: absolute;
            top: 2px;
            right: 6px;
            background: var(--primary);
            color: white;
            padding: 1px 3px;
            font-size: 0.5rem;
            font-weight: bold;
            border-radius: 1px;
            z-index: 10;
        }

        /* CABE√áALHO SUPER COMPACTO */
        .header-mini {
            position: sticky;
            top: 0;
            background: white;
            padding-bottom: 4px;
            border-bottom: 1px solid var(--primary);
            z-index: 5;
            margin-bottom: 6px;
            padding-top: 16px;
        }

        .header-mini-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 4px;
        }

        .page-title-mini {
            margin: 0;
            color: var(--primary);
            font-size: 0.85rem;
            font-weight: bold;
            line-height: 1.1;
            max-width: 65%;
        }

        .timer-compact {
            background: #f8f9fa;
            color: var(--primary);
            padding: 2px 4px;
            border-radius: 2px;
            font-size: 0.75rem;
            font-weight: bold;
            border: 1px solid #dee2e6;
            min-width: 40px;
            text-align: center;
        }

        .timer-warning {
            background: #fff5f5 !important;
            color: var(--danger) !important;
            border-color: var(--danger) !important;
        }

        /* INFO DO SIMULADO MAIS COMPACTA */
        .simulado-info {
            background: #e7f3ff;
            border: 1px solid var(--accent);
            border-radius: 3px;
            padding: 4px 5px;
            margin-bottom: 5px;
            font-size: 0.65rem;
            color: var(--primary);
            display: none;
        }

        .simulado-stats {
            display: flex;
            justify-content: space-between;
            margin-top: 2px;
            font-weight: 600;
        }

        /* CONTROLES DE HIST√ìRICO COMPACTOS */
        .history-controls {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 4px;
            margin-top: 4px;
        }

        .history-controls button {
            padding: 2px 4px;
            font-size: 0.6rem;
            border-radius: 2px;
            border: none;
            cursor: pointer;
            font-weight: 600;
            text-align: center;
        }

        .clear-history-btn {
            background: var(--warning);
            color: #856404;
            border: 1px solid #ffc107;
        }

        .info-history-btn {
            background: #6c757d;
            color: white;
        }

        /* INFO B√ÅSICA SUPER COMPACTA */
        .quiz-info-mini {
            background: #f8f9fa;
            border-radius: 3px;
            padding: 5px 6px;
            border: 1px solid #dee2e6;
            margin-bottom: 4px;
        }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 4px;
            margin-bottom: 4px;
        }

        .info-item {
            text-align: center;
        }

        .info-label {
            font-size: 0.55rem;
            color: #6c757d;
            font-weight: 600;
            text-transform: uppercase;
            margin-bottom: 0;
        }

        .info-value {
            font-size: 0.75rem;
            font-weight: 700;
            color: var(--primary);
        }

        /* CONTROLES COMPACTOS */
        .controls-compact {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 4px;
        }

        .auto-nav-toggle {
            display: flex;
            align-items: center;
            gap: 3px;
            padding: 2px 4px;
            background: #e9ecef;
            border-radius: 2px;
            cursor: pointer;
            font-size: 0.65rem;
        }

        .auto-nav-checkbox {
            transform: scale(0.8);
            accent-color: var(--primary);
        }

        .auto-nav-label {
            font-weight: 600;
            color: var(--primary);
            white-space: nowrap;
        }

        .reset-btn-mini {
            background: #6c757d;
            color: white;
            border: none;
            border-radius: 2px;
            padding: 2px 4px;
            font-size: 0.65rem;
            font-weight: 600;
            cursor: pointer;
            text-align: center;
        }

        /* STATUS COMPACTO */
        .completion-status {
            background: #f8f9fa;
            border-radius: 3px;
            padding: 4px 5px;
            margin: 5px 0;
            border: 1px solid #dee2e6;
        }

        .status-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2px;
        }

        .status-text {
            font-size: 0.65rem;
            font-weight: 600;
        }

        .status-count {
            font-size: 0.65rem;
            font-weight: bold;
            color: var(--primary);
        }

        /* PENDENTES SUPER COMPACTOS */
        .pending-compact {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 2px;
            padding: 2px 3px;
            font-size: 0.6rem;
        }

        .pending-summary {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1px;
        }

        .pending-count {
            font-weight: bold;
            color: #856404;
            font-size: 0.65rem;
        }

        .pending-list-compact {
            display: flex;
            flex-wrap: wrap;
            gap: 2px;
            max-height: 18px;
            overflow-y: auto;
            padding: 1px 0;
        }

        .pending-number {
            background: #ffc107;
            color: #856404;
            font-weight: bold;
            padding: 0 2px;
            border-radius: 1px;
            font-size: 0.55rem;
            min-width: 12px;
            text-align: center;
            line-height: 1.2;
        }

        .pending-number.answered {
            background: #28a745;
            color: white;
            opacity: 0.5;
        }

        /* QUEST√ïES COMPACTAS */
        .question-block-mini {
            margin: 6px 0;
            padding: 8px;
            border: 1px solid #e0e0e0;
            border-radius: 3px;
            background: #fff;
            position: relative;
        }

        .question-text-mini {
            font-size: 0.8rem;
            font-weight: bold;
            margin-bottom: 6px;
            color: var(--primary);
            line-height: 1.2;
        }

        .options-mini {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .option-mini {
            padding: 5px 6px;
            border: 1px solid #eee;
            border-radius: 2px;
            cursor: pointer;
            display: flex;
            align-items: center;
            font-size: 0.75rem;
            min-height: 28px;
            position: relative;
        }

        input[type="radio"] {
            margin-right: 4px;
            transform: scale(0.8);
            accent-color: var(--primary);
        }

        .correct-answer {
            background-color: #d4edda !important;
            border-color: #28a745 !important;
            color: #155724;
        }

        .wrong-answer {
            background-color: #f8d7da !important;
            border-color: #dc3545 !important;
            color: #721c24;
        }

        /* BOT√ÉO DE REPORTAR NAS QUEST√ïES */
        .report-btn {
            background: transparent;
            color: #6c757d;
            border: 1px solid #dee2e6;
            border-radius: 2px;
            padding: 2px 6px;
            font-size: 0.55rem;
            cursor: pointer;
            margin-top: 4px;
            display: flex;
            align-items: center;
            gap: 3px;
            transition: all 0.2s;
        }

        .report-btn:hover {
            background: #f8f9fa;
            color: var(--danger);
            border-color: var(--danger);
        }

        /* BOT√ÉO DE REPORTAR NO GABARITO (canto superior direito) */
        .report-gabarito-btn {
            position: absolute;
            top: 8px;
            right: 8px;
            background: transparent;
            color: #6c757d;
            border: 1px solid #dee2e6;
            border-radius: 2px;
            padding: 1px 4px;
            font-size: 0.5rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 2px;
            transition: all 0.2s;
            z-index: 2;
        }

        .report-gabarito-btn:hover {
            background: #f8f9fa;
            color: var(--danger);
            border-color: var(--danger);
        }

        /* BOT√ïES DE NAVEGA√á√ÉO COMPACTOS */
        .nav-buttons {
            display: flex;
            gap: 4px;
            margin: 8px 0;
        }

        .nav-btn {
            flex: 1;
            padding: 6px 4px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 2px;
            font-weight: 600;
            font-size: 0.75rem;
            cursor: pointer;
            text-align: center;
            min-height: 32px;
        }

        .nav-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            opacity: 0.5;
        }

        /* BOT√ïES PRINCIPAIS COMPACTOS */
        .btn {
            padding: 8px;
            font-size: 0.8rem;
            font-weight: bold;
            border: none;
            border-radius: 3px;
            cursor: pointer;
            width: 100%;
            margin-top: 8px;
            min-height: 36px;
        }

        .btn-finish {
            background: var(--primary);
            color: white;
        }

        .btn-finish:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .btn-restart {
            background: var(--success);
            color: white;
            display: none;
        }

        .btn-restart-success {
            background: linear-gradient(135deg, var(--success), #1e7e34);
            color: white;
            display: none;
        }

        /* BOT√ÉO VOLTAR AO IN√çCIO */
        .btn-voltar-inicio {
            background: linear-gradient(135deg, var(--accent), #0056b3);
            color: white;
            border: none;
            display: none;
        }

        /* BOT√ÉO CONTINUAR BANCO */
        .btn-continuar-banco {
            background: linear-gradient(135deg, var(--info), #138496);
            color: white;
            border: none;
            display: none;
        }

        /* BOT√ÉO DE SIMULADO DE REFOR√áO */
        .btn-reforco {
            background: linear-gradient(135deg, var(--danger), #c82333);
            color: white;
            border: none;
            display: none;
        }

        /* BOT√ÉO DE REINICIAR BANCO */
        .btn-reiniciar-banco {
            background: linear-gradient(135deg, var(--purple), #5a32a3);
            color: white;
            border: none;
            display: none;
        }

        /* BOT√ÉO DE NOVO SIMULADO NO REFOR√áO */
        .btn-novo-simulado-reforco {
            background: linear-gradient(135deg, var(--warning), #e0a800);
            color: #856404;
            border: none;
            display: none;
        }

        /* RESULTADOS COMPACTOS */
        #results {
            display: none;
            padding: 10px;
            text-align: center;
            border: 1px solid var(--primary);
            margin: 8px 0;
            border-radius: 3px;
            background: #f8f9fa;
        }

        .result-title {
            font-size: 0.9rem;
            font-weight: bold;
            margin-bottom: 4px;
            color: var(--primary);
        }

        .score-mini {
            font-size: 1.1rem;
            margin: 4px 0;
            font-weight: 800;
            color: var(--primary);
        }

        /* MENSAGEM DE MOTIVA√á√ÉO */
        .motivation-message {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 3px;
            padding: 8px 10px;
            margin: 8px 0;
            font-size: 0.7rem;
            color: #856404;
            text-align: center;
        }

        .motivation-success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
        }

        .motivation-warning {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            color: #856404;
        }

        .motivation-danger {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
        }

        /* MODAL DE REPORTE - ATUALIZADO */
        .report-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .report-content {
            background: white;
            padding: 20px;
            border-radius: 8px;
            width: 95%;
            max-width: 500px;
            max-height: 85vh;
            overflow-y: auto;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .report-title {
            font-size: 1rem;
            font-weight: bold;
            color: var(--primary);
            margin-bottom: 15px;
            text-align: center;
            border-bottom: 2px solid var(--primary);
            padding-bottom: 10px;
        }

        .report-question-info {
            background: #f8f9fa;
            border-radius: 5px;
            padding: 10px;
            margin-bottom: 15px;
            border-left: 4px solid var(--accent);
        }

        .report-section {
            margin-bottom: 15px;
        }

        .report-section-title {
            font-size: 0.8rem;
            font-weight: bold;
            color: var(--primary);
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .report-options {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin: 10px 0;
        }

        .report-option {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .report-option:hover {
            background: #f8f9fa;
            border-color: var(--accent);
        }

        .report-option input[type="radio"] {
            margin: 0;
            transform: scale(0.9);
        }

        .report-option label {
            font-size: 0.75rem;
            cursor: pointer;
            flex: 1;
        }

        /* FORMUL√ÅRIO DE IDENTIFICA√á√ÉO */
        .user-info-form {
            background: #f0f8ff;
            border-radius: 5px;
            padding: 15px;
            margin: 15px 0;
            border: 1px solid #cce5ff;
        }

        .form-group {
            margin-bottom: 12px;
        }

        .form-label {
            display: block;
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 4px;
        }

        .form-input {
            width: 100%;
            padding: 8px 10px;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            font-size: 0.8rem;
            font-family: inherit;
            transition: border-color 0.2s;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 2px rgba(0,123,255,0.1);
        }

        .form-input.error {
            border-color: var(--danger);
            background-color: #fff5f5;
        }

        .form-hint {
            font-size: 0.65rem;
            color: #6c757d;
            margin-top: 4px;
            display: block;
        }

        .required-star {
            color: var(--danger);
            font-weight: bold;
        }

        .report-textarea {
            width: 100%;
            min-height: 80px;
            padding: 10px;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            font-size: 0.8rem;
            resize: vertical;
            font-family: inherit;
            transition: border-color 0.2s;
        }

        .report-textarea:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 2px rgba(0,123,255,0.1);
        }

        .report-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .report-submit {
            flex: 2;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 4px;
            padding: 12px;
            font-size: 0.85rem;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .report-submit:hover {
            background: #0d2c4a;
        }

        .report-submit:disabled {
            background: #6c757d;
            cursor: not-allowed;
            opacity: 0.7;
        }

        .report-cancel {
            flex: 1;
            background: #6c757d;
            color: white;
            border: none;
            border-radius: 4px;
            padding: 12px;
            font-size: 0.85rem;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .report-cancel:hover {
            background: #545b62;
        }

        .report-success {
            background: #d4edda;
            color: #155724;
            padding: 12px;
            border-radius: 5px;
            font-size: 0.8rem;
            text-align: center;
            margin-top: 15px;
            border: 1px solid #c3e6cb;
            display: none;
        }

        .report-error {
            background: #f8d7da;
            color: #721c24;
            padding: 10px;
            border-radius: 5px;
            font-size: 0.75rem;
            text-align: center;
            margin-top: 10px;
            border: 1px solid #f5c6cb;
            display: none;
        }

        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
            margin-right: 8px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* SCROLL PERSONALIZADO */
        .pending-list-compact::-webkit-scrollbar {
            height: 2px;
        }
        
        .pending-list-compact::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 1px;
        }
        
        .pending-list-compact::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 1px;
        }

        /* AJUSTES PARA TELAS MUITO PEQUENAS */
        @media (max-width: 320px) {
            body {
                padding: 2px;
                font-size: 12px;
            }
            
            .container {
                padding: 4px;
            }
            
            .page-title-mini {
                font-size: 0.75rem;
                max-width: 60%;
            }
            
            .timer-compact {
                font-size: 0.7rem;
                min-width: 35px;
                padding: 1px 3px;
            }
            
            .info-grid {
                gap: 3px;
            }
            
            .info-label {
                font-size: 0.5rem;
            }
            
            .info-value {
                font-size: 0.7rem;
            }
            
            .question-text-mini {
                font-size: 0.75rem;
            }
            
            .option-mini {
                padding: 4px 5px;
                font-size: 0.7rem;
                min-height: 26px;
            }
            
            .nav-btn, .btn {
                font-size: 0.7rem;
                padding: 5px 3px;
            }
            
            .pending-list-compact {
                max-height: 16px;
            }
            
            .pending-number {
                font-size: 0.5rem;
                min-width: 10px;
            }
            
            .report-gabarito-btn {
                font-size: 0.45rem;
                padding: 1px 3px;
            }
            
            .report-content {
                padding: 15px;
            }
            
            .report-buttons {
                flex-direction: column;
            }
        }

        @media (max-height: 600px) {
            .header-mini {
                padding-top: 10px;
            }
            
            .question-block-mini {
                margin: 4px 0;
                padding: 6px;
            }
            
            .nav-buttons {
                margin: 6px 0;
            }
            
            .btn {
                margin-top: 6px;
                min-height: 32px;
            }
        }
    </style>
</head>
<body>

<div class="container" id="main-container">
    <div class="credits-integrated">BY EWERTON</div>
    
    <div class="header-mini">
        <div class="header-mini-top">
            <h1 class="page-title-mini" id="page-title">Carregando...</h1>
            <div id="timer" class="timer-compact">00:00</div>
        </div>
        
        <div class="simulado-info" id="simulado-info">
            <div>Simulado: <span id="questions-per-simulado">20</span> quest√µes</div>
            <div class="simulado-stats">
                <span id="remaining-questions">Dispon√≠veis: 0</span>
                <span id="recent-used">Usadas: 0</span>
            </div>
            
            <div class="history-controls">
                <button class="clear-history-btn" onclick="clearHistory()">
                    üóëÔ∏è Limpar Hist√≥rico
                </button>
                <button class="info-history-btn" onclick="showHistoryInfo()">
                    ‚ÑπÔ∏è Info
                </button>
            </div>
        </div>
        
        <div class="quiz-info-mini">
            <div class="info-grid">
                <div class="info-item">
                    <div class="info-label">Quest√£o</div>
                    <div class="info-value" id="question-counter">0/0</div>
                </div>
                <div class="info-item">
                    <div class="info-label">Respondidas</div>
                    <div class="info-value" id="answered-counter">0/0</div>
                </div>
                <div class="info-item">
                    <div class="info-label">Progresso</div>
                    <div class="info-value" id="progress-percent">0%</div>
                </div>
            </div>
            
            <div class="controls-compact">
                <div class="auto-nav-toggle" onclick="toggleAutoNav()">
                    <input type="checkbox" id="auto-nav-checkbox" class="auto-nav-checkbox" checked>
                    <label class="auto-nav-label">Auto-navega√ß√£o</label>
                </div>
                <button class="reset-btn-mini" onclick="resetQuiz()">
                    ‚Üª Reiniciar
                </button>
            </div>
        </div>

        <div class="completion-status">
            <div class="status-header">
                <span class="status-text">Status:</span>
                <span class="status-count" id="status-count">0/0</span>
            </div>
            <div class="pending-compact" id="pending-questions">
                <div class="pending-summary">
                    <span>Pendentes:</span>
                    <span class="pending-count" id="pending-count">0</span>
                </div>
                <div class="pending-list-compact" id="pending-list">
                    <span style="color: #6c757d; font-style: italic;">Nenhuma pendente</span>
                </div>
            </div>
        </div>
    </div>

    <div id="results">
        <div class="result-title" id="feedback-msg"></div>
        <div class="score-mini" id="final-score"></div>
        <div id="final-percent" style="font-size: 0.8rem; font-weight: bold; margin-bottom: 6px; color: var(--accent);"></div>
        <div id="motivation-message" class="motivation-message"></div>
        <div id="simulado-summary" style="margin-bottom: 8px; font-size: 0.7rem; color: var(--primary);"></div>
        
        <button id="restart-btn" class="btn btn-restart" onclick="startNewQuiz()">üîÑ Refazer Simulado</button>
        <button id="voltar-inicio-btn" class="btn btn-voltar-inicio" onclick="voltarAoInicio()">
            üèÅ Voltar ao In√≠cio
        </button>
        <button id="continuar-banco-btn" class="btn btn-continuar-banco" onclick="continuarComBanco()">
            üìö Continuar com Banco
        </button>
        <button id="wrong-questions-btn" class="btn btn-reforco" onclick="startWrongQuestionsSimulado()">
            ‚ö° Simulado de Refor√ßo
        </button>
        <button id="reiniciar-banco-btn" class="btn btn-reiniciar-banco" onclick="reiniciarBancoCompleto()">
            üîÑ Reiniciar Banco Completo
        </button>
        <button id="new-simulado-btn" class="btn" style="background: var(--accent); color: white; margin-top: 4px; display: none;" onclick="generateNewSimulado()">üé≤ Novo Simulado</button>
        <!-- NOVO BOT√ÉO PARA SIMULADO DE REFOR√áO -->
        <button id="novo-simulado-reforco-btn" class="btn btn-novo-simulado-reforco" onclick="novoSimuladoAposReforco()">
            üéØ Novo Simulado
        </button>
    </div>

    <div id="quiz-content"></div>

    <div class="nav-buttons">
        <button id="prev-btn" class="nav-btn" onclick="prevQuestion()" disabled>
            ‚Üê Anterior
        </button>
        <button id="next-btn" class="nav-btn" onclick="nextQuestion()">
            Pr√≥ximo ‚Üí
        </button>
    </div>

    <button id="finish-btn" class="btn btn-finish" onclick="finalizeQuiz()" disabled>
        üèÅ Finalizar
    </button>
</div>

<!-- MODAL DE REPORTE ATUALIZADO -->
<div id="reportModal" class="report-modal">
    <div class="report-content">
        <div class="report-title">üìù Reportar Quest√£o</div>
        
        <div class="report-question-info">
            <div><strong>Quest√£o #<span id="reportQuestionNumber">1</span></strong></div>
            <div id="reportQuestionText" style="font-size: 0.75rem; margin-top: 5px;">Carregando...</div>
        </div>
        
        <!-- SE√á√ÉO: TIPO DE PROBLEMA -->
        <div class="report-section">
            <div class="report-section-title">üìå Tipo de Problema</div>
            <div class="report-options">
                <div class="report-option">
                    <input type="radio" id="reportError" name="reportType" value="error">
                    <label for="reportError">‚ùå Quest√£o com erro</label>
                </div>
                <div class="report-option">
                    <input type="radio" id="reportWrongAnswer" name="reportType" value="wrong_answer">
                    <label for="reportWrongAnswer">‚ö†Ô∏è Resposta incorreta</label>
                </div>
                <div class="report-option">
                    <input type="radio" id="reportConfusing" name="reportType" value="confusing">
                    <label for="reportConfusing">ü§î Enunciado confuso</label>
                </div>
                <div class="report-option">
                    <input type="radio" id="reportAlternative" name="reportType" value="alternative">
                    <label for="reportAlternative">üî§ Alternativas erradas</label>
                </div>
                <div class="report-option">
                    <input type="radio" id="reportOther" name="reportType" value="other">
                    <label for="reportOther">üìù Outro problema</label>
                </div>
            </div>
        </div>
        
        <!-- SE√á√ÉO: SUA IDENTIFICA√á√ÉO -->
        <div class="report-section">
            <div class="report-section-title">üë§ Sua Identifica√ß√£o <span class="required-star">*</span></div>
            <div class="user-info-form">
                <div class="form-group">
                    <label class="form-label" for="userName">Nome Completo <span class="required-star">*</span></label>
                    <input type="text" id="userName" class="form-input" placeholder="Digite seu nome completo" maxlength="100">
                    <span class="form-hint">Para podermos entrar em contato com voc√™</span>
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="userEmail">E-mail <span class="required-star">*</span></label>
                    <input type="email" id="userEmail" class="form-input" placeholder="seu.email@exemplo.com" maxlength="100">
                    <span class="form-hint">Para enviarmos o feedback sobre sua solicita√ß√£o</span>
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="userInfo">Institui√ß√£o/Curso (opcional)</label>
                    <input type="text" id="userInfo" class="form-input" placeholder="Ex: SENAI, Engenharia Mec√¢nica" maxlength="100">
                    <span class="form-hint">Ajuda a identificar o contexto do reporte</span>
                </div>
            </div>
        </div>
        
        <!-- SE√á√ÉO: DETALHES -->
        <div class="report-section">
            <div class="report-section-title">üìã Detalhes do Problema</div>
            <textarea 
                id="reportDetails" 
                class="report-textarea" 
                placeholder="Descreva detalhadamente o problema encontrado na quest√£o. Se achar que h√° erro na resposta, explique sua justificativa..."
                maxlength="1000"
            ></textarea>
            <div class="form-hint" style="text-align: right;">
                <span id="charCount">0</span>/1000 caracteres
            </div>
        </div>
        
        <div id="reportErrorMsg" class="report-error"></div>
        
        <div class="report-buttons">
            <button id="cancelReport" class="report-cancel" onclick="closeReportModal()">Cancelar</button>
            <button id="submitReport" class="report-submit" onclick="submitReport()">
                <span id="submitText">Enviar Reporte</span>
                <span id="submitLoading" class="loading-spinner" style="display: none;"></span>
            </button>
        </div>
        
        <div id="reportSuccess" class="report-success">
            ‚úÖ Reporte enviado com sucesso! Obrigado pela contribui√ß√£o.<br>
            <small>Voc√™ receber√° um feedback por email em breve.</small>
        </div>
    </div>
</div>

<script>
    // ============================================
    // BANCO DE QUEST√ïES - ADICIONE AS SUAS AQUI
    // ============================================
    
    // FORMATO: {q: "Pergunta?", a: ["Op√ß√£o A", "Op√ß√£o B", "Op√ß√£o C", "Op√ß√£o D"], c: 0}
    // Onde 'c' √© o √≠ndice da resposta correta (0 = A, 1 = B, 2 = C, 3 = D)
    
 const masterBank = [

  {q: "A chave soquete √© feita em quantas partes?", a: ["6 partes.", "12 partes.", "2 partes.", "3 partes."], c: 2},
  {q: "Na an√°lise e pesquisa de pane em um circuito el√©trico, quando esse se encontra incompleto ou interrompido disse-se que o mesmo est√°:", a: ["Em curto.", "Neutro.", "Aberto.", "Fechado."], c: 2},
  {q: "Um dos metais amplamente usados na fabrica√ß√£o de chaves como chaves allen √© o?", a: ["A√ßo com alto teor de carbono.", "Alum√≠nio.", "A√ßo com baixo teor de carbono.", "A√ßo cromo-van√°dio."], c: 3},
  {q: "Havendo hip√≥xia an√≥xia em paciente consciente, o tratamento adequado ser√° a administra√ß√£o de?", a: ["Respira√ß√£o boca a boca.", "Estimulante card√≠aco.", "Vasodilatador.", "Oxig√™nio."], c: 3},
  {q: "Paqu√≠metro, micr√¥metro e rel√≥gio comparador s√£o ferramentas?", a: ["De torque.", "De indica√ß√£o.", "Comuns.", "De precis√£o."], c: 3},
  {q: "Uma bateria com capacidade de 120 amperes-hora, instalada em um sistema que requeira 20 amperes-hora, ir√° se descarregar completamente, ao final de?", a: ["60 minutos.", "6 minutos.", "400 minutos.", "360 minutos."], c: 3},
  {q: "Considerando um circuito el√©trico com duas resist√™ncias em s√©rie medindo 4 e 6 ohm e uma tens√£o total de 15 volt, a amperagem total do circuito ser√°?", a: ["1,5 Œë.", "5,0 A.", "2,5 A.", "25,0 A."], c: 0},
  {q: "A ferramenta \"martelo\", como se escreve em ingl√™s?", a: ["Hammer.", "Jack.", "Socket.", "Joint."], c: 0},
  {q: "Quantas posi√ß√µes de ajuste tem um alicate gasista?", a: ["12 posi√ß√µes.", "2 posi√ß√µes.", "5 posi√ß√µes.", "10 posi√ß√µes."], c: 2},
  {q: "A aeronave tem uma tend√™ncia de ganhar peso devido √† (ao)?", a: ["Ac√∫mulo de sujeiras e graxas.", "N√∫mero de passageiros.", "Poucas horas de voo.", "Forma aerodin√¢mica."], c: 0},
  {q: "A finalidade principal do controle do peso e balanceamento das aeronaves, √©?", a: ["O balanceamento.", "A seguran√ßa.", "O peso.", "Efici√™ncia durante o voo."], c: 1},
  {q: "O que √© investiga√ß√£o do fator humano?", a: ["√â a √°rea de abordagem da seguran√ßa de voo de manuten√ß√£o da aeronave.", "√â a √°rea de abordagem da seguran√ßa de voo que se refere ao complexo biol√≥gico do ser humano, nos aspectos fisiol√≥gicos e psicol√≥gicos que possam ter refletido nas a√ß√µes da tripula√ß√£o e demais pessoas envolvidas no acidente, servindo para clarificar a sequ√™ncia dos acontecimentos na ocorr√™ncia.", "√â a manuten√ß√£o da aeronave com abordagem da seguran√ßa de voo que se refere ao complexo biol√≥gico do ser humano, nos aspectos fisiol√≥gicos e psicol√≥gicos que possam ter refletido nas a√ß√µes da tripula√ß√£o e demais pessoas envolvidas no acidente, servindo para clarificar a sequ√™ncia dos acontecimentos na ocorr√™ncia.", "√â a pista de rolagem e abordagem da seguran√ßa de voo que se refere ao complexo biol√≥gico do ser humano, nos aspectos fisiol√≥gicos e psicol√≥gicos que possam ter refletido nas a√ß√µes da tripula√ß√£o e demais pessoas envolvidas no acidente, servindo para clarificar a sequ√™ncia dos acontecimentos na ocorr√™ncia."], c: 1},
  {q: "No sistema de comando o cabo de especifica√ß√£o 7x19 √© feito com?", a: ["19mm de di√¢metro e 7 m de comprimento.", "19 pernas de 7 fios.", "7mm de di√¢metro e 19 m de comprimento.", "7 pernas de 19 fios."], c: 3},
  {q: "A superf√≠cie de comando prim√°ria articulada ao bordo de fuga das asas √© o?", a: ["Aileron.", "Profundor.", "Leme de dire√ß√£o.", "Compensador."], c: 0},
  {q: "R√©gua √© um instrumento utilizado em geometria, pr√≥prio para tra√ßar segmentos de retas e medir dist√¢ncias pequenas, normalmente √© composta por uma l√¢mina de madeira, pl√°stico ou metal e pode conter uma escala geralmente graduada em?", a: ["Mil√≠metro e graus.", "Metro e cent√≠metro.", "√Çngulos e cent√≠metro.", "Centim√©trica e milim√©trica."], c: 3},
  {q: "Na maioria das regi√µes do Brasil, os telefones de emerg√™ncia s√£o?", a: ["Bombeiros 190; SAMU 191; e pol√≠cia militar 192.", "Bombeiros 163; SAMU 182; e pol√≠cia militar 191.", "Bombeiros 193; SAMU 192; e pol√≠cia militar 190.", "Bombeiros 911; SAMU 156; e pol√≠cia militar 190."], c: 2},
  {q: "After tightening a nut, it must be locked with?", a: ["Hoses.", "Rivets.", "Cotter pins or safety wire.", "Drill."], c: 2},
  {q: "Em rela√ß√£o a les√µes, qual a defini√ß√£o de fratura?", a: ["Entende-se por fratura a ruptura total ou parcial do tecido √≥sseo, podendo ser classificada em fechada ou aberta (exposta).", "Entende-se por fratura a ruptura total ou parcial do tecido √≥sseo, podendo ser classificada em apenas fechada.", "Entende-se por fratura a ruptura total ou parcial do tecido √≥sseo, podendo ser classificada em apenas por arranh√µes.", "Entende-se por fratura a ruptura total ou parcial do tecido √≥sseo, podendo ser classificada em apenas aberta."], c: 0},
  {q: "√â sabido que, quanto maior a envergadura da asa quando comparada com a corda, maior √© a sustenta√ß√£o obtida, essa compara√ß√£o √© chamada de?", a: ["Asa.", "Espessura.", "Enflechamento.", "Alongamento."], c: 3},
  {q: "A for√ßa de sustenta√ß√£o sempre age?", a: ["Na dire√ß√£o da for√ßa resultante.", "Perpendicularmente ao vento relativo.", "Perpendicularmente ao √¢ngulo de ataque.", "Na dire√ß√£o oposta √† for√ßa resultante."], c: 1},
  {q: "O sistema de numera√ß√£o universal, d√° os meios de identifica√ß√£o de desenhos do tamanho?", a: ["Grande.", "Pequeno.", "Padr√£o.", "M√©dio."], c: 2},
  {q: "A ANAC dever√° elaborar um plano para comunica√ß√£o e dissemina√ß√£o do programa de seguran√ßa operacional espec√≠fico (PSOE). Essas a√ß√µes de comunica√ß√£o e dissemina√ß√£o \"n√£o\" tem como objetivo:", a: ["Cultura de seguran√ßa operacional, seu desenvolvimento e aprimoramento.", "Crit√©rios recomendados para responsabiliza√ß√£o da equipe em prol da seguran√ßa operacional.", "Dissemina√ß√£o de boas pr√°ticas de seguran√ßa operacional.", "Conscientiza√ß√£o das responsabilidades individuais em rela√ß√£o a seguran√ßa operacional."], c: 1},
  {q: "As linhas de tubula√ß√µes de aeronave usualmente s√£o feitas de tubos de metal, as tubula√ß√µes de metal s√£o medidas pelo?", a: ["Comprimento.", "Raio interno.", "Di√¢metro interno.", "Di√¢metro externo."], c: 3},
  {q: "A parte de uma broca que fixa-se ao mandril de uma m√°quina de furar √© o(a)?", a: ["Corpo.", "Punho.", "Espiga.", "Haste."], c: 3},
  {q: "√â assegurado ao aerovi√°rio uma folga semanal remunerada de quantas horas?", a: ["24 (vinte e quatro) horas cont√≠nuas de prefer√™ncia aos domingos.", "72 (setenta e duas) horas cont√≠nuas de prefer√™ncia aos finais de semana.", "48 (quarenta e oito) horas cont√≠nuas.", "12 (doze) horas cont√≠nuas de prefer√™ncia aos s√°bados."], c: 0},
  {q: "Desenhos de grande tamanho podem ser reproduzidos em moldes individuais ou em?", a: ["Corqui.", "Em papel carbono.", "Slide.", "Spoiler."], c: 2},
  {q: "O tipo de pun√ß√£o utilizado para extrair parafusos que algumas vezes ficam presos em orif√≠cios, √© o?", a: ["De bico.", "Tocapinos.", "Vazador.", "De centro."], c: 1},
  {q: "A borracha natural √© usada como material selante para?", a: ["√Ågua e sistema de metanol.", "√ìleos vegetais e solventes.", "Isolar equipamentos el√©tricos e eletr√¥nicos.", "Solventes e sistemas de combust√≠vel."], c: 0},
  {q: "No desenho t√©cnico de esquema el√©trico, como √© representado o s√≠mbolo de um amper√≠metro?", a: ["Um tra√ßo com um c√≠rculo no meio destacando a letra \"V\".", "Um tra√ßo com um c√≠rculo no meio destacando a letra \"P\".", "Um tra√ßo com um c√≠rculo no meio destacando a letra \"A\".", "Um tra√ßo com um c√≠rculo no meio destacando a letra \"B\"."], c: 2},
  {q: "No sistema hidr√°ulico de alta press√£o para opera√ß√£o do trem de pouso, flapes e linhas externas de freio, utilizam tubula√ß√µes feitas de?", a: ["Teflon.", "Liga de alum√≠nio 2024-T.", "Neoprene.", "A√ßo resistente √† corros√£o."], c: 3},
  {q: "O controle do rotor de cauda de um helic√≥ptero √© comandado pelo?", a: ["Manche.", "C√≠clico.", "Pedais.", "Coletivo."], c: 2},
  {q: "Eletricidade est√°tica pode ser produzida por?", a: ["Contato, fric√ß√£o ou indu√ß√£o.", "Contabando, flex√£o e indu√ß√£o.", "Rel√© do alternador.", "Pot√™ncia."], c: 0},
  {q: "O dispositivo de seguran√ßa satisfat√≥rio para travar dois ou mais parafusos, de forma que qualquer tend√™ncia de afrouxar um deles seja anulada pelo aperto de um outro, √© o(a)?", a: ["Pino.", "Frenagem com arame.", "Contra-pino.", "Arruela especial."], c: 1},
  {q: "Num circuito el√©trico com 4 baterias ligadas em s√©rie, medindo 1,5 volts cada, a tens√£o total √© de?", a: ["4,5 volts.", "6,0 volts.", "1,5 volts.", "3,0 volts."], c: 1},
  {q: "Assinale a alternativa que indica o significado do primeiro e do segundo n√∫mero no combust√≠vel de grau 100/130?", a: ["100% de grau de pureza, e 130% de heptana normal.", "O grau 100 para a mistura pobre, e o grau 130 para a mistura rica.", "100% de grau de pureza, e 130% de pot√™ncia efetiva.", "O grau 100 para a mistura rica, e o grau 130 para a mistura pobre."], c: 1},
  {q: "Quais s√£o as atribui√ß√µes do CENIPA?", a: ["Desorganizar, planejar, gerenciar, controlar as atividades relacionadas com a preven√ß√£o e investiga√ß√£o de acidentes aeron√°uticos.", "Planejar, gerenciar, controlar as atividades relacionadas com a preven√ß√£o e investiga√ß√£o de acidentes na esta√ß√£o brasileira e na nasa.", "Gerenciar a for√ßa a√©rea brasileira e a anac.", "Planejar, gerenciar, controlar as atividades relacionadas com a preven√ß√£o e investiga√ß√£o de acidentes aeron√°uticos."], c: 3},
  {q: "Se numa chave combinada a extremidade colar mede 1/4 da polegada, logo a extremidade em boca medir√°:", a: ["1/4 da polegada.", "1/2 da polegada.", "1/8 da polegada.", "5/16 da polegada."], c: 0},
  {q: "Hemorragias s√£o classificadas como?", a: ["Externa, internalto, venosa e labial.", "Esponsola, externa, inteira, venosa e arterial.", "Externa, interna, sistema dos dentes de ouro.", "Externa, interna, venosa e arterial."], c: 3},
  {q: "A gasolina de avia√ß√£o de grau 91/96 e a e grau 100/130, possuem respectivamente, a colora√ß√£o?", a: ["Incolor e azul.", "P√∫rpura e verde.", "Vermelha e azul.", "Azul e verde."], c: 3},
  {q: "Qual tesoura que √© designada especialmente para cortar ligas de alum√≠nio tratadas a quente e a√ßo inoxid√°vel?", a: ["Tesouras retas.", "Tesouras bico curvo.", "Tesouras de avia√ß√£o.", "Tesoura bico de fal√ß√£o."], c: 2},
  {q: "Os alicates de bico chato, s√£o mais adequados para fazer?", a: ["Flange.", "Torque.", "Corte.", "Decapagem."], c: 0},
  {q: "√â a descri√ß√£o de uma pe√ßa simples, dada de forma a descrever atrav√©s de linhas, notas, s√≠mbolos, especifica√ß√µes como tamanho, material e m√©todo de manufatura, que devem ser usados para fazer a pe√ßas:", a: ["Descreve atrav√©s do desenho de detalhes.", "Descreve atrav√©s do desenho de conjunto.", "Descreve atrav√©s do desenho pictorial.", "Descreve atrav√©s do desenho alternativo."], c: 0},
  {q: "No sistema de combust√≠vel, o componente respons√°vel pela distribui√ß√£o, denomina-se?", a: ["Carburador.", "Bomba principal.", "Tanque.", "V√°lvula seletora."], c: 3},
  {q: "Chave que tem seu crescimento de 1/64\" a 1/64\" de chave para chave da menor para maior, tem seu formato hexagonal, que se encaixa na cabe√ßa dos parafusos sem cabe√ßa:", a: ["Soquetes.", "Boca.", "Cachimbo ou allen.", "Colar."], c: 2},
  {q: "No transformador, aumentando-se o n√∫mero de espiras do enrolamento secund√°rio, em rela√ß√£o ao prim√°rio, a tens√£o de sa√≠da gerada ser√°?", a: ["A mesma.", "Menor.", "Nula.", "Maior."], c: 3},
  {q: "O desmaio √© uma perda transit√≥ria de?", a: ["O desmaio √© uma perda transit√≥ria de consci√™ncia e, normalmente, n√£o constituem uma situa√ß√£o que pode ser considerada uma amea√ßa √† vida. Geralmente, as consequ√™ncias do desmaio s√£o les√µes decorrentes da queda, portanto, ao perceber que uma pessoa ir√° desmaiar, √© importante coloc√°-la em um local em que n√£o haver√° riscos.", "O desmaio √© uma perda transit√≥ria da dire√ß√£o da aeronave e normalmente, n√£o constituem uma situa√ß√£o que pode ser considerada uma amea√ßa √† vida. Geralmente, as consequ√™ncias do desmaio s√£o les√µes decorrentes da queda, portanto, ao perceber que uma pessoa ir√° desmaiar, √© importante coloc√°-la em um local em que n√£o haver√° riscos.", "O desmaio √© uma perda transit√≥ria de transpar√™ncia na programa√ß√£o di√°ria, normalmente, n√£o constituem uma situa√ß√£o que pode ser considerada uma amea√ßa √† vida. Geralmente, as consequ√™ncias do desmaio s√£o les√µes decorrentes da queda, portanto, ao perceber que uma pessoa ir√° desmaiar, √© importante coloc√°-la em um local em que n√£o haver√° riscos.", "O desmaio √© uma perda transit√≥ria de paci√™ncia de voar e, normalmente, n√£o constituem uma situa√ß√£o que pode ser considerada uma amea√ßa √† vida. Geralmente, as consequ√™ncias do desmaio s√£o les√µes decorrentes da queda, portanto, ao perceber que uma pessoa ir√° desmaiar, √© importante coloc√°-la em um local em que n√£o haver√° riscos."], c: 0},
  {q: "Dentre as ferramentas abaixo, aquela que √© utilizada em trabalho de a√ß√£o r√°pida √© o(a)?", a: ["Chave de fenda de catraca.", "Alicate gasista.", "Alicate universal.", "Chave de fenda em \"Z\"."], c: 0},
  {q: "Entre os tr√™s eixos imagin√°rios que cruzam a aeronave, identifique qual deles √© refer√™ncia no movimento de guinada:", a: ["Lateral.", "Longitudinal.", "Vertical.", "Transversal."], c: 2},
  {q: "No caso do combust√≠vel estar contaminado, as impurezas depositar-se-√£o no elemento filtrante. Assim sendo, a by pass se abrir√° devido a press√£o no sistema ter:", a: ["Aumentado.", "Diminu√≠do.", "Permane", "Tornando-se nula."], c: 0},
  {q: "Quanto a instala√ß√£o da fia√ß√£o el√©trica, √© correto afirmar que?", a: ["Um fio com isolamento de baixa temperatura pode substituir outro, que tenha isolamento para alta temperatura.", "Na instala√ß√£o paralela, em pontos pr√≥ximos das tubula√ß√µes de combust√≠vel, a fia√ß√£o deve ficar abaixo das citadas tubula√ß√µes.", "O fio nunca deve passar por baixo da bateria do avi√£o.", "Os fios paralelos, em qualquer hip√≥tese, n√£o podem ser tran√ßados."], c: 2},
  {q: "Num circuito el√©trico de tr√™s resist√™ncias em s√©rie, a resist√™ncia total √© representada pelo(a)?", a: ["Produto das tr√™s resist√™ncias, dividido por tr√™s.", "Produto das tr√™s resist√™ncias.", "Soma das tr√™s resist√™ncias, dividida por tr√™s.", "Soma das tr√™s resist√™ncias."], c: 3},
  {q: "O magnetismo produzido por uma corrente el√©trica √© chamado de?", a: ["Retentividade.", "Auto-indu√ß√£o.", "Indu√ß√£o m√∫tua.", "Eletromagnetismo."], c: 3},
  {q: "Identifique as partes m√≥veis do micr√¥metro:", a: ["Tarraxa e tambor.", "Encosto e arco.", "Arco e bainha.", "Tambor e haste."], c: 3},
  {q: "As 3 for√ßas mencionadas no texto abaixo s√£o: The flapping motion is the result of the constantly changing balance between lift, centrifugal, and inertial forces.", a: ["For√ßas de eleva√ß√£o, centr√≠fugas e inerciais", "For√ßas de eleva√ß√£o, sustenta√ß√£o e centr√≠fugas", "For√ßas centr√≠fugas, atmosf√©ricas e atmosf√©ricas", "For√ßas de sustenta√ß√£o, centr√≠fugas e eleva√ß√£o"], c: 0},
  {q: "As grandezas fundamentais em eletricidade s√£o a tens√£o el√©trica, a corrente el√©trica, a resist√™ncia el√©trica e a pot√™ncia el√©trica. Essas grandezas sempre est√£o presentes em qualquer circuito el√©trico e n√£o podem ser dissociadas. Dentre as alternativas, marque a resposta que n√£o faz parte das grandezas el√©tricas b√°sicas:", a: ["Volt.", "Dens√≠metro", "Ohm.", "Amp√©re."], c: 1},
  {q: "As r√©guas graduadas pelo sistema m√©trico tem como menor divis√£o:", a: ["Amper√≠metro digital.", "Metro.", "Mil√≠metro.", "Cent√≠metro."], c: 2},
  {q: "A forma de corros√£o que tem como caracter√≠stica apresentar uma profundidade sempre maior que o di√¢metro da base, denomina-se?", a: ["Transgranular.", "Intergranular.", "Violar.", "Pitting."], c: 3},
  {q: "Qual tipo de parafuso que √© usado somente onde ocorrem cargas de cisalhamento e nunca de tens√£o?", a: ["Parafuso franc√™s.", "Parafusos clevis.", "Parafusos torx.", "Parafusos screw bolt."], c: 1},
  {q: "Qual a defini√ß√£o de desenho t√©cnico de aeronave?", a: ["√â uma regra de importa√ß√£o de ideias que dizem respeito √† constru√ß√£o ou montagem de objetos.", "O m√©todo √© realizado com ajuda de computadores, notas, abrevia√ß√£o e montagem.", "√â um m√©todo de transposi√ß√£o de ideias que dizem respeito √† constru√ß√£o ou montagem de objetos. O m√©todo √© realizado com ajuda de linhas, notas, abrevia√ß√µes e s√≠mbolos.", "√â uma suposta transposi√ß√£o de ideias que dizem respeito √† constru√ß√£o ou montagem de objetos. O m√©todo √© realizado com ajuda de linhas, notas, abrevia√ß√µes e s√≠mbolos."], c: 2},
  {q: "Existem dois tipos de vistorias de seguran√ßa de voo, e as mesmas s√£o classificadas quanto √†s circunst√¢ncias em que s√£o realizadas, sendo elas?", a: ["Peri√≥dicas ou anuais.", "Peri√≥dicas ou casuais.", "Peri√≥dicas ou especiais.", "Peri√≥dicas ou semanais."], c: 2},
  {q: "A for√ßa necess√°ria para girar a h√©lice √© fornecida pelo (a)?", a: ["Motor.", "Bomba by pass.", "Compressor.", "Governador."], c: 0},
  {q: "Qual √© a parte do alicate, que entra em contato com o material a ser manuseado?", a: ["Aderentes.", "Raiz.", "Haste.", "Mordente."], c: 3},
  {q: "Numa bateria de chumbo-√°cida nova, totalmente carregada, o eletr√≥lito √© composto de, aproximadamente?", a: ["1% de √°cido e 99% de √°gua.", "50% de √°cido e 50% de √°gua.", "30% de √°cido e 70% de √°gua.", "10% de √°cido e 90% de √°gua."], c: 2},
  {q: "Conforme artigo 107 da lei 7565 de 19 de dezembro de 1986 do \"CBA\", no Brasil como s√£o classificadas as aeronaves?", a: ["Esportivas.", "Civis e militares.", "Turbo jato e convencionais.", "Aer√≥statos e aer√≥dinos."], c: 1},
  {q: "As l√¢minas de serra geralmente s√£o fabricadas em a√ßo?", a: ["De alto teor ou a√ßo tungst√™nio.", "Tungst√™nio ou alum√≠nio.", "Inoxid√°vel ou lat√£o.", "Cromo-vand√°dio ou alum√≠nio."], c: 0},
  {q: "Dentre os agentes extintores abaixo, indique qual agente extintor que jamais poder√° ser utilizado em locais incendiados contendo equipamentos energizados:", a: ["Espuma.", "P√≥ qu√≠mico especial.", "G√°s carb√¥nico.", "Hallon."], c: 0},
  {q: "Quantos e quais os movimentos existentes num rotor articulado?", a: ["Uma mudan√ßa de √¢ngulo das p√°s.", "Dois; mudan√ßa de √¢ngulo das p√°s e batimento(flaping).", "N√£o tem influ√™ncia alguma sobre o movimento do rotor.", "Tr√™s mudan√ßa de √¢ngulo das p√°s, batimento (flaping) e avan√ßo e recuo das p√°s."], c: 3},
  {q: "Determine a tens√£o de sa√≠da de um transformador cujo enrolamento prim√°rio, de 20 espiras, recebe 220V de tens√£o. Saiba que o enrolamento secund√°rio desse transformador √© formado por 10 espiras:", a: ["120 V.", "110 V.", "480 V.", "250 V."], c: 1},
  {q: "A bomba de combust√≠vel fornece mais combust√≠vel que o requerido pelo motor. O dispositivo que evita o excesso de press√£o de combust√≠vel na entrada do carburador √© denominado?", a: ["Dreno.", "V√°lvula de deriva√ß√£o.", "Suspiro.", "V√°lvula de al√≠vio."], c: 3},
  {q: "A propriedade que o combust√≠vel possui, que pode causar a forma√ß√£o do cal√ßo de vapor nas tubula√ß√µes, denomina-se?", a: ["Volatilidade.", "Poder calor√≠fico.", "Poder antidetonante.", "Viscosidade."], c: 0},
  {q: "As v√°lvulas de corte de combust√≠vel s√£o operadas?", a: ["Pneumaticamente.", "Eletricamente ou manualmente.", "Automaticamente.", "Pneumaticamente ou hidraulicamente."], c: 1},
  {q: "Ferramenta utilizada para executar furos √© o(a)?", a: ["Broca.", "Alargador.", "Cossinete.", "Riscador."], c: 0},
  {q: "O efeito fundamental que possibilita a produ√ß√£o de eletricidade por uma pilha prim√°ria √© a?", a: ["Absor√ß√£o de eletricidade est√°tica da atmosfera.", "A√ß√£o qu√≠mica entre o eletr√≥lito e as placas.", "A√ß√£o da luz ao incidir sobre os terminais.", "Repuls√£o entre cargas opostas nas duas placas."], c: 1},
  {q: "Qual tipo de queimadura que atinge a pele e apresenta bolhas?", a: ["Quarto grau.", "Segundo grau.", "Primeiro grau.", "Terceiro grau."], c: 1},
  {q: "Qual √© o nome do alicate especialmente empregado para trabalhos em porcas circulares serrilhadas dos conectores el√©tricos das aeronaves, fabricados com facilidade de regulagem com 5, 6 ou 7 posi√ß√µes?", a: ["Franc√™s.", "Press√£o.", "Bomba d'√°gua , bico de papagaio ou gasista.", "De freio."], c: 2},
  {q: "Com aumento da altitude, a press√£o atmosf√©rica?", a: ["Diminui.", "Permanece constante.", "Tende a se igualar √† do n√≠vel do mar.", "Aumenta."], c: 0},
  {q: "S√£o dispositivos de prote√ß√£o utilizados para proteger circuitos el√©tricos contra sobrecargas e curtos-circuitos:", a: ["Rel√©.", "Fus√≠vel.", "Protetor t√©rmico.", "Quebra-circuito."], c: 1},
  {q: "Qual a dist√¢ncia de seguran√ßa, que devemos utilizar como regra, para realizar cortes com a tesoura de avia√ß√£o, em rela√ß√£o a linha marcada na chapa?", a: ["Cortes dever√£o ser feitos a 1/32\" de polegada, afastado da linha marcada.", "Cortes dever√£o ser feitos a 5/32\" de polegada, afastado da linha marcada.", "Cortes dever√£o ser feitos a 11/32\" de polegada, afastado da linha marcada.", "Cortes dever√£o ser feitos a 1/64\" de polegada, afastado da linha marcada."], c: 0},
  {q: "Quanto ao conte√∫do do cba, o direito aeron√°utico √© regulamentado pelos?", a: ["Apenas por tratados e conven√ß√µes", "Tratados, conven√ß√µes e atos internacionais de que o Brasil seja parte, por este c√≥digo e pela legisla√ß√£o complementar.", "Conven√ß√µes.", "Tratados."], c: 1},
  {q: "Qual a chave de fenda que sua ponta encaixa e forma uma perfeita cruz na cabe√ßa do parafuso?", a: ["Reed and prince.", "Phillips.", "Catraca.", "Comum."], c: 0},
  {q: "Num jogo de ferramentas do tipo soquete, se uma das pe√ßas mede 9/16 da polegada, a pe√ßa imediatamente inferior mede:", a: ["5/8 da polegada.", "1/2 polegada.", "7/8 da polegada.", "7/16 da polegada."], c: 1},
  {q: "√â toda pessoa natural ou jur√≠dica a quem a anac tenhas outorgado o direito de administrar ou prestar servi√ßos em aer√≥dromo p√∫blico ou privado, pr√≥prio ou n√£o, com ou sem fins lucrativos:", a: ["Operador.", "Tripula√ß√£o.", "Sipaer.", "Anac."], c: 0},
  {q: "Diminuindo-se a tens√£o da fonte em um circuito em s√©rie, a?", a: ["Pot√™ncia total sofrer√° uma diminui√ß√£o.", "Corrente total n√£o sofrer√° altera√ß√£o.", "Pot√™ncia total permanecer√° a mesma.", "A coroa total n√£o altera."], c: 0},
  {q: "All crew has work with a lot of dedication: qual significado da palavra \"crew\" em portugu√™s?", a: ["Equipe.", "Turbul√™ncia.", "Lavat√≥rio.", "Assento."], c: 0},
  {q: "Quando em aeronaves for utilizado combust√≠vel armazenados em tambores ou lat√µes, deve-se ter o cuidado de?", a: ["Efetuar o perfeito aterramento e coloc√°-lo diretamente nos tanques.", "Checar a octanagem e coloc√°-lo diretamente nos tanques.", "Pass√°-lo em um funil de pl√°stico.", "Pass√°-lo em um funil-coador."], c: 3},
  {q: "Quanto a manuten√ß√£o de baterias de n√≠quel-c√°dmio √© correto afirmar?", a: ["Para estocagem e manuten√ß√£o das baterias de n√≠quel-c√°dmio e chumbo-√°cido pode-se usar a mesma √°rea.", "A carga pode ser realizada apenas pelo m√©todo da corrente constante.", "Para trabalhar em baterias √© necess√°rio usar √≥culos de prote√ß√£o, luvas e avental de borracha.", "O estado de carga da bateria √© determinado atrav√©s do dens√≠metro."], c: 2},
  {q: "Segundo a \"ICAO\" qual a defini√ß√£o de incidente aeron√°utico?", a: ["Uma pot√™ncia aeron√°utica, classificada como um incidente, associada √† opera√ß√£o de uma aeronave, que afete ou possa afetar a seguran√ßa da opera√ß√£o. Nota - Os tipos de incidentes que s√£o de interesse principal √† ICAO para estudos de preven√ß√£o de acidentes est√£o listados no adendo c do anexo 13 √† conven√ß√£o sobre avia√ß√£o civil internacional. Uma tradu√ß√£o livre desta lista encontra-se no anexo b desta norma.", "Uma transfer√™ncia aeron√°utica, classificada como um voo em baixa altitude, associada √† opera√ß√£o de uma aeronave, que afete ou possa afetar a seguran√ßa da opera√ß√£o. Nota - Os tipos de incidentes que s√£o de interesse principal √† icao para estudos de preven√ß√£o de acidentes est√£o listados no adendo c do anexo 13 √† conven√ß√£o sobre avia√ß√£o civil internacional. Uma tradu√ß√£o livre desta lista encontra-se no anexo b desta norma.", "\"Uma audi√™ncia aeron√°utica, classificada como voo livre, associada √† opera√ß√£o de uma aeronave, que afete ou possa afetar a seguran√ßa da opera√ß√£o. Nota - Os tipos de incidentes que s√£o de interesse principal √† icao para estudos de preven√ß√£o de acidentes est√£o listados no adendo c do anexo 13 √† conven√ß√£o sobre avia√ß√£o civil internacional. Uma tradu√ß√£o livre desta lista encontra-se no anexo b desta norma.", "Uma ocorr√™ncia aeron√°utica, n√£o classificada como um acidente, associada √† opera√ß√£o de uma aeronave, que afete ou possa afetar a seguran√ßa da opera√ß√£o. Nota - Os tipos de incidentes que s√£o de interesse principal √† icao para estudos de preven√ß√£o de acidentes est√£o listados no adendo c do anexo 13 √† conven√ß√£o sobre avia√ß√£o civil internacional. Uma tradu√ß√£o livre desta lista encontra-se no anexo b desta norma."], c: 3},
  {q: "Dentre as alternativas abaixo, aquela que define a corrente el√©trica √©?", a: ["A dire√ß√£o de um campo el√©trico em torno de cargas positivas e negativas.", "A distribui√ß√£o uniforme de cargas iguais em metal.", "O fluxo de el√©trons de um ponto negativo para o positivo.", "Rea√ß√£o de cargas iguais atrav√©s de um isolante."], c: 2},
  {q: "Caracter√≠sticas dos parafusos do tipo soberba:", a: ["S√£o os do tipo bolt e podem ter a ponta da rosca pontuda.", "S√£o os screw e s√£o usados quando a firmeza n√£o √© um fator importante.", "Bolt e os do tipo screw s√£o projetados para serem usados com porcas.", "Bolt e os do tipo screw s√£o intercambi√°veis, sem preju√≠zo √† seguran√ßa."], c: 1},
  {q: "Durante a manuten√ß√£o no sistema de oxig√™nio, o mec√¢nico deve tomar muito cuidado para n√£o deixar a graxa ou √≥leo entrar em contato com o sistema, caso contr√°rio poder√° ocorrer?", a: ["Surgimento de gelo seco.", "Inc√™ndio ou explos√£o.", "√Ågua oxigenada.", "Produ√ß√£o de oxig√™nio l√≠quido."], c: 1},
  {q: "Which instrument that indicates the aircraft's altitude in relation to the ground?", a: ["Compass.", "Altimeter.", "Pitot.", "Climb."], c: 1},
  {q: "Qual significado de \"flight safety\"?", a: ["Cinto de seguran√ßa.", "Seguran√ßa de voo.", "Voo com seguran√ßa.", "Seguran√ßa de manuten√ß√£o."], c: 1},
  {q: "As talhadeiras s√£o utilizadas para?", a: ["Cortar e desbastar qualquer metal mais macio do que ela.", "Desbastar, limar, cortar metais mais pesados do que ela.", "Cortar, dobrar, desbastar qualquer material mais duro do que ela.", "Cortar e desbastar qualquer metal mais duro do que ela."], c: 0},
  {q: "A parte do paqu√≠metro que faz medi√ß√µes externas denomina-se?", a: ["Orelha.", "Impulsor.", "Bico.", "Vernier."], c: 2},
  {q: "Um circuito resistivo com 2 resist√™ncias em paralelo, medindo 8 e 12 ohms, ter√° uma resist√™ncia total de?", a: ["20,5 ohms.", "10,0 ohms.", "4,0 ohms.", "4,8 ohms."], c: 3},
  {q: "Como √© determinado o tamanho de uma lima?", a: ["Face para a extremidade da espiga.", "Face para a base do cabo.", "Comprimento total excluindo a espiga.", "Ponta para extremidade da espiga."], c: 2},
  {q: "Quantidade de coulomb por segundo (quantidade de el√©trons que passam em um", a: ["Watts.", "Voltagem.", "Amperimetro.", "Ampere."], c: 3},
  {q: "Inclui todos os equipamentos operacionais que possuem localiza√ß√£o fixa e, que estejam realmente instalados na aeronave. Este peso inclui o peso da c√©lula, grupo motopropulsor, equipamento necess√°rios, lastro fixo, fluido hidr√°ulico, √≥leo e combust√≠vel residuais:", a: ["Peso vazio.", "Peso m√°ximo.", "Carga √∫til.", "Peso de combust√≠vel zero."], c: 0},
  {q: "Em um ramo de um circuito, h√° 10 resistores √¥hmicos ligados em s√©rie. Sabendo-se que a corrente el√©trica que passa no primeiro √© igual a 10 √¢mpere, a corrente que passa", a: ["Igual a 10A em todos os pontos, considerando que est√£o ligados em s√©rie.", "Menor que o primeiro resistor, inferior a 5A.", "Maior, porque est√£o ligados em s√©rie-paralelo.", "Ser√° maior que o primeiro resistor, superior a 10A."], c: 0},
  {q: "Uma aeronave considerada desaparecida configura uma situa√ß√£o tecnicamente", a: ["Incidente aeron√°utico.", "Sequestrada.", "Perigo aeron√°utico.", "Acidente aeron√°utico."], c: 3},
  {q: "Como √© realizado a lubrifica√ß√£o da bomba de combust√≠vel acionada pelo motor da aeronave?", a: ["Pelo pr√≥prio combust√≠vel.", "Atrav√©s da linha de retorno do sistema de lubrifica√ß√£o.", "Pelo √≥leo do motor.", "Adicionando √≥leo ao combust√≠vel."], c: 0},
  {q: "Na combust√£o prematura devido ao superaquecimento do eletrodo das velas ou dep√≥sitos de carv√£o incandescente na c√¢mara de combust√£o denomina-se?", a: ["Detona√ß√£o.", "Cal√ßo de vapor.", "Pr√©-igni√ß√£o.", "P√≥s-igni√ß√£o."], c: 2},
  {q: "A propriedade de um metal, que lhe permite se esticado, flexionado ou torcido de v√°rias maneiras, sem quebrar, denomina-se?", a: ["Ductilidade.", "Fusibilidade.", "Dureza.", "Condutividade."], c: 0},
  {q: "Quando o avi√£o enfrenta rajadas, a carga de ar imposta sobre as asas excede a carga normal de sustenta√ß√£o do peso do avi√£o, podemos afirmar que a aeronave esta passando por uma condi√ß√£o de voo?", a: ["Normal.", "Est√°vel.", "Parado.", "Com turbul√™ncia severa."], c: 3},
  {q: "√â a energia potencial por unidade de carga el√©trica produzida por geradores el√©tricos, como baterias ou pilhas:", a: ["For√ßa eletromotriz.", "For√ßa do campo el√©trico.", "For√ßa eletromagn√©tica.", "For√ßa de atrito magn√©tico."], c: 0},
  {q: "Chave comum utilizada na aeronave somente onde houver, prendedores ou parafusos com fenda na cabe√ßa:", a: ["Chave de fenda comum.", "Toca pino comum.", "Soquetes.", "Parafusadeira, manuais e precis√£o."], c: 0},
  {q: "Queimadura que atinge todas as camadas da pele e chega aos ossos, apresenta pouca ou nenhuma dor, com colora√ß√£o da pele na cor branca ou carbonizada:", a: ["Quinto grau.", "Segundo grau.", "Primeiro grau.", "Terceiro grau."], c: 3},
  {q: "O fator humano compreende o homem sob o ponto de vista biol√≥gico em seus aspectos?", a: ["De indenizar as v√≠timas.", "Fisiol√≥gicos e psicol√≥gicos.", "De indenizar as v√≠timas de acidentes.", "De oferecer subs√≠dios para o pagamento da ap√≥lice de seguro."], c: 1},
  {q: "O n√∫mero de vezes em que cada ciclo ocorre num per√≠odo de tempo √© chamado de?", a: ["Reat√¢ncia capacitiva.", "Frequ√™ncia.", "Capacit√¢ncia.", "Reat√¢ncia indutiva."], c: 1},
  {q: "Nos blocos de t√≠tulos cont√©m informa√ß√µes sobre o desenho e ter√£o v√°rias informa√ß√µes, exceto?", a: ["Escala e data.", "Nome da empresa, do desenhista e da pessoa que aprovou o desenho.", "Como dobrar o projeto.", "N√∫mero do desenho e nome da pe√ßa."], c: 2},
  {q: "Um combust√≠vel de jato, altamente vol√°til, apresenta caracter√≠sticas que s√£o convenientes para?", a: ["Facilitar a possibilidade de cal√ßo de vapor.", "Dificultar as partidas em v√¥o.", "Reduzir as perdas do combust√≠vel por evapora√ß√£o.", "Facilitar as partidas em tempo frio."], c: 3},
  {q: "Em uma chave de boca em polegadas, se uma extremidade medir 5/8 da polegada, a outra extremidade medir√°, em polegada?", a: ["3/8.", "11/16.", "1/2.", "3/4."], c: 1},
  {q: "As plantas s√£o o elo entre os engenheiros que projetam o avi√£o e?", a: ["Entre os homens que pilotam o avi√£o.", "Entre os homens que constroem o avi√£o.", "Entre os org√£os locais de avia√ß√£o.", "Entre os homens que destroem o avi√£o."], c: 1},
  {q: "O peso m√°ximo de uma aeronave consta em suas especifica√ß√µes e pode variar de acordo com?", a: ["As condi√ß√µes de opera√ß√£o, apenas.", "O interesse do operador da aeronave.", "A finalidade e as condi√ß√µes de opera√ß√£o.", "O interesse do operador da aeronave, mediante autoriza√ß√£o espec√≠fica da autoridade de avia√ß√£o civil."], c: 2},
  {q: "O dispositivo usado em alguns sistemas do avi√£o com a finalidade de converter corrente cont√≠nua em alternada, denomina-se?", a: ["Transformador.", "Inversor.", "Retificador.", "Alternador."], c: 1},
  {q: "An√°lise eletromagn√©tica √© um termo na qual descreve os m√©todos de testes eletr√¥nicos, envolvendo a intersec√ß√£o de campos ?", a: ["Magn√©ticos e correntes alternadas.", "Magn√©tico e n√£o magn√©tico.", "Magn√©ticos e correntes circulat√≥rias.", "Magn√©ticos e obstratos."], c: 2},
  {q: "Ao regular e travar uma chave de fenda do tipo catraca, poderemos us√°-la como uma?", a: ["Como uma chave de fenda em \"z\".", "Como uma alavanca.", "Como uma chave de fenda comum.", "Como uma talha."], c: 2},
  {q: "No jogo de soquetes qual cabo que permite realizar trabalhos em qualquer √¢ngulo de 0¬∫ a 90¬∫ em rela√ß√£o a linha central do parafuso?", a: ["Cabo tipo \"t\".", "Catraca.", "Cabo dobradi√ßa ou articulado.", "Arco de velocidade."], c: 2},
  {q: "O RBAC 156 √© o regulamento que trata sobre:", a: ["Mec√¢nico de Manuten√ß√£o de aeronaves", "Uso individual de subst√¢ncias psicoativas.", "Seguran√ßa operacional em aer√≥dromos.", "Fatores humanos na avia√ß√£o."], c: 2},
  {q: "Os paqu√≠metros tem suas escalas graduadas em?", a: ["Newton metro e polegadas.", "Mil√≠metros e polegadas.", "Libras p√© e mil√≠metros.", "Newton metro e libra p√©."], c: 1},
  {q: "As l√¢minas dos alargadores s√£o endurecidas at√© o ponto de ficarem?", a: ["R√≠gidas.", "Quebradi√ßas.", "Retas nas laterais.", "Moldadas no formato ideal."], c: 1},
  {q: "A justi√ßa do trabalho √© composta por:", a: ["Conselho do trabalho e tribunais especiais do trabalho.", "Vara do trabalho, tribunais regionais do trabalho e tribunal superior do trabalho.", "Militares e civis.", "Set, tjdf e stm."], c: 1},
  {q: "Num jogo de ferramentas soquete, se uma das pe√ßas mede 11/16 da polegada, a pe√ßa imediatamente posterior medir√° quantas polegada?", a: ["9/16.", "13/16.", "1/2.", "3/4."], c: 3},
  {q: "√â uma ferramenta usada para medir dist√¢ncia entre pontos, para transferir dist√¢ncias ou para riscar c√≠rculos ou parte de c√≠rculos:", a: ["Compasso.", "Riscador.", "Transferidor digital.", "Tarraxa."], c: 0},
  {q: "O inversor √© projetado para fornecer?", a: ["50v ca.", "115 v ca - 400hz.", "200 v ca - 400hz.", "24v cc."], c: 1},
  {q: "Para que n√£o haja danos no parafuso, uma chave de fenda comum deve preencher a fenda em, pelo menos quantos porcento?", a: ["25%.", "100%.", "50%.", "75%."], c: 3},
  {q: "Chave combinada, se uma extremidade medir 3/8 da polegada, a outra extremidade medir√°?", a: ["5/16 da polegada.", "7/16 da polegada.", "1/4 da polegada.", "3/8 da polegada."], c: 3},
  {q: "Cossinete √© uma ferramenta utilizada para?", a: ["Escarear roscas.", "Fazer roscas internas.", "Fazer roscas externas.", "Realizar alinhamento de fios de rosca."], c: 2},
  {q: "Durante os procedimentos de primeiros socorros, qual o principal sintoma apresentado por uma v√≠tima com hemorragia nasal?", a: ["Sangramento no nariz.", "Sangramento nos olhos.", "Sangramento no ouvido.", "Sangramento no reto."], c: 0},
  {q: "What is the name of the front of a wing?", a: ["Relative wind.", "Leading edge.", "Leakage board.", "Escape attack."], c: 1},
  {q: "√â uma linha s√≥lida interrompendo no ponto m√©dio para coloca√ß√£o da indica√ß√£o de medidas, e tendo ponta de setas opostas a cada final, para mostrar a origem e o fim da medida:", a: ["Linha l√≠der.", "Linha de cota.", "Linha de centro.", "Linha a√©rea."], c: 1},
  {q: "Os v√°rios tipos de materiais indicadores dispon√≠veis para utiliza√ß√£o na inspe√ß√£o por part√≠culas magn√©ticas podem ser classificados em dois tipos, quais s√£o?", a: ["Os utilizados no processo l√≠quido e os utilizados no processo por press√£o.", "Os utilizados no processo gasoso e os utilizados no processo seco.", "Os utilizados no processo l√≠quido e os utilizados no processo seco.", "Os utilizados no processo de remo√ß√£o e os utilizados no processo ades√£o."], c: 2},
  {q: "A luxa√ß√£o articular √© definida como?", a: ["A concorr√™ncia e perda de congru√™ncia da harmonia de movimento de articula√ß√£o, com comprometimento da c√°psula articular e pagamentos.", "A deformidade e perda de congru√™ncia da harmonia de movimento de articula√ß√£o, com comprometimento da c√°psula articular e ligamentos.", "A conformidade e perda dos dentes da harmonia de movimento de articula√ß√£o, com comprometimento da c√°psula articular e ligamentos.", "A deformidade do sistema hidr√°ulico e perda de congru√™ncia da harmonia de movimento de articula√ß√£o, com comprometimento da c√°psula articular e ligamentos."], c: 1},
  {q: "Helicopter is approaching to landing with locked landing train: o que significa \"approaching to\"?", a: ["Apari√ß√£o.", "Aproado com o vento.", "Apontado.", "Aproxima√ß√£o."], c: 3},
  {q: "Os combust√≠veis que comp√µem o fogo, podem ser:", a: ["S√≥lidos, l√≠quidos e el√©tricos.", "S√≥lidos, l√≠quidos e gasosos.", "L√≠quidos, erupt√≠veis e magn√©ticos.", "Magn√©ticos, minerais e imantados."], c: 1},
  {q: "√â correto afirmar que os parafusos do tipo?", a: ["Bolt podem ter a ponta da rosca pontuda.", "Bolt e os do tipo screw t√™m capacidades id√™nticas quanto √† firmeza.", "Bolt s√£o usados quando a firmeza √© um fator importante.", "Screw s√£o projetados para serem usados com porcas."], c: 2},
  {q: "Identifique a chave que tem uma barra hexagonal, com formato em \"L\" e seu crescimento √© de chave para chave na ordem de 1/64\" a 1/64\"?", a: ["Torqu√≠metro.", "Gancho.", "Allen ou cachimbo.", "Soquetes."], c: 2},
  {q: "Em um circuito paralelo, quanto menor for a resist√™ncia total do circuito?", a: ["Menor ser√° a tens√£o aplicada.", "Maior ser√° a corrente total do circuito.", "Menor ser√° a corrente total do circuito.", "Maior ser√° a tens√£o aplicada."], c: 1},
  {q: "Qual m√©todo mais eficaz que devemos adotar para evitar a febre amarela:", a: ["Ferver a √°gua.", "Ter higiene pessoal.", "Lavar frutas.", "Tomar vacina."], c: 3},
  {q: "Considerando o local de trabalho, √† s√≠ndrome da imunodefici√™ncia adquirida(aids), pode-se afirmar que n√£o √© transmiss√≠vel pelo(a)?", a: ["Transfus√£o de sangue.", "Contato interpessoal.", "Rela√ß√£o sexual.", "Uso de drogas injet√°veis, usando o mesmo material."], c: 1},
  {q: "A unidade empregada para medir pot√™ncia, em circuitos de corrente cont√≠nua, √© conhecida como?", a: ["Watt.", "Ampere.", "Volt.", "Ohm."], c: 0},
  {q: "Chave combinada √© aquela que possui, em cada uma das extremidades da chave?", a: ["Soquete e, na outra, uma de fenda.", "De boca e, na outra, uma soquete.", "Colar e, na outra, uma soquete.", "Colar e, na outra, uma de boca."], c: 3},
  {q: "A descarga de combust√≠vel em voo, com a finalidade de reduzir o peso da aeronave, √© realizada atrav√©s da v√°lvula de?", a: ["Alijamento.", "Corte.", "Transfer√™ncia.", "Alimenta√ß√£o cruzada."], c: 0},
  {q: "Como escreve trem de pouso em ingl√™s?", a: ["Landing gear.", "Milk gear.", "Take-off-train.", "Landing train well."], c: 0},
  {q: "Para se tornar mec√¢nico de manuten√ß√£o aeron√°utica √© necess√°rio concluir com aproveitamento, um curso homologado pela anac, dentro das habilita√ß√µes previstas:", a: ["Cel, gmp e avi.", "Faa, infa e ccf.", "Csgo, ctt e cate.", "Cct, cht e ccf."], c: 0},
  {q: "Leia com aten√ß√£o e escolha a resposta certa. Aerodynamics is the study of the dynamics of gases, the interaction between a moving object and the atmosphere. A palavra ‚Äúbetween‚Äù quer dizer:", a: ["Entrega.", "Entre.", "Entregue.", "Entrada."], c: 1},
  {q: "O movimento em torno do eixo longitudinal √© produzido pelo(s):", a: ["Leme.", "Spoilers.", "Ailerons.", "Profundores."], c: 2},
  {q: "A unidade de medida que expressa a indut√¢ncia √© o?", a: ["Henry.", "Ciclo.", "Hert.", "Ohm."], c: 0},
  {q: "Um dens√≠metro foi usado para testar um acumulador de √°cido chumbo (bateria). A leitura que se obteve foi de 1120 de densidade (wh). Neste caso, em qual condi√ß√£o a bateria se encontra?", a: ["Entre 1.240 e 1.200, a carga da bateria est√° baixa.", "Entre 1.240 e 1.200, a bateria est√° com superaquecimento.", "Entre 1.240 e 1.200, a carga da bateria est√° a 100%.", "Entre 1.240 e 1.200, a carga da bateria est√° em 50% do nominal."], c: 0},
  {q: "No jogo de soquetes, como √© determinado o tamanho da barra de extens√£o?", a: ["Pelo di√¢metro do cabo.", "Pela face do macho.", "Pelo comprimento total da barra em polegadas.", "Pelo peso total da barra em polegadas."], c: 2},
  {q: "In the atmosphere the speed of sound varies with?", a: ["Density and temperature.", "Trailer and temperature.", "Depends on flight times.", "Traction and temperature."], c: 0},
  {q: "Como ponto de refer√™ncia, a medi√ß√£o √© normalmente tirada a partir do nariz ou esta√ß√£o zero, mas em alguns casos, podem ser retirada da(o)?", a: ["Longarinas.", "Esbo√ßo", "Parede de fogo.", "Linhas em corte."], c: 2},
  {q: "Qual o desenho que mostra o objeto como aparece aos olhos, mas n√£o √© satisfat√≥rio para mostrar as formas e formato complexo:", a: ["Desenho superficial.", "Desenho de proje√ß√£o ortogr√°fica.", "Desenho pictorial.", "Desenho de diagrama."], c: 2},
  {q: "Um transformador consiste de tr√™s partes b√°sicas, identifique- as:", a: ["Um reostato de campo, uma bobina prim√°ria e outra secund√°ria.", "Um n√∫cleo de ferro, um contato fixo e outro m√≥vel.", "Um induzido, uma pe√ßa polar e um anel coletor.", "Um n√∫cleo de ferro, um enrolamento prim√°rio e outro secund√°rio."], c: 3},
  {q: "What type of aircraft lands on water and earth?", a: ["Aquatic aircraft", "Amphibious aircraft", "Marine aircraft", "Aircraft terrest"], c: 1},
  {q: "Ferramenta que pode ser usada com um arco de velocidade:", a: ["Chave em \"z\".", "Soquete.", "Pun√ß√£o.", "Catraca."], c: 1},
  {q: "Qual pun√ß√£o que devemos utilizar para fazer marcas de refer√™ncia no metal?", a: ["Vazador.", "Bico.", "Toca-pino.", "Alinhamento."], c: 1},
  {q: "Qual a tradu√ß√£o do fragmento \"propeller governor\"?", a: ["Manete de h√©lice.", "Governador de h√©lice.", "Governador do motor.", "√Çngulo de h√©lice."], c: 1},
  {q: "A inscri√ß√£o para o exame te√≥rico para t√©cnico de manuten√ß√£o em aeronaves, atualmente √© realizada por qual funda√ß√£o?", a: ["Funda√ß√£o Santos Dumont.", "Funda√ß√£o Ases Indom√°veis.", "Funda√ß√£o Get√∫lio Vargas.", "Funda√ß√£o \"Anac.\""], c: 2},
  {q: "Conectando um resistor em uma tomada de 240 V, ele ser√° decorrido por uma corrente el√©trica de 10 A. Ent√£o, com as informa√ß√µes dadas, determine o valor da resist√™ncia el√©trica:", a: ["2,44 o .", "0,024 o.", "24 o.", "2,4 o."], c: 2},
  {q: "O SGSO deve acompanhar, quantificar e medir o n√≠vel de?", a: ["Seguran√ßa da organiza√ß√£o.", "Seguran√ßa financeira.", "Seguran√ßa da Aerosimulados.", "Seguran√ßa de aeroportos de drone."], c: 0},
  {q: "A propriedade que tem uma chapa de metal em ser trabalhada para formar curvas denomina-se?", a: ["Resist√™ncia.", "Condutibilidade.", "Maleabilidade.", "Dureza."], c: 2},
  {q: "Comp√µem uma conex√£o flangeada:", a: ["Porca e bra√ßadeira.", "Luva e arruela.", "Porca e luva.", "Bra√ßadeira e arruela."], c: 2},
  {q: "√â uma lista frequentemente inclu√≠da no desenho de materiais e pe√ßas necess√°rias √† fabrica√ß√£o ou montagem de um componente ou sistema?", a: ["Lista de material.", "Zoneamento.", "Legenda.", "Lista de refer√™ncia."], c: 0},
  {q: "Qual ferramenta √© feita de material macio; tais como, borracha, couro cru, pl√°stico, etc, e s√£o geralmente de tamanho maior que os martelos comuns, sendo empregados para trabalhos que deformariam, se us√°ssemos um martelo de cabe√ßa met√°lica?", a: ["Pun√ß√£o.", "Martelo macio ou macete.", "Martelo pena cruzada.", "Marreta."], c: 1},
  {q: "As ferramentas que cortam em forma c√¥nica uma depress√£o ao redor de um furo, para permitir que um parafuso fique ao mesmo plano da superf√≠cie do material, denomina-se?", a: ["Limas.", "Pun√ß√µes.", "Escareadores.", "Brocas."], c: 2},
  {q: "Identifique, a classe dos conectores resistente √† vibra√ß√£o e √† umidade, que possui um ilh√≥s selante de borracha no inv√≥lucro traseiro:", a: ["B(Bravo).", "C(Charlie).", "A(Alpha).", "D(Delta)."], c: 3},
  {q: "Precis√£o do volt√≠metro, a precis√£o de um medidor √© geralmente expressa em?", a: ["Atualidade.", "Porcentagem.", "Corrente reversa.", "Amperagem."], c: 1},
  {q: "√â um simples desenho de rascunho, que √© feito rapidamente e sem muito detalhe. Podem ser desde uma simples apresenta√ß√£o, at√© uma proje√ß√£o ortogr√°fica com v√°rias vistas, essa afirma√ß√£o √© a defini√ß√£o de?", a: ["Diagrama.", "Esbo√ßo.", "Esquema.", "Planta."], c: 1},
  {q: "Os ignitores do sistema de partida no motor a rea√ß√£o √© acionado:", a: ["Durante o corte do motor em pot√™ncia de transi√ß√£o (idle)...", "Durante todo funcionamento do motor.", "Durante a partida at√© completar o ciclo, antes da decolagem ou tax√≠.", "Durante o funcionamento do motor em pot√™ncia m√°xima em decolagem."], c: 2},
  {q: "A parte traseira do aerof√≥lio por onde se escoa o vento relativo chama-se:", a: ["Bordo de fuga.", "Flap.", "Bordo de ataque.", "Cambra."], c: 0},
  {q: "Qual a tradu√ß√£o da palavra \"spring\" em portugu√™s?", a: ["Engrenagem.", "Parafuso.", "Mola.", "Porca."], c: 2},
  {q: "Ao remover a porta da aeronave, conforme manual de manuten√ß√£o no cap√≠tulo 52, o mec√¢nico verificou a necessidade de realizar um reparo estrutural no componente, qual o manual que o mec√¢nico dever√° utilizar para realizar o reparo?", a: ["Manual de diagramas (WDM).", "Manual de voo (PMV).", "Manual cat√°logo ilustrado de pe√ßas (IPC).", "Manual de reparos (MRR ou SRM)."], c: 3},
  {q: "Sempre que houver um dano em um terminal de cabos de comando, o mesmo dever√° ser substitu√≠do, qual nome que se d√° ao terminal de \"cabos de comando\" em ingl√™s?", a: ["Rail drive.", "Rod well.", "Piston.", "Rod end."], c: 3},
  {q: "Ao conjunto cossinete e desandador d√°-se o nome de?", a: ["Tambor.", "Rotor.", "Catraca.", "Tarraxa."], c: 3},
  {q: "De acordo com a lei de Ohms, dado a tens√£o V= 250V e a resist√™ncia R= 25 ohms, qual a corrente el√©trica?", a: ["1,0A.", "25A.", "2,5A.", "10A."], c: 3},
  {q: "Qual destino ser√° dado aos destro√ßos da aeronave acidentada?", a: ["Ser√° levado para o ferro velho de avi√µes nos Estados Unidos da Am√©rica.", "Ficar√° de forma definitiva nas depend√™ncias do CENIPA.", "Ser√° devolvida ao propriet√°rio, ap√≥s a investiga√ß√£o do CENIPA e das autoridades policiais.", "Ficar√° de forma definitiva nas depend√™ncias do SIPAER."], c: 2},
  {q: "As tubula√ß√µes flex√≠veis ou r√≠gida identificadas com as cores azul e amarela pertencem ao sistema?", a: ["Hidr√°ulico.", "De combust√≠vel.", "Pneum√°tico.", "De lubrifica√ß√£o."], c: 0},
  {q: "Referente a desgna√ß√£o do tamanho ou bitola das mangueiras, a medida das mangueiras flex√≠veis √© determinada de qual forma?", a: ["Di√¢metro interno.", "Comprimento total.", "Di√¢metro externo.", "Espessura da parede do tubo."], c: 0},
  {q: "Os tanques de √≥leo das aeronaves nunca devem ser enchidos at√© sua capacidade m√°xima, em fun√ß√£o da:", a: ["Pr√© igni√ß√£o.", "Expans√£o el√©trica dos resistores do √≥leo.", "Redu√ß√£o de press√£o.", "Expans√£o t√©rmica do √≥leo."], c: 3},
  {q: "Um condutor de eletricidade, que limita ou restringe o fluxo de corrente el√©trica, denomina-se?", a: ["Fluxo de corrente.", "Resist√™ncia.", "Pot√™ncia.", "For√ßa eletromotriz."], c: 1},
  {q: "Tubula√ß√µes de cores vermelha e verde correspondem, respectivamente?", a: ["Oxig√™nio e pneum√°tico.", "Combust√≠vel e oxig√™nio.", "Ar condicionado e oxig√™nio.", "Lubrifica√ß√£o e combust√≠vel."], c: 1},
  {q: "O equipamento que transforma energia mec√¢nica em energia el√©trica denomina-se?", a: ["Inversor.", "Transformador.", "Capacitor.", "Gerador."], c: 3},
  {q: "O centro de investiga√ß√£o e preven√ß√£o de acidentes aeron√°uticos (CENIPA), est√° situado em qual capital do Brasil?", a: ["Brazl√¢ndia DF.", "Rio de Janeiro RJ.", "Brasilia DF.", "S√£o Paulo SP."], c: 2},
  {q: "A localiza√ß√£o, o tamanho, a forma e a constru√ß√£o dos tanques de combust√≠veis variam com o tipo e a utiliza√ß√£o da aeronave. Em alguns avi√µes, os tanques de combust√≠veis s√£o integrais a?", a: ["Nacele do motor.", "Cabine dos pax.", "Asa somente.", "Asa ou outras partes estruturais da aeronave."], c: 3},
  {q: "Quando n√£o h√° grande exig√™ncia de precis√£o para mensurar um componente, qual ferramenta que o mec√¢nico pode utilizar?", a: ["Micr√¥metro.", "Amper√≠metro.", "R√©gua.", "Torqu√≠metro."], c: 2},
  {q: "Um corpo carregado positivamente apresenta?", a: ["Excesso de neutrons.", "Falta de mol√©culas.", "Falta de pr√≥tons.", "Falta de el√©trons."], c: 3},
  {q: "√â uma ferramenta que auxilia a tripula√ß√£o a realizar atividades aeron√°uticas com melhor desempenho e seguran√ßa:", a: ["Per√≠cia.", "Relprev.", "Flm.", "Crm."], c: 3},
  {q: "Qual sistema corresponde ao cap√≠tulo 53 de acordo com as especifica√ß√µes \"ata 100\"?", a: ["Asa.", "Ancoragem.", "Alimenta√ß√£o (for√ßa).", "Fuselagem."], c: 3},
  {q: "Conforme especifica√ß√µes \"ata 100\" o cap√≠tulo 54, corresponde a qual sistema?", a: ["Trem de pouso.", "Naceles / pylons.", "Fuselagem.", "Motores."], c: 1},
  {q: "√â de responsabilidade do pa√≠s, estende-se al√©m de suas fronteiras. Ultrapassa a √°rea sobre seu territ√≥rio e alcan√ßa uma significativa parte do oceano atl√¢ntico, perfazendo um total de 22 milh√µes de km 2, sobre terra e mar, acordados em tratados internacionais:", a: ["Espa√ßo a√©reo da icao.", "Espa√ßo a√©reo internacional.", "Espa√ßo a√©reo brasileiro.", "Espa√ßo a√©reo oaci."], c: 2},
  {q: "A parada do motor motivada pelo cal√ßo ocorre nas linhas de combust√≠vel, devido a?", a: ["Octanagem.", "Vaporiza√ß√£o.", "Mistura excessivamente rica.", "Forma√ß√£o de gelo nos tanques."], c: 1},
  {q: "As f√©rias anuais dos aerovi√°rio ser√° de quanto dias?", a: ["15 (dias) dias consecutivos, mediante acordo individual, as f√©rias poder√£o ser fracionadas.", "30 (trinta) dias consecutivos, mediante acordo coletivo, as f√©rias poder√£o ser fracionadas.", "60 (sessenta) dias consecutivos, mediante acordo coletivo, as f√©rias poder√£o ser fracionadas.", "35 (trinta e cinco) dias consecutivos, mediante acordo coletivo, as f√©rias poder√£o ser fracionadas, considerando ano bissexto."], c: 1},
  {q: "Sobre a especifica√ß√£o \"ATA - 100\", √© correto afirmar:", a: ["√â um conjunto de normas em fase de implanta√ß√£o.", "√â um padr√£o mandat√≥rio somente utilizado na Europa.", "Criou um padr√£o de apresenta√ß√£o de dados t√©cnicos atrav√©s do manuais para avia√ß√£o.", "√â um padr√£o utilizado tamb√©m em autom√≥veis e motocicletas."], c: 2},
  {q: "Qual elemento sens√≠vel que √© empregado no liquid√¥metro de leitura direta para mensurar a quantidade de combust√≠vel?", a: ["Capacitor.", "B√≥ia.", "Diafragma.", "Termopar."], c: 1},
  {q: "Ao terminar de ajustar e torquear um esticador deve-se?", a: ["Contrapinar as porcas autofreno.", "Contrapinar os prendedores do tipo dzu.", "Frenar o esticador do cabo de comando.", "Frenar as porcas autofreno."], c: 2},
  {q: "O que corresponde o cap√≠tulo 05 do manual de manuten√ß√£o conforme \"ata 100\"?", a: ["Documenta√ß√£o obrigat√≥ria.", "Inspe√ß√µes.", "Cat√°logo de pe√ßas.", "Registro de voo."], c: 1},
  {q: "O rel√© √© um interruptor eletromec√¢nico, cuja a movimenta√ß√£o f√≠sica deste interruptor ocorre quando a corrente el√©trica percorre as espiras da (o)?", a: ["Bateria.", "Caixa el√©trica da anv.", "Gerador.", "Bobina."], c: 3},
  {q: "Sistema de combust√≠vel. Qual cor da etiqueta que identifica as linhas do sistema de combust√≠veis?", a: ["Verde.", "Vermelha.", "Amarela.", "Azul."], c: 1},
  {q: "Havendo um acidente no local de trabalho, qual o objetivo de prestar os primeiros socorros √†s v√≠timas?", a: ["Omitir o socorro sob pretexto de n√£o testemunhar.", "Tentar remove-la do local sem estar preparado.", "Mante-la imobilizada e inconsciente.", "Manter os sinais vitais."], c: 3},
  {q: "Defini√ß√£o de primeiros socorros?", a: ["S√£o interven√ß√µes imediatas e provis√≥rias que t√™m por finalidade manter as fun√ß√µes vitais de um indiv√≠duo v√≠tima de um acidente, ferido que sofreu mal s√∫bito ou est√° em perigo de vida, at√© que ele receba assist√™ncia especializada.", "S√£o simula√ß√µes imediatas ou n√£o, que t√™m por finalidade manter as fun√ß√µes vitais de um indiv√≠duo v√≠tima de um acidente, ferido que sofreu mal s√∫bito ou est√° em perigo de vida, at√© que ele receba assist√™ncia paralizada.", "S√£o procedimentos de realizar inspe√ß√µes nas aeronaves que sofreram acidente e est√£o inoperantes.", "Significa correr atr√°s das aeronaves."], c: 0},
  {q: "A r√©gua √© considerada uma ferramenta de precis√£o?", a: ["Depende da escala.", "Depende do material que a r√©gua foi fabricada.", "Sim, por√©m sua precis√£o √© inferior a do paqu√≠metro e do micr√¥metro.", "Depende do tipo de aferi√ß√£o."], c: 2},
  {q: "Num circuito el√©trico com 2 resist√™ncias em paralelo medindo 3 e 6 ohm, passa uma corrente de 3 amperes. A tens√£o m√°xima que o volt√≠metro indicar√° ser√° de?", a: ["54 v.", "27 v.", "6 v.", "12 v."], c: 2}
];
    // ============================================
    // CONFIGURA√á√ïES DO SISTEMA
    // ============================================
    const QUESTIONS_PER_SIMULADO_PADRAO = 20;
    const MIN_WRONG_QUESTIONS_FOR_SIMULADO = 1;
    const MIN_PERCENT_FOR_SUCCESS = 70;
    
    // ============================================
    // VARI√ÅVEIS GLOBAIS
    // ============================================
    let QUESTIONS_PER_SIMULADO = QUESTIONS_PER_SIMULADO_PADRAO;
    let API_URL = "https://script.google.com/macros/s/AKfycbwcX8bNdrDQZ6sRB1sbG0COJe7aGYyBlOCPkno2JxbM-59_-FsWt4LCccUQ8DBLTy1S5g/exec";
    let EMAIL_DESTINO = "ewerton.andriel@hotmail.com";
    
    let TIME_LIMIT = 0;
    let currentQuestions = [];
    let userAnswers = [];
    let timeLeft = 0;
    let timerId;
    let currentQuestionIndex = 0;
    let autoNavEnabled = true;
    let usedQuestionsHistory = [];
    let currentSimuladoIndices = [];
    let totalSimulados = 1;
    let currentSimuladoNumber = 1;
    
    // VARI√ÅVEIS DO SISTEMA DE REPORTE
    let currentReportQuestionIndex = null;
    let reportsHistory = [];

    // TIPOS DE REPORTE
    const REPORT_TYPES = {
        error: "‚ùå Quest√£o com erro",
        wrong_answer: "‚ö†Ô∏è Resposta incorreta", 
        confusing: "ü§î Enunciado confuso",
        alternative: "üî§ Alternativas erradas",
        other: "üìù Outro problema"
    };
    
    // ============================================
    // VARI√ÅVEIS PARA SISTEMA DE REFOR√áO
    // ============================================
    let wrongQuestionsHistory = [];
    const WRONG_QUESTIONS_KEY = 'wrong_questions_history';
    const LAST_OFFER_KEY = 'last_reforco_offer';
    
    // ============================================
    // CHAVE PARA SESS√ÉO ATUAL
    // ============================================
    const SESSION_ID_KEY = 'current_session_id';
    const CURRENT_QUESTIONS_KEY = 'current_session_questions';
    const CURRENT_QUESTION_INDEX_KEY = 'current_question_index';
    const USER_ANSWERS_KEY = 'user_answers';
    const TIME_LEFT_KEY = 'time_left';
    const AUTO_NAV_KEY = 'auto_nav';
    const SIMULADO_STARTED_KEY = 'simulado_started';
    const CURRENT_SIMULADO_NUMBER_KEY = 'current_simulado_number';
    
    // ============================================
    // NOVA FUN√á√ÉO: EMBARALHAR ALTERNATIVAS
    // ============================================
    
    function shuffleAlternatives(question) {
        // Cria uma c√≥pia da quest√£o
        const shuffledQuestion = { ...question };
        
        // Cria um array de √≠ndices [0, 1, 2, 3...]
        const indices = Array.from({ length: question.a.length }, (_, i) => i);
        
        // Embaralha os √≠ndices
        const shuffledIndices = shuffleArray(indices);
        
        // Cria novas alternativas com a ordem embaralhada
        const shuffledAlternatives = shuffledIndices.map(index => question.a[index]);
        
        // Encontra o novo √≠ndice da resposta correta
        const newCorrectIndex = shuffledIndices.indexOf(question.c);
        
        // Atualiza a quest√£o com as alternativas embaralhadas e o novo √≠ndice correto
        shuffledQuestion.a = shuffledAlternatives;
        shuffledQuestion.c = newCorrectIndex;
        shuffledQuestion.shuffledIndices = shuffledIndices; // Guarda o mapeamento para o gabarito
        shuffledQuestion.originalCorrectIndex = question.c; // Guarda o √≠ndice original para refer√™ncia
        
        return shuffledQuestion;
    }
    
    // ============================================
    // FUN√á√ÉO SELECTRANDOMQUESTIONS ATUALIZADA
    // ============================================

    function selectRandomQuestions(forceFirstSimulado = false) {
        const totalQuestions = masterBank.length;
        
        if (totalQuestions === 0) {
            alert("‚ö†Ô∏è O banco de quest√µes est√° vazio! Adicione quest√µes no c√≥digo.");
            return [];
        }
        
        const config = calcularConfiguracaoSimulados();
        console.log(config.mensagem);
        
        let availableQuestions = [];
        for (let i = 0; i < totalQuestions; i++) {
            availableQuestions.push(i);
        }
        
        // Remove as j√° usadas
        if (usedQuestionsHistory.length > 0 && !forceFirstSimulado) {
            availableQuestions = availableQuestions.filter(index => 
                !usedQuestionsHistory.includes(index)
            );
        }
        
        const availableCount = availableQuestions.length;
        let questionsToSelect;
        
        if (availableCount === 0) {
            if (confirm(`Todas as ${totalQuestions} quest√µes j√° foram usadas!\n\nDeseja reiniciar o hist√≥rico?`)) {
                usedQuestionsHistory = [];
                localStorage.setItem(HISTORY_KEY, JSON.stringify(usedQuestionsHistory));
                availableQuestions = Array.from({length: totalQuestions}, (_, i) => i);
                questionsToSelect = Math.min(QUESTIONS_PER_SIMULADO, totalQuestions);
                alert('Hist√≥rico reiniciado!');
                forceFirstSimulado = true;
            } else {
                availableQuestions = Array.from({length: totalQuestions}, (_, i) => i);
                questionsToSelect = Math.min(QUESTIONS_PER_SIMULADO, totalQuestions);
            }
        } else if (availableCount >= QUESTIONS_PER_SIMULADO) {
            questionsToSelect = QUESTIONS_PER_SIMULADO;
        } else if (availableCount >= 5) {
            questionsToSelect = availableCount;
        } else {
            if (confirm(`S√≥ restam ${availableCount} quest√µes!\n\nDeseja fazer simulado com essas quest√µes?`)) {
                questionsToSelect = availableCount;
            } else {
                if (confirm(`Deseja reiniciar o hist√≥rico?`)) {
                    usedQuestionsHistory = [];
                    localStorage.setItem(HISTORY_KEY, JSON.stringify(usedQuestionsHistory));
                    availableQuestions = Array.from({length: totalQuestions}, (_, i) => i);
                    questionsToSelect = Math.min(QUESTIONS_PER_SIMULADO, totalQuestions);
                    forceFirstSimulado = true;
                } else {
                    questionsToSelect = availableCount;
                }
            }
        }
        
        if (totalQuestions <= 27) {
            questionsToSelect = totalQuestions;
            availableQuestions = Array.from({length: totalQuestions}, (_, i) => i);
        }
        
        const shuffledQuestions = shuffleArray(availableQuestions);
        const selectedIndices = shuffledQuestions.slice(0, questionsToSelect);
        
        currentSimuladoIndices = selectedIndices;
        
        if (forceFirstSimulado || usedQuestionsHistory.length === 0) {
            currentSimuladoNumber = 1;
        } else if (selectedIndices.length > 0) {
            const usedCount = usedQuestionsHistory.length;
            const simuladoIndex = Math.floor(usedCount / QUESTIONS_PER_SIMULADO);
            currentSimuladoNumber = Math.min(simuladoIndex + 1, totalSimulados);
        } else {
            currentSimuladoNumber = 1;
        }
        
        if (currentSimuladoNumber > totalSimulados) {
            currentSimuladoNumber = totalSimulados;
        }
        
        console.log(`Simulado configurado: ${currentSimuladoNumber}/${totalSimulados}`);
        
        // ALTERA√á√ÉO: Embaralha as alternativas de cada quest√£o selecionada
        const selectedQuestions = selectedIndices.map(index => {
            const originalQuestion = masterBank[index];
            return shuffleAlternatives({
                ...originalQuestion, 
                originalIndex: index
            });
        });
        
        return selectedQuestions;
    }

    // ============================================
    // FUN√á√ÉO: GENERATE WRONG QUESTIONS SIMULADO ATUALIZADA
    // ============================================
    
    function generateWrongQuestionsSimulado() {
        console.log(`Gerando simulado de refor√ßo com ${wrongQuestionsHistory.length} quest√µes erradas...`);
        
        if (wrongQuestionsHistory.length === 0) {
            console.error('Nenhuma quest√£o errada no hist√≥rico');
            return [];
        }
        
        let availableWrongQuestions = [...wrongQuestionsHistory];
        availableWrongQuestions = shuffleArray(availableWrongQuestions);
        
        const selectedIndices = availableWrongQuestions;
        
        console.log(`Selecionadas ${selectedIndices.length} quest√µes para o simulado de refor√ßo`);
        
        // ALTERA√á√ÉO: Embaralha as alternativas de cada quest√£o de refor√ßo
        const questions = selectedIndices.map(index => {
            if (index >= 0 && index < masterBank.length) {
                const originalQuestion = masterBank[index];
                return shuffleAlternatives({
                    ...originalQuestion,
                    originalIndex: index,
                    isWrongQuestion: true
                });
            }
            return null;
        }).filter(q => q !== null);
        
        return questions;
    }
    
    // ============================================
    // FUN√á√ÉO RENDERCURRENTQUESTION ATUALIZADA
    // ============================================
    
    function renderCurrentQuestion() {
        const container = document.getElementById('quiz-content');
        
        if (!currentQuestions || currentQuestions.length === 0) {
            container.innerHTML = '<div class="question-block-mini">Erro: Nenhuma quest√£o carregada.</div>';
            return;
        }
        
        const question = currentQuestions[currentQuestionIndex];
        
        container.innerHTML = `
            <div class="question-block-mini">
                <div class="question-text-mini">
                    ${currentQuestionIndex + 1}. ${question.q}
                </div>
                <div class="options-mini">
                    ${question.a.map((opt, i) => `
                        <label class="option-mini" id="option-${i}">
                            <input type="radio" name="currentQuestion" value="${i}" 
                                   ${userAnswers[currentQuestionIndex] === i ? 'checked' : ''}
                                   onchange="selectAnswer(${i})">
                            ${opt}
                        </label>
                    `).join('')}
                </div>
                <button class="report-btn" onclick="openReportModal(${currentQuestionIndex})">
                    <span>‚ö†Ô∏è</span> Reportar Problema
                </button>
            </div>
        `;
    }
    
    // ============================================
    // FUN√á√ÉO FINALIZEQUIZ ATUALIZADA
    // ============================================
    
    function finalizeQuiz() {
        clearInterval(timerId);
        
        const answeredCount = getAnsweredCount();
        if (answeredCount !== currentQuestions.length && !confirm(`Respondidas: ${answeredCount}/${currentQuestions.length}. Finalizar?`)) {
            startTimer();
            return;
        }
        
        let finalScore = 0;
        userAnswers.forEach((answer, index) => {
            if (answer !== null && answer === currentQuestions[index].c) {
                finalScore++;
            }
        });
        
        const percent = currentQuestions.length > 0 ? Math.round((finalScore / currentQuestions.length) * 100) : 0;
        const feedback = document.getElementById('feedback-msg');
        
        if (percent >= 70) {
            feedback.textContent = "üéâ Excelente!";
            feedback.style.color = "var(--success)";
        } else if (percent >= 50) {
            feedback.textContent = "üëç Quase l√°!";
            feedback.style.color = "var(--accent)";
        } else {
            feedback.textContent = "üí™ Continue!";
            feedback.style.color = "var(--danger)";
        }
        
        if (currentQuestions[0]?.isWrongQuestion) {
            removeCorrectQuestionsFromHistory();
        } else {
            addWrongQuestionsToHistory();
        }
        
        if (currentSimuladoIndices.length > 0 && !currentQuestions[0]?.isWrongQuestion) {
            usedQuestionsHistory.push(...currentSimuladoIndices);
            usedQuestionsHistory = [...new Set(usedQuestionsHistory)];
            localStorage.setItem(HISTORY_KEY, JSON.stringify(usedQuestionsHistory));
        }
        
        clearSessionData();
        
        let quizHTML = '';
        currentQuestions.forEach((question, index) => {
            const userAnswer = userAnswers[index];
            const isCorrect = userAnswer === question.c;
            
            // Para o gabarito, usamos as alternativas como foram mostradas
            quizHTML += `
                <div class="question-block-mini">
                    <button class="report-gabarito-btn" onclick="openReportModal(${index})" title="Reportar problema">
                        ‚ö†Ô∏è
                    </button>
                    
                    <div class="question-text-mini">
                        ${index + 1}. ${question.q}
                    </div>
                    <div class="options-mini">
                        ${question.a.map((opt, i) => {
                            let classes = 'option-mini';
                            if (i === question.c) classes += ' correct-answer';
                            else if (userAnswer === i && !isCorrect) classes += ' wrong-answer';
                            
                            return `<label class="${classes}">
                                <input type="radio" disabled ${userAnswer === i ? 'checked' : ''}>
                                ${opt}
                                ${userAnswer === i ? '<span style="margin-left: auto; font-size: 0.6rem; color: #6c757d;">(sua resposta)</span>' : ''}
                                ${i === question.c && userAnswer !== i ? '<span style="margin-left: auto; font-size: 0.6rem; color: var(--success);">(correta)</span>' : ''}
                            </label>`;
                        }).join('')}
                    </div>
                </div>
            `;
        });
        
        document.getElementById('quiz-content').innerHTML = quizHTML;
        document.getElementById('final-score').textContent = `${finalScore}/${currentQuestions.length}`;
        document.getElementById('final-percent').textContent = `${percent}%`;
        
        const motivationElement = document.getElementById('motivation-message');
        let motivationHTML = '';
        
        if (currentQuestions[0]?.isWrongQuestion) {
            if (percent >= MIN_PERCENT_FOR_SUCCESS) {
                motivationHTML = `‚úÖ <strong>PARAB√âNS!</strong> Voc√™ superou suas dificuldades!`;
                motivationElement.className = 'motivation-message motivation-success';
            } else {
                motivationHTML = `‚ö° <strong>PRECISA MELHORAR</strong><br>`;
                motivationHTML += `Voc√™ acertou ${finalScore} de ${currentQuestions.length}.<br>`;
                motivationHTML += `Faltam ${MIN_PERCENT_FOR_SUCCESS - percent}% para a meta de ${MIN_PERCENT_FOR_SUCCESS}%.`;
                motivationElement.className = 'motivation-message motivation-warning';
            }
        } else {
            if (percent >= MIN_PERCENT_FOR_SUCCESS) {
                motivationHTML = `üéØ <strong>√ìTIMO DESEMPENHO!</strong>`;
                motivationElement.className = 'motivation-message motivation-success';
            } else {
                motivationHTML = `üìö <strong>CONTINUE ESTUDANDO!</strong>`;
                motivationElement.className = 'motivation-message motivation-warning';
            }
        }
        
        motivationElement.innerHTML = motivationHTML;
        
        const totalQuestions = masterBank.length;
        const uniqueUsed = [...new Set(usedQuestionsHistory)];
        const remainingQuestions = Math.max(0, totalQuestions - uniqueUsed.length);
        const wrongCount = wrongQuestionsHistory.length;
        
        let summaryText = '';
        let showNewSimuladoBtn = true;
        let showReiniciarBancoBtn = false;
        let showNovoSimuladoReforcoBtn = false;
        
        if (currentQuestions[0]?.isWrongQuestion) {
            summaryText = `‚ö° <strong>SIMULADO DE REFOR√áO FINALIZADO</strong><br>`;
            summaryText += `Voc√™ revisou ${currentQuestions.length} quest√µes que errou anteriormente.<br>`;
            summaryText += `Quest√µes ainda erradas: <strong>${wrongCount}</strong>`;
            showNewSimuladoBtn = false;
            showNovoSimuladoReforcoBtn = true;
            
            if (percent < MIN_PERCENT_FOR_SUCCESS) {
                showReiniciarBancoBtn = true;
            }
        } else if (remainingQuestions === 0) {
            summaryText = `üéØ <strong>COMPLETOU TODAS AS ${totalQuestions} QUEST√ïES!</strong><br>`;
            summaryText += `Quest√µes erradas: <strong>${wrongCount}</strong>`;
            
            if (wrongCount < MIN_WRONG_QUESTIONS_FOR_SIMULADO) {
                showNewSimuladoBtn = false;
            }
        } else {
            summaryText = `Restam: <strong>${remainingQuestions}</strong> | Usadas: <strong>${uniqueUsed.length}</strong><br>`;
            summaryText += `Quest√µes erradas: <strong>${wrongCount}</strong>`;
        }
        
        document.getElementById('simulado-summary').innerHTML = summaryText;
        
        document.querySelector('.nav-buttons').style.display = 'none';
        document.getElementById('results').style.display = 'block';
        document.getElementById('finish-btn').style.display = 'none';
        document.getElementById('restart-btn').style.display = 'block';
        
        document.getElementById('wrong-questions-btn').style.display = 'none';
        document.getElementById('reiniciar-banco-btn').style.display = showReiniciarBancoBtn ? 'block' : 'none';
        document.getElementById('new-simulado-btn').style.display = showNewSimuladoBtn ? 'block' : 'none';
        document.getElementById('novo-simulado-reforco-btn').style.display = showNovoSimuladoReforcoBtn ? 'block' : 'none';
        
        updateSimuladoInfo();
        updateReforcoButton();
        updateReiniciarBancoButton();
        updateContinuarBancoButton();
        updateVoltarInicioButton();
        updateNovoSimuladoReforcoButton();
        
        setTimeout(() => {
            if (canOfferReforcoSimulado()) {
                console.log('Oferecendo simulado de refor√ßo...');
                setTimeout(() => {
                    offerWrongQuestionsSimulado();
                }, 1500);
            } else {
                console.log('N√£o pode oferecer refor√ßo no momento');
            }
        }, 500);
    }
    
    // ============================================
    // FUN√á√ïES DE CONFIGURA√á√ÉO DO SIMULADO
    // ============================================
    
    function calcularConfiguracaoSimulados() {
        const totalQuestions = masterBank.length;
        
        if (totalQuestions <= 27) {
            totalSimulados = 1;
            QUESTIONS_PER_SIMULADO = totalQuestions;
            return {
                totalSimulados: 1,
                questionsPerSimulado: totalQuestions,
                mensagem: `Banco com ${totalQuestions} quest√µes ‚Üí 1 √∫nico simulado`
            };
        } else if (totalQuestions >= 28 && totalQuestions <= 39) {
            totalSimulados = 2;
            const questionsPerSimulado = Math.ceil(totalQuestions / 2);
            QUESTIONS_PER_SIMULADO = questionsPerSimulado;
            return {
                totalSimulados: 2,
                questionsPerSimulado: questionsPerSimulado,
                mensagem: `Banco com ${totalQuestions} quest√µes ‚Üí 2 simulados de ~${questionsPerSimulado} quest√µes cada`
            };
        } else {
            totalSimulados = Math.ceil(totalQuestions / QUESTIONS_PER_SIMULADO_PADRAO);
            QUESTIONS_PER_SIMULADO = QUESTIONS_PER_SIMULADO_PADRAO;
            return {
                totalSimulados: totalSimulados,
                questionsPerSimulado: QUESTIONS_PER_SIMULADO_PADRAO,
                mensagem: `Banco com ${totalQuestions} quest√µes ‚Üí ${totalSimulados} simulados de 20 quest√µes`
            };
        }
    }
    
    // ============================================
    // NOVA FUN√á√ÉO: NOVO SIMULADO AP√ìS REFOR√áO
    // ============================================
    
    function novoSimuladoAposReforco() {
        const totalQuestions = masterBank.length;
        const remainingQuestions = Math.max(0, totalQuestions - usedQuestionsHistory.length);
        
        if (remainingQuestions === 0) {
            if (confirm(`Voc√™ j√° completou todas as ${totalQuestions} quest√µes!\n\nDeseja reiniciar o hist√≥rico e come√ßar um novo simulado?`)) {
                usedQuestionsHistory = [];
                localStorage.setItem(HISTORY_KEY, JSON.stringify(usedQuestionsHistory));
                startNewSimuladoFromResults();
            }
        } else {
            if (confirm(`Deseja continuar com as pr√≥ximas quest√µes do banco?\n\nRestam: ${remainingQuestions} quest√µes\nUsadas: ${usedQuestionsHistory.length} quest√µes`)) {
                startNewSimuladoFromResults();
            }
        }
    }
    
    // ============================================
    // FUN√á√ÉO: ATUALIZAR BOT√ÉO NOVO SIMULADO REFOR√áO
    // ============================================
    
    function updateNovoSimuladoReforcoButton() {
        const novoSimuladoBtn = document.getElementById('novo-simulado-reforco-btn');
        if (!novoSimuladoBtn) return;
        
        const isReforco = currentQuestions[0]?.isWrongQuestion;
        const isResultsVisible = document.getElementById('results').style.display === 'block';
        const totalQuestions = masterBank.length;
        const remainingQuestions = Math.max(0, totalQuestions - usedQuestionsHistory.length);
        
        if (isReforco && isResultsVisible) {
            novoSimuladoBtn.style.display = 'block';
            
            if (remainingQuestions === 0) {
                novoSimuladoBtn.innerHTML = `üéØ Novo Simulado (Reiniciar Banco)`;
            } else {
                novoSimuladoBtn.innerHTML = `üéØ Novo Simulado (${remainingQuestions} restantes)`;
            }
        } else {
            novoSimuladoBtn.style.display = 'none';
        }
    }
    
    // ============================================
    // NOVA FUN√á√ÉO: CONTINUAR COM BANCO
    // ============================================
    
    function continuarComBanco() {
        const totalQuestions = masterBank.length;
        const remainingQuestions = Math.max(0, totalQuestions - usedQuestionsHistory.length);
        
        let message = `üìö CONTINUAR COM BANCO\n\n`;
        
        if (remainingQuestions === 0) {
            message += `Voc√™ j√° completou todas as ${totalQuestions} quest√µes!\n`;
            message += `Deseja reiniciar o hist√≥rico e come√ßar um novo simulado?`;
            
            if (confirm(message)) {
                usedQuestionsHistory = [];
                localStorage.setItem(HISTORY_KEY, JSON.stringify(usedQuestionsHistory));
                startNewSimuladoFromResults();
            }
        } else {
            message += `Restam ${remainingQuestions} quest√µes no banco.\n`;
            message += `Voc√™ j√° completou ${usedQuestionsHistory.length} quest√µes.\n\n`;
            message += `Deseja continuar com as pr√≥ximas quest√µes do banco?`;
            
            if (confirm(message)) {
                startNewSimuladoFromResults();
            }
        }
    }
    
    // ============================================
    // FUN√á√ÉO: VOLTAR AO IN√çCIO
    // ============================================
    
    function voltarAoInicio() {
        const totalQuestions = masterBank.length;
        
        let message = `üèÅ VOLTAR AO IN√çCIO\n\n`;
        message += `Esta a√ß√£o vai:\n`;
        message += `‚Ä¢ Limpar TODO o hist√≥rico de progresso\n`;
        message += `‚Ä¢ Limpar TODO o hist√≥rico de quest√µes erradas\n`;
        message += `‚Ä¢ Reiniciar completamente o sistema\n`;
        message += `‚Ä¢ Come√ßar um NOVO simulado do zero\n\n`;
        message += `Tem certeza que deseja voltar ao in√≠cio?`;
        
        if (confirm(message)) {
            usedQuestionsHistory = [];
            localStorage.setItem(HISTORY_KEY, JSON.stringify(usedQuestionsHistory));
            
            wrongQuestionsHistory = [];
            saveWrongQuestionsHistory();
            
            localStorage.removeItem(LAST_OFFER_KEY);
            
            clearSessionData();
            
            document.getElementById('results').style.display = 'none';
            document.getElementById('finish-btn').style.display = 'block';
            document.getElementById('restart-btn').style.display = 'none';
            document.getElementById('voltar-inicio-btn').style.display = 'none';
            document.getElementById('continuar-banco-btn').style.display = 'none';
            document.getElementById('wrong-questions-btn').style.display = 'none';
            document.getElementById('reiniciar-banco-btn').style.display = 'none';
            document.getElementById('new-simulado-btn').style.display = 'none';
            document.getElementById('novo-simulado-reforco-btn').style.display = 'none';
            document.querySelector('.nav-buttons').style.display = 'flex';
            
            currentQuestions = selectRandomQuestions(true);
            
            if (currentQuestions.length === 0) {
                alert("Erro ao gerar novo simulado.");
                return;
            }
            
            userAnswers = new Array(currentQuestions.length).fill(null);
            currentQuestionIndex = 0;
            TIME_LIMIT = calculateTimeLimit(currentQuestions.length);
            timeLeft = TIME_LIMIT;
            autoNavEnabled = true;
            currentSimuladoNumber = 1;
            
            saveCurrentSessionState();
            
            updatePageTitle();
            document.getElementById('timer').textContent = formatTime(timeLeft);
            document.getElementById('auto-nav-checkbox').checked = autoNavEnabled;
            
            startTimer();
            renderCurrentQuestion();
            updateCounters();
            updateNavButtons();
            updateFinishButton();
            updatePendingQuestions();
            updateSimuladoInfo();
            updateReforcoButton();
            updateContinuarBancoButton();
            updateVoltarInicioButton();
            updateNovoSimuladoReforcoButton();
            
            document.getElementById('motivation-message').innerHTML = '';
            document.getElementById('motivation-message').className = 'motivation-message';
            
            alert(`‚úÖ SISTEMA REINICIADO!\n\n${totalQuestions} quest√µes dispon√≠veis.\nBoa sorte!`);
        }
    }
    
    // ============================================
    // FUN√á√ïES DE HIST√ìRICO CORRIGIDAS
    // ============================================

    function clearHistory() {
        if (confirm(`Limpar hist√≥rico completo?`)) {
            usedQuestionsHistory = [];
            localStorage.setItem(HISTORY_KEY, JSON.stringify(usedQuestionsHistory));
            
            wrongQuestionsHistory = [];
            saveWrongQuestionsHistory();
            
            clearSessionData();
            
            document.getElementById('results').style.display = 'none';
            document.getElementById('finish-btn').style.display = 'block';
            document.getElementById('restart-btn').style.display = 'none';
            document.getElementById('voltar-inicio-btn').style.display = 'none';
            document.getElementById('continuar-banco-btn').style.display = 'none';
            document.getElementById('wrong-questions-btn').style.display = 'none';
            document.getElementById('reiniciar-banco-btn').style.display = 'none';
            document.getElementById('new-simulado-btn').style.display = 'none';
            document.getElementById('novo-simulado-reforco-btn').style.display = 'none';
            document.querySelector('.nav-buttons').style.display = 'flex';
            
            currentQuestions = selectRandomQuestions(true);
            
            if (currentQuestions.length === 0) {
                alert("N√£o foi poss√≠vel gerar o simulado.");
                return;
            }
            
            userAnswers = new Array(currentQuestions.length).fill(null);
            currentQuestionIndex = 0;
            TIME_LIMIT = calculateTimeLimit(currentQuestions.length);
            timeLeft = TIME_LIMIT;
            autoNavEnabled = true;
            currentSimuladoNumber = 1;
            
            saveCurrentSessionState();
            
            updatePageTitle();
            document.getElementById('timer').textContent = formatTime(timeLeft);
            document.getElementById('auto-nav-checkbox').checked = autoNavEnabled;
            updateSimuladoInfo();
            renderCurrentQuestion();
            updateCounters();
            updateNavButtons();
            updateFinishButton();
            updatePendingQuestions();
            updateReforcoButton();
            updateContinuarBancoButton();
            updateVoltarInicioButton();
            updateNovoSimuladoReforcoButton();
            
            startTimer();
            
            alert('Hist√≥rico limpo! Novo simulado gerado.');
        }
    }

    // ============================================
    // FUN√á√ÉO GENERATENEWSIMULADO CORRIGIDA
    // ============================================

    function generateNewSimulado() {
        const totalQuestions = masterBank.length;
        const totalAvailable = Math.max(0, totalQuestions - usedQuestionsHistory.length);
        
        let message;
        if (totalAvailable === 0) {
            message = `Todas as quest√µes j√° foram usadas!\n\nDeseja reiniciar o hist√≥rico?`;
        } else if (totalAvailable < QUESTIONS_PER_SIMULADO) {
            message = `S√≥ restam ${totalAvailable} quest√µes.\n\nDeseja fazer simulado com elas?`;
        } else {
            message = `Gerar novo simulado com ${Math.min(QUESTIONS_PER_SIMULADO, totalAvailable)} quest√µes?`;
        }
        
        if (confirm(message)) {
            if (totalAvailable === 0) {
                usedQuestionsHistory = [];
                localStorage.setItem(HISTORY_KEY, JSON.stringify(usedQuestionsHistory));
                alert('Hist√≥rico reiniciado!');
            }
            
            document.getElementById('results').style.display = 'none';
            document.getElementById('finish-btn').style.display = 'block';
            document.getElementById('restart-btn').style.display = 'none';
            document.getElementById('voltar-inicio-btn').style.display = 'none';
            document.getElementById('continuar-banco-btn').style.display = 'none';
            document.getElementById('wrong-questions-btn').style.display = 'none';
            document.getElementById('reiniciar-banco-btn').style.display = 'none';
            document.getElementById('new-simulado-btn').style.display = 'none';
            document.getElementById('novo-simulado-reforco-btn').style.display = 'none';
            document.querySelector('.nav-buttons').style.display = 'flex';
            
            currentQuestions = selectRandomQuestions(false);
            
            if (currentQuestions.length === 0) {
                alert("Erro ao gerar simulado.");
                return;
            }
            
            const newSessionId = 'session_' + Date.now();
            sessionStorage.setItem(SESSION_ID_KEY, newSessionId);
            
            userAnswers = new Array(currentQuestions.length).fill(null);
            currentQuestionIndex = 0;
            TIME_LIMIT = calculateTimeLimit(currentQuestions.length);
            timeLeft = TIME_LIMIT;
            autoNavEnabled = true;
            
            saveCurrentSessionState();
            
            updatePageTitle();
            document.getElementById('timer').textContent = formatTime(timeLeft);
            document.getElementById('auto-nav-checkbox').checked = autoNavEnabled;
            startTimer();
            renderCurrentQuestion();
            updateCounters();
            updateNavButtons();
            updateFinishButton();
            updatePendingQuestions();
            updateSimuladoInfo();
            updateReforcoButton();
            updateContinuarBancoButton();
            updateVoltarInicioButton();
            updateNovoSimuladoReforcoButton();
        }
    }

    // ============================================
    // FUN√á√ÉO STARTSIMULADOFROMBANCO CORRIGIDA
    // ============================================

    function startNewSimuladoFromResults() {
        document.getElementById('results').style.display = 'none';
        document.getElementById('finish-btn').style.display = 'block';
        document.getElementById('restart-btn').style.display = 'none';
        document.getElementById('voltar-inicio-btn').style.display = 'none';
        document.getElementById('continuar-banco-btn').style.display = 'none';
        document.getElementById('wrong-questions-btn').style.display = 'none';
        document.getElementById('reiniciar-banco-btn').style.display = 'none';
        document.getElementById('new-simulado-btn').style.display = 'none';
        document.getElementById('novo-simulado-reforco-btn').style.display = 'none';
        document.querySelector('.nav-buttons').style.display = 'flex';
        
        currentQuestions = selectRandomQuestions(false);
        
        if (currentQuestions.length === 0) {
            alert("N√£o foi poss√≠vel gerar novo simulado.");
            return;
        }
        
        const newSessionId = 'session_' + Date.now();
        sessionStorage.setItem(SESSION_ID_KEY, newSessionId);
        
        userAnswers = new Array(currentQuestions.length).fill(null);
        currentQuestionIndex = 0;
        TIME_LIMIT = calculateTimeLimit(currentQuestions.length);
        timeLeft = TIME_LIMIT;
        autoNavEnabled = true;
        
        saveCurrentSessionState();
        
        updatePageTitle();
        document.getElementById('timer').textContent = formatTime(timeLeft);
        document.getElementById('auto-nav-checkbox').checked = autoNavEnabled;
        startTimer();
        renderCurrentQuestion();
        updateCounters();
        updateNavButtons();
        updateFinishButton();
        updatePendingQuestions();
        updateSimuladoInfo();
        updateReforcoButton();
        updateContinuarBancoButton();
        updateVoltarInicioButton();
        updateNovoSimuladoReforcoButton();
        
        const totalQuestions = masterBank.length;
        const remainingQuestions = Math.max(0, totalQuestions - usedQuestionsHistory.length);
        alert(`‚úÖ NOVO SIMULADO INICIADO!\n\n${currentQuestions.length} quest√µes selecionadas.\n\nRestam ${remainingQuestions} quest√µes no banco.`);
    }
    
    // ============================================
    // FUN√á√ÉO: ATUALIZAR BOT√ÉO VOLTAR AO IN√çCIO
    // ============================================
    
    function updateVoltarInicioButton() {
        const voltarBtn = document.getElementById('voltar-inicio-btn');
        if (!voltarBtn) return;
        
        const isReforco = currentQuestions[0]?.isWrongQuestion;
        const isResultsVisible = document.getElementById('results').style.display === 'block';
        const percent = parseInt(document.getElementById('final-percent')?.textContent?.replace('%', '') || 0);
        
        if (isReforco && isResultsVisible && percent >= MIN_PERCENT_FOR_SUCCESS) {
            voltarBtn.style.display = 'block';
            voltarBtn.innerHTML = `üèÅ Voltar ao In√≠cio (Limpar Tudo)`;
        } else {
            voltarBtn.style.display = 'none';
        }
    }
    
    // ============================================
    // CORRE√á√ÉO PRINCIPAL: FUN√á√ÉO UPDATESIMULADOINFO
    // ============================================
    
    function updateSimuladoInfo() {
        const totalQuestions = masterBank.length;
        
        const currentQuestionsCount = currentQuestions ? currentQuestions.length : 0;
        
        let remaining = 0;
        if (currentQuestions && currentQuestions[0]?.isWrongQuestion) {
            const wrongCount = wrongQuestionsHistory.length;
            const successRate = Math.round(((totalQuestions - wrongCount) / totalQuestions) * 100);
            
            document.getElementById('simulado-info').innerHTML = `
                <div style="color: var(--danger); font-weight: bold; text-align: center;">‚ö° SIMULADO DE REFOR√áO</div>
                <div style="text-align: center; font-size: 0.6rem;">Quest√µes que voc√™ errou anteriormente</div>
                <div class="simulado-stats">
                    <span>Quest√µes: ${currentQuestionsCount}</span>
                    <span>Acertos gerais: ${successRate}%</span>
                </div>
            `;
            document.getElementById('simulado-info').style.display = 'block';
            return;
        }
        
        const uniqueUsed = [...new Set(usedQuestionsHistory)];
        const recentUsed = uniqueUsed.length;
        remaining = Math.max(0, totalQuestions - recentUsed);
        const percentUsed = totalQuestions > 0 ? Math.round((recentUsed / totalQuestions) * 100) : 0;
        
        let simuladoNumberText = '';
        if (totalSimulados > 1) {
            const simuladoAtual = Math.min(currentSimuladoNumber, totalSimulados);
            simuladoNumberText = ` (${simuladoAtual}/${totalSimulados})`;
        }
        
        document.getElementById('simulado-info').innerHTML = `
            <div>Simulado${simuladoNumberText}: <span id="questions-per-simulado">${currentQuestionsCount}</span> quest√µes</div>
            <div class="simulado-stats">
                <span id="remaining-questions">Dispon√≠veis: ${remaining}</span>
                <span id="recent-used">Usadas: ${recentUsed} (${percentUsed}%)</span>
            </div>
            
            <div class="history-controls">
                <button class="clear-history-btn" onclick="clearHistory()">üóëÔ∏è Limpar Hist√≥rico</button>
                <button class="info-history-btn" onclick="showHistoryInfo()">‚ÑπÔ∏è Info</button>
            </div>
        `;
        document.getElementById('simulado-info').style.display = 'block';
        
        const questionsPerSimuladoEl = document.getElementById('questions-per-simulado');
        const remainingQuestionsEl = document.getElementById('remaining-questions');
        const recentUsedEl = document.getElementById('recent-used');
        
        if (questionsPerSimuladoEl) questionsPerSimuladoEl.textContent = currentQuestionsCount;
        if (remainingQuestionsEl) remainingQuestionsEl.textContent = `Dispon√≠veis: ${remaining}`;
        if (recentUsedEl) recentUsedEl.textContent = `Usadas: ${recentUsed} (${percentUsed}%)`;
    }
    
    // ============================================
    // CORRE√á√ÉO: FUN√á√ÉO UPDATECONTINUARBANCOBUTTON
    // ============================================
    
    function updateContinuarBancoButton() {
        const continuarBtn = document.getElementById('continuar-banco-btn');
        if (!continuarBtn) return;
        
        const totalQuestions = masterBank.length;
        const uniqueUsed = [...new Set(usedQuestionsHistory)];
        const remainingQuestions = Math.max(0, totalQuestions - uniqueUsed.length);
        
        const isResultsVisible = document.getElementById('results').style.display === 'block';
        const isReforco = currentQuestions[0]?.isWrongQuestion;
        const percent = parseInt(document.getElementById('final-percent')?.textContent?.replace('%', '') || 0);
        
        if (isResultsVisible && !isReforco && remainingQuestions > 0) {
            continuarBtn.style.display = 'block';
            continuarBtn.innerHTML = `üìö Continuar com Banco (${remainingQuestions} restantes)`;
        } else if (isResultsVisible && isReforco && percent >= MIN_PERCENT_FOR_SUCCESS) {
            continuarBtn.style.display = 'block';
            continuarBtn.innerHTML = `üìö Voltar ao Banco (${remainingQuestions} restantes)`;
        } else {
            continuarBtn.style.display = 'none';
        }
    }
    
    // ============================================
    // FUN√á√ÉO: START WRONG QUESTIONS SIMULADO
    // ============================================
    
    function startWrongQuestionsSimulado() {
        console.log('Iniciando simulado de refor√ßo...');
        
        currentQuestions = generateWrongQuestionsSimulado();
        
        if (currentQuestions.length === 0) {
            alert('N√£o h√° quest√µes erradas para fazer o simulado de refor√ßo.');
            updateReforcoButton();
            return;
        }
        
        currentSimuladoNumber = totalSimulados + 1;
        
        userAnswers = new Array(currentQuestions.length).fill(null);
        currentQuestionIndex = 0;
        TIME_LIMIT = calculateTimeLimit(currentQuestions.length);
        timeLeft = TIME_LIMIT;
        autoNavEnabled = true;
        
        saveCurrentSessionState();
        
        updatePageTitle();
        document.getElementById('timer').textContent = formatTime(timeLeft);
        document.getElementById('auto-nav-checkbox').checked = autoNavEnabled;
        
        document.getElementById('results').style.display = 'none';
        document.getElementById('finish-btn').style.display = 'block';
        document.getElementById('restart-btn').style.display = 'none';
        document.getElementById('voltar-inicio-btn').style.display = 'none';
        document.getElementById('continuar-banco-btn').style.display = 'none';
        document.getElementById('wrong-questions-btn').style.display = 'none';
        document.getElementById('reiniciar-banco-btn').style.display = 'none';
        document.getElementById('new-simulado-btn').style.display = 'none';
        document.getElementById('novo-simulado-reforco-btn').style.display = 'none';
        document.querySelector('.nav-buttons').style.display = 'flex';
        
        const wrongCount = wrongQuestionsHistory.length;
        const totalQuestions = masterBank.length;
        const successRate = Math.round(((totalQuestions - wrongCount) / totalQuestions) * 100);
        
        document.getElementById('simulado-info').innerHTML = `
            <div style="color: var(--danger); font-weight: bold; text-align: center;">‚ö° SIMULADO DE REFOR√áO</div>
            <div style="text-align: center; font-size: 0.6rem;">Quest√µes que voc√™ errou anteriormente</div>
            <div class="simulado-stats">
                <span>Quest√µes: ${currentQuestions.length}</span>
                <span>Acertos anteriores: ${successRate}%</span>
            </div>
        `;
        document.getElementById('simulado-info').style.display = 'block';
        
        startTimer();
        renderCurrentQuestion();
        updateCounters();
        updateNavButtons();
        updateFinishButton();
        updatePendingQuestions();
        
        updateReforcoButton();
        updateReiniciarBancoButton();
        updateContinuarBancoButton();
        updateVoltarInicioButton();
        updateNovoSimuladoReforcoButton();
        
        alert(`üéØ SIMULADO DE REFOR√áO INICIADO!\n\n${currentQuestions.length} quest√µes que voc√™ errou anteriormente.\nBoa sorte!`);
    }
    
    // ============================================
    // FUN√á√ÉO: UPDATE REFORCO BUTTON
    // ============================================
    
    function updateReforcoButton() {
        const wrongBtn = document.getElementById('wrong-questions-btn');
        if (!wrongBtn) return;
        
        const hasEnough = hasEnoughWrongQuestionsForSimulado();
        const isReforcoActive = currentQuestions[0]?.isWrongQuestion;
        const isResultsVisible = document.getElementById('results').style.display === 'block';
        
        if (hasEnough && !isReforcoActive && isResultsVisible) {
            wrongBtn.style.display = 'block';
            wrongBtn.innerHTML = `‚ö° Simulado de Refor√ßo (${wrongQuestionsHistory.length})`;
        } else {
            wrongBtn.style.display = 'none';
        }
    }
    
    // ============================================
    // FUN√á√ÉO: UPDATE REINICIAR BANCO BUTTON
    // ============================================
    
    function updateReiniciarBancoButton() {
        const reiniciarBtn = document.getElementById('reiniciar-banco-btn');
        if (!reiniciarBtn) return;
        
        const isReforco = currentQuestions[0]?.isWrongQuestion;
        const isResultsVisible = document.getElementById('results').style.display === 'block';
        const percent = parseInt(document.getElementById('final-percent')?.textContent?.replace('%', '') || 0);
        
        if (isReforco && isResultsVisible && percent < MIN_PERCENT_FOR_SUCCESS) {
            reiniciarBtn.style.display = 'block';
            reiniciarBtn.innerHTML = `üîÑ Reiniciar Banco (${masterBank.length} quest√µes)`;
        } else {
            reiniciarBtn.style.display = 'none';
        }
    }
    
    // ============================================
    // FUN√á√ÉO: REINICIAR BANCO COMPLETO
    // ============================================
    
    function reiniciarBancoCompleto() {
        const totalQuestions = masterBank.length;
        const wrongCount = wrongQuestionsHistory.length;
        
        let message = `üîÑ REINICIAR BANCO COMPLETO\n\n`;
        message += `Voc√™ n√£o atingiu 70% no simulado de refor√ßo.\n\n`;
        message += `Esta a√ß√£o vai:\n`;
        message += `‚Ä¢ Limpar TODO o hist√≥rico (${usedQuestionsHistory.length} quest√µes usadas)\n`;
        message += `‚Ä¢ Limpar TODO o hist√≥rico de erros (${wrongCount} quest√µes)\n`;
        message += `‚Ä¢ Reiniciar o progresso do ZERO\n\n`;
        message += `Deseja reiniciar completamente?`;
        
        if (confirm(message)) {
            usedQuestionsHistory = [];
            localStorage.setItem(HISTORY_KEY, JSON.stringify(usedQuestionsHistory));
            
            wrongQuestionsHistory = [];
            saveWrongQuestionsHistory();
            
            localStorage.removeItem(LAST_OFFER_KEY);
            
            clearSessionData();
            
            document.getElementById('results').style.display = 'none';
            document.getElementById('finish-btn').style.display = 'block';
            document.getElementById('restart-btn').style.display = 'none';
            document.getElementById('voltar-inicio-btn').style.display = 'none';
            document.getElementById('continuar-banco-btn').style.display = 'none';
            document.getElementById('wrong-questions-btn').style.display = 'none';
            document.getElementById('reiniciar-banco-btn').style.display = 'none';
            document.getElementById('new-simulado-btn').style.display = 'none';
            document.getElementById('novo-simulado-reforco-btn').style.display = 'none';
            document.querySelector('.nav-buttons').style.display = 'flex';
            
            currentQuestions = selectRandomQuestions(true);
            
            if (currentQuestions.length === 0) {
                alert("Erro ao gerar novo simulado.");
                return;
            }
            
            userAnswers = new Array(currentQuestions.length).fill(null);
            currentQuestionIndex = 0;
            TIME_LIMIT = calculateTimeLimit(currentQuestions.length);
            timeLeft = TIME_LIMIT;
            autoNavEnabled = true;
            currentSimuladoNumber = 1;
            
            saveCurrentSessionState();
            
            updatePageTitle();
            document.getElementById('timer').textContent = formatTime(timeLeft);
            document.getElementById('auto-nav-checkbox').checked = autoNavEnabled;
            
            startTimer();
            renderCurrentQuestion();
            updateCounters();
            updateNavButtons();
            updateFinishButton();
            updatePendingQuestions();
            updateSimuladoInfo();
            updateReforcoButton();
            updateContinuarBancoButton();
            updateVoltarInicioButton();
            updateNovoSimuladoReforcoButton();
            
            document.getElementById('motivation-message').innerHTML = '';
            document.getElementById('motivation-message').className = 'motivation-message';
            
            alert(`‚úÖ BANCO REINICIADO!\n\n${totalQuestions} quest√µes dispon√≠veis.\nBoa sorte!`);
        }
    }
    
    // ============================================
    // FUN√á√ÉO RESETQUIZ CORRIGIDA
    // ============================================
    
    function resetQuiz() {
        if (confirm('Reiniciar este simulado?')) {
            userAnswers = new Array(currentQuestions.length).fill(null);
            timeLeft = TIME_LIMIT;
            currentQuestionIndex = 0;
            
            document.getElementById('results').style.display = 'none';
            document.getElementById('finish-btn').style.display = 'block';
            document.getElementById('restart-btn').style.display = 'none';
            document.getElementById('voltar-inicio-btn').style.display = 'none';
            document.getElementById('continuar-banco-btn').style.display = 'none';
            document.getElementById('wrong-questions-btn').style.display = 'none';
            document.getElementById('reiniciar-banco-btn').style.display = 'none';
            document.getElementById('new-simulado-btn').style.display = 'none';
            document.getElementById('novo-simulado-reforco-btn').style.display = 'none';
            document.querySelector('.nav-buttons').style.display = 'flex';
            
            document.getElementById('quiz-content').innerHTML = '';
            
            saveCurrentSessionState();
            
            startTimer();
            renderCurrentQuestion();
            updateCounters();
            updateNavButtons();
            updateFinishButton();
            updatePendingQuestions();
            updateContinuarBancoButton();
            updateVoltarInicioButton();
            updateNovoSimuladoReforcoButton();
        }
    }
    
    // ============================================
    // FUN√á√ÉO STARTNEWQUIZ CORRIGIDA
    // ============================================
    
    function startNewQuiz() {
        document.getElementById('results').style.display = 'none';
        document.getElementById('finish-btn').style.display = 'block';
        document.getElementById('restart-btn').style.display = 'none';
        document.getElementById('voltar-inicio-btn').style.display = 'none';
        document.getElementById('continuar-banco-btn').style.display = 'none';
        document.getElementById('wrong-questions-btn').style.display = 'none';
        document.getElementById('reiniciar-banco-btn').style.display = 'none';
        document.getElementById('new-simulado-btn').style.display = 'none';
        document.getElementById('novo-simulado-reforco-btn').style.display = 'none';
        document.querySelector('.nav-buttons').style.display = 'flex';
        
        document.getElementById('quiz-content').innerHTML = '';
        
        userAnswers = new Array(currentQuestions.length).fill(null);
        timeLeft = TIME_LIMIT;
        currentQuestionIndex = 0;
        
        saveCurrentSessionState();
        
        startTimer();
        renderCurrentQuestion();
        updateCounters();
        updateNavButtons();
        updateFinishButton();
        updatePendingQuestions();
        updateContinuarBancoButton();
        updateVoltarInicioButton();
        updateNovoSimuladoReforcoButton();
    }
    
    // ============================================
    // RESTANTE DAS FUN√á√ïES EXISTENTES
    // ============================================
    
    function loadWrongQuestionsHistory() {
        const saved = localStorage.getItem(WRONG_QUESTIONS_KEY);
        if (saved) {
            try {
                wrongQuestionsHistory = JSON.parse(saved);
                console.log(`Hist√≥rico de quest√µes erradas carregado: ${wrongQuestionsHistory.length} quest√µes`);
            } catch (e) {
                console.error('Erro ao carregar hist√≥rico de quest√µes erradas:', e);
                wrongQuestionsHistory = [];
            }
        } else {
            wrongQuestionsHistory = [];
            console.log('Nenhum hist√≥rico de quest√µes erradas encontrado');
        }
    }
    
    function saveWrongQuestionsHistory() {
        localStorage.setItem(WRONG_QUESTIONS_KEY, JSON.stringify(wrongQuestionsHistory));
    }
    
    function addWrongQuestionsToHistory() {
        if (!currentQuestions || currentQuestions.length === 0) return;
        
        currentQuestions.forEach((question, index) => {
            const userAnswer = userAnswers[index];
            const isCorrect = userAnswer !== null && userAnswer === question.c;
            
            if (!isCorrect && question.originalIndex !== undefined) {
                if (!wrongQuestionsHistory.includes(question.originalIndex)) {
                    wrongQuestionsHistory.push(question.originalIndex);
                }
            }
        });
        
        wrongQuestionsHistory = [...new Set(wrongQuestionsHistory)];
        saveWrongQuestionsHistory();
        
        console.log(`Quest√µes erradas adicionadas ao hist√≥rico. Total: ${wrongQuestionsHistory.length}`);
    }
    
    function removeCorrectQuestionsFromHistory() {
        const initialCount = wrongQuestionsHistory.length;
        
        if (!currentQuestions || currentQuestions.length === 0) return;
        
        currentQuestions.forEach((question, index) => {
            const userAnswer = userAnswers[index];
            const isCorrect = userAnswer !== null && userAnswer === question.c;
            
            if (isCorrect && question.originalIndex !== undefined) {
                const indexInHistory = wrongQuestionsHistory.indexOf(question.originalIndex);
                if (indexInHistory !== -1) {
                    wrongQuestionsHistory.splice(indexInHistory, 1);
                }
            }
        });
        
        saveWrongQuestionsHistory();
        
        console.log(`Quest√µes removidas do hist√≥rico de erradas: ${initialCount - wrongQuestionsHistory.length}`);
    }
    
    function allQuestionsUsed() {
        const totalQuestions = masterBank.length;
        const uniqueUsed = [...new Set(usedQuestionsHistory)];
        return uniqueUsed.length >= totalQuestions;
    }
    
    function hasEnoughWrongQuestionsForSimulado() {
        return wrongQuestionsHistory.length >= MIN_WRONG_QUESTIONS_FOR_SIMULADO;
    }
    
    function canOfferReforcoSimulado() {
        const condition1 = hasEnoughWrongQuestionsForSimulado();
        const condition2 = !currentQuestions[0]?.isWrongQuestion;
        const condition3 = !hasRecentOffer();
        
        return condition1 && condition2 && condition3;
    }
    
    function hasRecentOffer() {
        const lastOffer = localStorage.getItem(LAST_OFFER_KEY);
        if (!lastOffer) return false;
        
        const now = Date.now();
        const lastOfferTime = parseInt(lastOffer);
        const TWO_HOURS_MS = 2 * 60 * 60 * 1000;
        
        return (now - lastOfferTime) < TWO_HOURS_MS;
    }
    
    function saveOfferTimestamp() {
        localStorage.setItem(LAST_OFFER_KEY, Date.now().toString());
    }
    
    function isNewSession() {
        const sessionId = sessionStorage.getItem(SESSION_ID_KEY);
        const simuladoStarted = sessionStorage.getItem(SIMULADO_STARTED_KEY);
        
        if (!sessionId || !simuladoStarted) {
            const newSessionId = 'session_' + Date.now();
            sessionStorage.setItem(SESSION_ID_KEY, newSessionId);
            sessionStorage.setItem(SIMULADO_STARTED_KEY, 'true');
            return true;
        }
        return false;
    }
    
    function clearSessionData() {
        sessionStorage.removeItem(CURRENT_QUESTIONS_KEY);
        sessionStorage.removeItem(CURRENT_QUESTION_INDEX_KEY);
        sessionStorage.removeItem(USER_ANSWERS_KEY);
        sessionStorage.removeItem(TIME_LEFT_KEY);
        sessionStorage.removeItem(AUTO_NAV_KEY);
        sessionStorage.removeItem(SIMULADO_STARTED_KEY);
        sessionStorage.removeItem(CURRENT_SIMULADO_NUMBER_KEY);
    }
    
    function saveCurrentSessionState() {
        try {
            sessionStorage.setItem(CURRENT_QUESTIONS_KEY, JSON.stringify(currentQuestions));
            sessionStorage.setItem(CURRENT_QUESTION_INDEX_KEY, currentQuestionIndex.toString());
            sessionStorage.setItem(USER_ANSWERS_KEY, JSON.stringify(userAnswers));
            sessionStorage.setItem(TIME_LEFT_KEY, timeLeft.toString());
            sessionStorage.setItem(AUTO_NAV_KEY, autoNavEnabled.toString());
            sessionStorage.setItem(SIMULADO_STARTED_KEY, 'true');
            sessionStorage.setItem(CURRENT_SIMULADO_NUMBER_KEY, currentSimuladoNumber.toString());
        } catch (e) {
            console.error('Erro ao salvar estado da sess√£o:', e);
        }
    }
    
    function loadCurrentSessionState() {
        try {
            const savedQuestions = sessionStorage.getItem(CURRENT_QUESTIONS_KEY);
            const savedIndex = sessionStorage.getItem(CURRENT_QUESTION_INDEX_KEY);
            const savedAnswers = sessionStorage.getItem(USER_ANSWERS_KEY);
            const savedTime = sessionStorage.getItem(TIME_LEFT_KEY);
            const savedAutoNav = sessionStorage.getItem(AUTO_NAV_KEY);
            const savedSimuladoNumber = sessionStorage.getItem(CURRENT_SIMULADO_NUMBER_KEY);
            
            if (savedQuestions) currentQuestions = JSON.parse(savedQuestions);
            if (savedIndex) currentQuestionIndex = parseInt(savedIndex);
            if (savedAnswers) userAnswers = JSON.parse(savedAnswers);
            if (savedTime) timeLeft = parseInt(savedTime);
            if (savedAutoNav) autoNavEnabled = savedAutoNav === 'true';
            if (savedSimuladoNumber) currentSimuladoNumber = parseInt(savedSimuladoNumber);
            
            return {
                hasQuestions: !!savedQuestions,
                hasState: !!(savedQuestions && savedIndex !== null)
            };
        } catch (e) {
            console.error('Erro ao carregar estado da sess√£o:', e);
            return { hasQuestions: false, hasState: false };
        }
    }
    
    function generateQuizId() {
        const pageTitle = document.title || "Quiz";
        const cleanTitle = pageTitle
            .replace(/[^a-zA-Z0-9\s]/g, '')
            .replace(/\s+/g, '_')
            .toLowerCase()
            .substring(0, 30);
        const titleHash = pageTitle.length.toString(36);
        return `quiz_${cleanTitle}_${titleHash}`;
    }
    
    const QUIZ_ID = generateQuizId();
    const HISTORY_KEY = `${QUIZ_ID}_history`;
    const REPORTS_KEY = `${QUIZ_ID}_reports`;
    
    function updatePageTitle() {
        const totalQuestions = masterBank.length;
        let simuladoText = '';
        
        if (currentQuestions && currentQuestions[0]?.isWrongQuestion) {
            simuladoText = ' (‚ö° Refor√ßo)';
        } else if (totalSimulados > 1) {
            simuladoText = ` (Simulado ${currentSimuladoNumber}/${totalSimulados})`;
        }
        
        const pageTitle = document.title || "Quiz Simulado";
        let cleanTitle = pageTitle
            .replace(/^GMP\s*[-‚Äì‚Äî]\s*/i, '')
            .replace(/^Simulado\s*[-‚Äì‚Äî]\s*/i, '')
            .replace(/^Quiz\s*[-‚Äì‚Äî]\s*/i, '')
            .replace(/\s*[-‚Äì‚Äî]\s*Simulado$/i, '')
            .replace(/\s*[-‚Äì‚Äî]\s*Quiz$/i, '')
            .replace(/\s*[-‚Äì‚Äî]\s*Teste$/i, '')
            .trim();
        
        if (!cleanTitle) cleanTitle = pageTitle;
        if (cleanTitle.length > 40) cleanTitle = cleanTitle.substring(0, 37) + '...';
        
        const questionCount = currentQuestions ? currentQuestions.length : 0;
        document.getElementById('page-title').textContent = 
            `${cleanTitle}${simuladoText} (${questionCount}/${totalQuestions})`;
    }
    
    function calculateTimeLimit(questionsCount) {
        return questionsCount * 60;
    }
    
    function formatTime(seconds) {
        const mins = Math.floor(seconds / 60);
        const secs = seconds % 60;
        return `${mins}:${secs.toString().padStart(2, '0')}`;
    }
    
    function shuffleArray(array) {
        const shuffled = [...array];
        for (let i = shuffled.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
        }
        return shuffled;
    }
    
    function showHistoryInfo() {
        const totalQuestions = masterBank.length;
        const uniqueUsed = [...new Set(usedQuestionsHistory)];
        const usedCount = uniqueUsed.length;
        const availableCount = Math.max(0, totalQuestions - usedCount);
        const percentUsed = totalQuestions > 0 ? Math.round((usedCount / totalQuestions) * 100) : 0;
        const wrongCount = wrongQuestionsHistory.length;
        
        let message = `üìä ESTAT√çSTICAS:\n\n`;
        message += `‚Ä¢ Total: ${totalQuestions} quest√µes\n`;
        message += `‚Ä¢ Usadas: ${usedCount} (${percentUsed}%)\n`;
        message += `‚Ä¢ Dispon√≠veis: ${availableCount}\n`;
        message += `‚Ä¢ Erradas: ${wrongCount}\n`;
        
        if (currentQuestions && currentQuestions[0]?.isWrongQuestion) {
            message += `\n‚ö° SIMULADO DE REFOR√áO ATIVO\n`;
        }
        
        if (wrongCount >= MIN_WRONG_QUESTIONS_FOR_SIMULADO) {
            message += `\n‚ö° SIMULADO DE REFOR√áO DISPON√çVEL\n`;
            message += `‚Ä¢ ${wrongCount} quest√µes para revisar\n`;
        }
        
        alert(message);
    }
    
    function updatePendingQuestions() {
        const pendingList = document.getElementById('pending-list');
        const pendingCount = document.getElementById('pending-count');
        const answeredCount = getAnsweredCount();
        const pending = currentQuestions ? currentQuestions.length - answeredCount : 0;
        
        if (pendingCount) pendingCount.textContent = pending;
        
        if (pending === 0) {
            if (pendingList) pendingList.innerHTML = '<span style="color: #28a745;">‚úÖ Todas</span>';
            return;
        }
        
        let html = '';
        let pendingNumbers = [];
        
        if (currentQuestions) {
            for (let i = 0; i < currentQuestions.length; i++) {
                if (userAnswers[i] === null) {
                    pendingNumbers.push(i + 1);
                }
            }
        }
        
        const maxToShow = 10;
        const numbersToShow = pendingNumbers.slice(0, maxToShow);
        
        numbersToShow.forEach(num => {
            html += `<span class="pending-number">${num}</span>`;
        });
        
        if (pendingNumbers.length > maxToShow) {
            html += `<span style="color: #6c757d; font-size: 0.55rem;"> +${pendingNumbers.length - maxToShow}</span>`;
        }
        
        if (pendingList) {
            pendingList.innerHTML = html || '<span style="color: #6c757d;">Nenhuma</span>';
        }
    }
    
    // ============================================
    // FUN√á√ÉO INITQUIZ ATUALIZADA
    // ============================================

    function initQuiz() {
        loadWrongQuestionsHistory();
        
        if (masterBank.length === 0) {
            document.getElementById('page-title').textContent = "‚ö†Ô∏è BANCO VAZIO";
            document.getElementById('quiz-content').innerHTML = `
                <div class="question-block-mini">
                    <div class="question-text-mini" style="color: var(--danger);">
                        ‚ö†Ô∏è ERRO: Banco de quest√µes vazio!
                    </div>
                </div>
            `;
            return;
        }
        
        const config = calcularConfiguracaoSimulados();
        console.log('Configura√ß√£o:', config.mensagem);
        totalSimulados = config.totalSimulados;
        QUESTIONS_PER_SIMULADO = config.questionsPerSimulado;
        
        const savedHistory = localStorage.getItem(HISTORY_KEY);
        if (savedHistory) {
            try {
                usedQuestionsHistory = JSON.parse(savedHistory);
            } catch (e) {
                console.error('Erro ao carregar hist√≥rico:', e);
                usedQuestionsHistory = [];
            }
        } else {
            usedQuestionsHistory = [];
        }
        
        if (isNewSession()) {
            console.log('Nova sess√£o - gerando quest√µes');
            currentQuestions = selectRandomQuestions();
            
            if (currentQuestions.length === 0) {
                alert("N√£o foi poss√≠vel selecionar quest√µes.");
                return;
            }
            
            userAnswers = new Array(currentQuestions.length).fill(null);
            currentQuestionIndex = 0;
            TIME_LIMIT = calculateTimeLimit(currentQuestions.length);
            timeLeft = TIME_LIMIT;
            autoNavEnabled = true;
            
            saveCurrentSessionState();
        } else {
            console.log('Sess√£o existente - restaurando');
            const state = loadCurrentSessionState();
            
            if (state.hasQuestions && state.hasState) {
                console.log('Estado restaurado');
                if (timeLeft <= 0) {
                    TIME_LIMIT = calculateTimeLimit(currentQuestions.length);
                    timeLeft = TIME_LIMIT;
                }
            } else {
                console.log('N√£o h√° estado - gerando novo');
                currentQuestions = selectRandomQuestions();
                if (currentQuestions.length === 0) {
                    alert("N√£o foi poss√≠vel gerar o simulado.");
                    return;
                }
                
                userAnswers = new Array(currentQuestions.length).fill(null);
                currentQuestionIndex = 0;
                TIME_LIMIT = calculateTimeLimit(currentQuestions.length);
                timeLeft = TIME_LIMIT;
                autoNavEnabled = true;
                
                saveCurrentSessionState();
            }
        }
        
        updatePageTitle();
        document.getElementById('timer').textContent = formatTime(timeLeft);
        document.getElementById('auto-nav-checkbox').checked = autoNavEnabled;
        
        updateSimuladoInfo();
        startTimer();
        renderCurrentQuestion();
        updateCounters();
        updateNavButtons();
        updateFinishButton();
        updatePendingQuestions();
        updateReforcoButton();
        updateReiniciarBancoButton();
        updateContinuarBancoButton();
        updateVoltarInicioButton();
        updateNovoSimuladoReforcoButton();
    }
    
    function selectAnswer(answerIndex) {
        userAnswers[currentQuestionIndex] = answerIndex;
        saveCurrentSessionState();
        
        updateCounters();
        updateFinishButton();
        updatePendingQuestions();
        
        if (autoNavEnabled && currentQuestionIndex < currentQuestions.length - 1) {
            setTimeout(() => {
                nextQuestion();
            }, 200);
        }
    }
    
    function toggleAutoNav() {
        autoNavEnabled = !autoNavEnabled;
        document.getElementById('auto-nav-checkbox').checked = autoNavEnabled;
        saveCurrentSessionState();
    }
    
    function getAnsweredCount() {
        return userAnswers.filter(answer => answer !== null).length;
    }
    
    function updateFinishButton() {
        const finishBtn = document.getElementById('finish-btn');
        const answeredCount = getAnsweredCount();
        const allAnswered = currentQuestions && answeredCount === currentQuestions.length;
        
        finishBtn.disabled = !allAnswered;
        finishBtn.innerHTML = allAnswered ? 'üèÅ Finalizar' : `‚ùå Faltam ${currentQuestions ? currentQuestions.length - answeredCount : 0}`;
    }
    
    function updateNavButtons() {
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        
        prevBtn.disabled = currentQuestionIndex === 0;
        nextBtn.disabled = currentQuestions ? currentQuestionIndex === currentQuestions.length - 1 : true;
        nextBtn.innerHTML = currentQuestions && currentQuestionIndex === currentQuestions.length - 1 ? '√öltima' : 'Pr√≥ximo ‚Üí';
    }
    
    function updateCounters() {
        const answeredCount = getAnsweredCount();
        const totalQuestions = currentQuestions ? currentQuestions.length : 0;
        
        document.getElementById('question-counter').textContent = `${currentQuestionIndex + 1}/${totalQuestions}`;
        document.getElementById('answered-counter').textContent = `${answeredCount}/${totalQuestions}`;
        document.getElementById('progress-percent').textContent = `${totalQuestions > 0 ? Math.round((answeredCount / totalQuestions) * 100) : 0}%`;
        document.getElementById('status-count').textContent = `${answeredCount}/${totalQuestions}`;
        
        updateTimerDisplay();
    }
    
    function updateTimerDisplay() {
        const timerElement = document.getElementById('timer');
        timerElement.textContent = formatTime(timeLeft);
        
        if (timeLeft <= Math.min(300, Math.floor(TIME_LIMIT * 0.25))) {
            timerElement.classList.add('timer-warning');
        } else {
            timerElement.classList.remove('timer-warning');
        }
    }
    
    function startTimer() {
        clearInterval(timerId);
        
        timerId = setInterval(() => {
            timeLeft--;
            
            if (timeLeft % 5 === 0) {
                saveCurrentSessionState();
            }
            
            updateTimerDisplay();
            
            if (timeLeft <= 0) {
                clearInterval(timerId);
                if (getAnsweredCount() === currentQuestions.length) {
                    finalizeQuiz();
                } else {
                    if (confirm('Tempo esgotado! Finalizar?')) {
                        finalizeQuiz();
                    }
                }
            }
        }, 1000);
    }
    
    function nextQuestion() {
        if (currentQuestions && currentQuestionIndex < currentQuestions.length - 1) {
            currentQuestionIndex++;
            saveCurrentSessionState();
            renderCurrentQuestion();
            updateCounters();
            updateNavButtons();
        }
    }
    
    function prevQuestion() {
        if (currentQuestionIndex > 0) {
            currentQuestionIndex--;
            saveCurrentSessionState();
            renderCurrentQuestion();
            updateCounters();
            updateNavButtons();
        }
    }
    
    // ============================================
    // SISTEMA DE REPORTE - CORRIGIDO
    // ============================================
    
    function initReportSystem() {
        const savedReports = localStorage.getItem(REPORTS_KEY);
        if (savedReports) {
            reportsHistory = JSON.parse(savedReports);
        } else {
            reportsHistory = [];
        }
        
        document.getElementById('cancelReport').addEventListener('click', closeReportModal);
        document.getElementById('submitReport').addEventListener('click', submitReport);
        
        document.getElementById('reportModal').addEventListener('click', function(e) {
            if (e.target.id === 'reportModal') {
                closeReportModal();
            }
        });
        
        const reportDetails = document.getElementById('reportDetails');
        const charCount = document.getElementById('charCount');
        
        if (reportDetails && charCount) {
            reportDetails.addEventListener('input', function() {
                charCount.textContent = this.value.length;
                if (this.value.length > 1000) {
                    this.value = this.value.substring(0, 1000);
                    charCount.textContent = 1000;
                }
            });
        }
        
        const inputs = document.querySelectorAll('.form-input');
        inputs.forEach(input => {
            input.addEventListener('input', function() {
                if (this.classList.contains('error')) {
                    this.classList.remove('error');
                    hideError();
                }
            });
        });
    }
    
    function openReportModal(questionIndex) {
        currentReportQuestionIndex = questionIndex;
        
        if (!currentQuestions || currentQuestions.length === 0) {
            alert("N√£o h√° quest√µes carregadas.");
            return;
        }
        
        const question = currentQuestions[questionIndex];
        
        document.getElementById('reportQuestionNumber').textContent = questionIndex + 1;
        
        let questionText = question.q;
        if (questionText.length > 150) {
            questionText = questionText.substring(0, 147) + '...';
        }
        document.getElementById('reportQuestionText').textContent = questionText;
        
        document.querySelectorAll('input[name="reportType"]').forEach(radio => {
            radio.checked = false;
        });
        document.getElementById('reportDetails').value = '';
        document.getElementById('userName').value = '';
        document.getElementById('userEmail').value = '';
        document.getElementById('userInfo').value = '';
        document.getElementById('charCount').textContent = '0';
        document.getElementById('reportSuccess').style.display = 'none';
        document.getElementById('reportErrorMsg').style.display = 'none';
        
        document.getElementById('submitReport').disabled = false;
        document.getElementById('submitText').textContent = 'Enviar Reporte';
        document.getElementById('submitLoading').style.display = 'none';
        
        document.getElementById('reportModal').style.display = 'flex';
        
        setTimeout(() => {
            document.getElementById('userName').focus();
        }, 100);
    }
    
    function closeReportModal() {
        document.getElementById('reportModal').style.display = 'none';
        currentReportQuestionIndex = null;
    }
    
    function showError(message) {
        const errorElement = document.getElementById('reportErrorMsg');
        errorElement.textContent = message;
        errorElement.style.display = 'block';
        errorElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
    }
    
    function hideError() {
        document.getElementById('reportErrorMsg').style.display = 'none';
    }
    
    function validateForm() {
        const name = document.getElementById('userName').value.trim();
        const email = document.getElementById('userEmail').value.trim();
        const reportType = document.querySelector('input[name="reportType"]:checked');
        
        if (!name) {
            document.getElementById('userName').classList.add('error');
            showError('Por favor, preencha seu nome completo.');
            return false;
        }
        
        if (!email) {
            document.getElementById('userEmail').classList.add('error');
            showError('Por favor, preencha seu e-mail.');
            return false;
        }
        
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        if (!emailRegex.test(email)) {
            document.getElementById('userEmail').classList.add('error');
            showError('Por favor, insira um e-mail v√°lido.');
            return false;
        }
        
        if (!reportType) {
            showError('Por favor, selecione o tipo de problema.');
            return false;
        }
        
        return true;
    }
    
    async function submitReport() {
        if (!validateForm()) {
            return;
        }
        
        const questionIndex = currentReportQuestionIndex;
        const question = currentQuestions[questionIndex];
        
        const reportData = {
            quizId: QUIZ_ID,
            materia: document.title || "Quiz",
            questionIndex: questionIndex + 1,
            originalIndex: question.originalIndex,
            questionText: question.q,
            reportType: document.querySelector('input[name="reportType"]:checked').value,
            reportLabel: REPORT_TYPES[document.querySelector('input[name="reportType"]:checked').value],
            details: document.getElementById('reportDetails').value.trim(),
            userName: document.getElementById('userName').value.trim(),
            userEmail: document.getElementById('userEmail').value.trim(),
            userInfo: document.getElementById('userInfo').value.trim(),
            userAnswer: userAnswers[questionIndex] !== null ? 
                question.a[userAnswers[questionIndex]] : 'N√£o respondida',
            correctAnswer: question.a[question.c],
            userAnswerIndex: userAnswers[questionIndex],
            correctAnswerIndex: question.c,
            timestamp: new Date().toLocaleString('pt-BR'),
            url: window.location.href,
            userAgent: navigator.userAgent
        };
        
        document.getElementById('submitReport').disabled = true;
        document.getElementById('submitText').textContent = 'Enviando...';
        document.getElementById('submitLoading').style.display = 'inline-block';
        
        try {
            const response = await sendToGoogleSheets(reportData);
            
            if (response.success) {
                const report = {
                    ...reportData,
                    id: Date.now(),
                    timestamp: new Date().toISOString(),
                    sentToGoogleSheets: true
                };
                
                reportsHistory.push(report);
                localStorage.setItem(REPORTS_KEY, JSON.stringify(reportsHistory));
                
                document.getElementById('reportSuccess').style.display = 'block';
                document.getElementById('submitText').textContent = 'Enviado!';
                
                setTimeout(() => {
                    closeReportModal();
                }, 3000);
            } else {
                throw new Error(response.message || 'Erro ao enviar');
            }
        } catch (error) {
            console.error('Erro ao enviar reporte:', error);
            
            const emailSent = sendReportByEmailFallback(reportData);
            
            if (emailSent) {
                const report = {
                    ...reportData,
                    id: Date.now(),
                    timestamp: new Date().toISOString(),
                    sentByEmail: true
                };
                
                reportsHistory.push(report);
                localStorage.setItem(REPORTS_KEY, JSON.stringify(reportsHistory));
                
                document.getElementById('reportSuccess').innerHTML = 
                    '‚úÖ Reporte enviado por email! Obrigado pela contribui√ß√£o.<br>' +
                    '<small>Voc√™ receber√° um feedback por email em breve.</small>';
                document.getElementById('reportSuccess').style.display = 'block';
                document.getElementById('submitText').textContent = 'Enviado!';
                
                setTimeout(() => {
                    closeReportModal();
                }, 3000);
            } else {
                const report = {
                    ...reportData,
                    id: Date.now(),
                    timestamp: new Date().toISOString(),
                    savedLocally: true
                };
                
                reportsHistory.push(report);
                localStorage.setItem(REPORTS_KEY, JSON.stringify(reportsHistory));
                
                showError('Erro de conex√£o. Reporte salvo localmente. Tente novamente mais tarde.');
                document.getElementById('submitReport').disabled = false;
                document.getElementById('submitText').textContent = 'Enviar Reporte';
                document.getElementById('submitLoading').style.display = 'none';
            }
        }
    }
    
    async function sendToGoogleSheets(reportData) {
        const formData = new FormData();
        
        Object.keys(reportData).forEach(key => {
            formData.append(key, reportData[key]);
        });
        
        const response = await fetch(API_URL, {
            method: 'POST',
            body: formData,
            mode: 'no-cors'
        });
        
        return { success: true, message: 'Enviado com sucesso' };
    }
    
    function sendReportByEmailFallback(reportData) {
        try {
            const subject = `[REPORTE] ${reportData.materia} - Quest√£o #${reportData.questionIndex}`;
            
            let body = `NOVO REPORTE DE QUEST√ÉO\n`;
            body += `=======================\n\n`;
            body += `MAT√âRIA: ${reportData.materia}\n`;
            body += `ID DO QUIZ: ${reportData.quizId}\n`;
            body += `QUEST√ÉO #${reportData.questionIndex}\n`;
            body += `√çNDICE ORIGINAL: ${reportData.originalIndex}\n\n`;
            body += `ENUNCIADO:\n${reportData.questionText}\n\n`;
            body += `TIPO DE PROBLEMA: ${reportData.reportLabel}\n\n`;
            body += `RESPOSTA DO USU√ÅRIO: ${reportData.userAnswer}\n`;
            body += `RESPOSTA CORRETA: ${reportData.correctAnswer}\n\n`;
            
            body += `INFORMA√á√ïES DO USU√ÅRIO:\n`;
            body += `Nome: ${reportData.userName}\n`;
            body += `E-mail: ${reportData.userEmail}\n`;
            body += `Institui√ß√£o/Curso: ${reportData.userInfo || 'N√£o informado'}\n\n`;
            
            if (reportData.details) {
                body += `DETALHES ADICIONAIS:\n${reportData.details}\n\n`;
            }
            
            body += `DATA/HORA: ${reportData.timestamp}\n`;
            body += `URL DA P√ÅGINA: ${reportData.url}\n`;
            
            const encodedSubject = encodeURIComponent(subject);
            const encodedBody = encodeURIComponent(body);
            
            const mailtoLink = `mailto:${EMAIL_DESTINO}?subject=${encodedSubject}&body=${encodedBody}`;
            
            window.open(mailtoLink, '_blank');
            return true;
        } catch (error) {
            console.error('Erro ao enviar email:', error);
            return false;
        }
    }
    
    // ============================================
    // INICIALIZA√á√ÉO
    // ============================================
    
    function hasUnsavedProgress() {
        const answeredCount = getAnsweredCount();
        return answeredCount > 0 && answeredCount < currentQuestions.length;
    }
    
    function showCloseWarning(event) {
        if (hasUnsavedProgress()) {
            const message = '‚ö†Ô∏è ATEN√á√ÉO!\n\nVoc√™ tem um simulado em andamento.\nSe sair agora, todo o seu progresso ser√° perdido!\n\nTem certeza que deseja sair?';
            
            if (event) {
                event.preventDefault();
                event.returnValue = message;
            }
            
            return message;
        }
    }
    
    document.addEventListener('keydown', (e) => {
        if (e.key === 'ArrowRight' || e.key === ' ') nextQuestion();
        if (e.key === 'ArrowLeft') prevQuestion();
    });
    
    window.addEventListener('beforeunload', function(event) {
        if (hasUnsavedProgress()) {
            try {
                saveCurrentSessionState();
            } catch (e) {
                console.error('Erro ao salvar estado antes de sair:', e);
            }
            
            return showCloseWarning(event);
        }
    });
    
    window.onload = function() {
        initQuiz();
        initReportSystem();
    };
</script>

</body>
</html>
